1..79
# selftests: lkdtm: PANIC.sh
# Skipping PANIC: crashes entire system
ok 1 selftests: lkdtm: PANIC.sh # SKIP
# selftests: lkdtm: BUG.sh
# Segmentation fault
# [  113.947654] lkdtm: Performing direct entry BUG
# [  113.953238] ------------[ cut here ]------------
# [  113.958825] kernel BUG at drivers/misc/lkdtm/bugs.c:76!
# [  113.965086] invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
# [  113.971631] CPU: 0 PID: 1366 Comm: cat Tainted: G          I       5.15.0 #1
# [  113.979768] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  113.988885] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  113.993646] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  114.013673] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  114.019814] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  114.027882] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  114.035916] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  114.044006] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  114.052065] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  114.060157] FS:  00007f0c485fb540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  114.069222] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  114.075955] CR2: 00007f0c48272000 CR3: 000000011c93a001 CR4: 00000000003706f0
# [  114.084043] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  114.092139] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  114.100300] Call Trace:
# [  114.103561]  direct_entry.cold+0x2f/0x6f
# [  114.108350]  full_proxy_write+0xfd/0x180
# [  114.113168]  vfs_write+0x184/0x8c0
# [  114.117398]  ksys_write+0xf9/0x200
# [  114.121666]  ? __ia32_sys_read+0xc0/0xc0
# [  114.126470]  ? lockdep_hardirqs_on_prepare+0x17b/0x400
# [  114.132571]  ? syscall_enter_from_user_mode+0x21/0x80
# [  114.138590]  do_syscall_64+0x5c/0x80
# [  114.143014]  ? asm_exc_page_fault+0x1e/0x30
# [  114.148030]  ? asm_exc_page_fault+0x8/0x30
# [  114.152993]  ? lockdep_hardirqs_on+0x79/0x100
# [  114.158209]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  114.164083] RIP: 0033:0x7f0c48523504
# [  114.168450] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  114.188519] RSP: 002b:00007ffff1a54d08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  114.197095] RAX: ffffffffffffffda RBX: 0000000000000004 RCX: 00007f0c48523504
# [  114.205209] RDX: 0000000000000004 RSI: 00007f0c48272000 RDI: 0000000000000001
# [  114.213313] RBP: 00007f0c48272000 R08: 00000000ffffffff R09: 0000000000000000
# [  114.221423] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f0c48272000
# [  114.229536] R13: 0000000000000001 R14: 0000000000000004 R15: 0000000000020000
# [  114.237622] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  114.288270] ---[ end trace 9201e83dba6482a2 ]---
# [  114.294523] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  114.299375] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  114.319369] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  114.325462] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  114.333670] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  114.341712] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  114.349745] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  114.357852] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  114.365902] FS:  00007f0c485fb540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  114.374968] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  114.381531] CR2: 00007f0c48272000 CR3: 000000011c93a001 CR4: 00000000003706f0
# [  114.389614] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  114.397701] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# BUG: saw 'kernel BUG at': ok
ok 2 selftests: lkdtm: BUG.sh
# selftests: lkdtm: WARNING.sh
# [  114.604337] lkdtm: Performing direct entry WARNING
# [  114.610167] ------------[ cut here ]------------
# [  114.615715] WARNING: CPU: 2 PID: 1404 at drivers/misc/lkdtm/bugs.c:83 lkdtm_WARNING+0xf/0x40
# [  114.625246] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  114.676021] CPU: 2 PID: 1404 Comm: cat Tainted: G      D   I       5.15.0 #1
# [  114.684302] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  114.693384] RIP: 0010:lkdtm_WARNING+0xf/0x40
# [  114.698567] Code: 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 90 0f 1f 44 00 00 83 05 14 4e 19 05 01 75 01 c3 <0f> 0b c3 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00
# [  114.718699] RSP: 0018:ffffc90002b7fd18 EFLAGS: 00010202
# [  114.724909] RAX: ffffffff82a93000 RBX: 0000000000000002 RCX: 0000000000000000
# [  114.733118] RDX: 1ffffffff08b60b1 RSI: ffffffff8158eeb6 RDI: ffffffff845b0588
# [  114.741293] RBP: ffffffff845af1e0 R08: 0000000000000026 R09: ffffed1102755921
# [  114.749458] R10: ffff888813aac907 R11: ffffed1102755920 R12: 0000000000000008
# [  114.757597] R13: dffffc0000000000 R14: 0000000000000020 R15: ffff88818f957000
# [  114.765776] FS:  00007fe9d637c540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  114.774939] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  114.781657] CR2: 00007fe9d5ff3000 CR3: 00000001207b4001 CR4: 00000000003706e0
# [  114.789793] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  114.798038] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  114.806141] Call Trace:
# [  114.809456]  direct_entry.cold+0x2f/0x6f
# [  114.814395]  full_proxy_write+0xfd/0x180
# [  114.819244]  vfs_write+0x184/0x8c0
# [  114.823572]  ksys_write+0xf9/0x200
# [  114.827839]  ? __ia32_sys_read+0xc0/0xc0
# [  114.832674]  ? syscall_enter_from_user_mode+0x21/0x80
# [  114.838666]  ? syscall_enter_from_user_mode+0x21/0x80
# [  114.844656]  do_syscall_64+0x5c/0x80
# [  114.849181]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  114.855016]  ? do_syscall_64+0x69/0x80
# [  114.859633]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  114.865000]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  114.870691]  ? asm_exc_page_fault+0x8/0x30
# [  114.875708]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  114.881487]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  114.887490] RIP: 0033:0x7fe9d62a4504
# [  114.891919] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  114.911976] RSP: 002b:00007ffd802e63a8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  114.920526] RAX: ffffffffffffffda RBX: 0000000000000008 RCX: 00007fe9d62a4504
# [  114.928601] RDX: 0000000000000008 RSI: 00007fe9d5ff3000 RDI: 0000000000000001
# [  114.936736] RBP: 00007fe9d5ff3000 R08: 00000000ffffffff R09: 0000000000000000
# [  114.944749] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fe9d5ff3000
# [  114.952885] R13: 0000000000000001 R14: 0000000000000008 R15: 0000000000020000
# [  114.961012] irq event stamp: 0
# [  114.964875] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  114.972108] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  114.981451] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  114.990793] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  114.998072] ---[ end trace 9201e83dba6482a3 ]---
# WARNING: saw 'WARNING:': ok
ok 3 selftests: lkdtm: WARNING.sh
# selftests: lkdtm: WARNING_MESSAGE.sh
# [  115.181899] lkdtm: Performing direct entry WARNING_MESSAGE
# [  115.197096] run-job /lkp/jobs/scheduled/lkp-skl-nuc2/kernel-selftests-lkdtm-ucode=0xe2-CYCLIC_BASE-20211113-508515-1au7kiz-0.yaml
# [  115.201620] ------------[ cut here ]------------
# [  115.201624] Warning message trigger count: 2
# [  115.201657] WARNING: CPU: 2 PID: 1439 at drivers/misc/lkdtm/bugs.c:88 lkdtm_WARNING_MESSAGE+0x20/0x40
# 
# [  115.225039] /usr/bin/wget -q --timeout=1800 --tries=1 --local-encoding=UTF-8 http://internal-lkp-server:80/~lkp/cgi-bin/lkp-jobfile-append-var?job_file=/lkp/jobs/scheduled/lkp-skl-nuc2/kernel-selftests-lkdtm-ucode=0xe2-CYCLIC_BASE-20211113-508515-1au7kiz-0.yaml&job_state=running -O /dev/null
# [  115.235286] Modules linked in: netconsole
# 
# [  115.264925]  btrfs
# [  115.270221] target ucode: 0xe2
# [  115.272020]  ipmi_devintf
# 
# [  115.275846] current_version: e2, target_version: e2
# [  115.278728]  ipmi_msghandler
# 
# [  115.284450]  blake2b_generic xor zstd_compress
# [  115.293675] KERNEL SELFTESTS: linux_headers_dir is /usr/src/linux-headers-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813
# [  115.293953]  intel_rapl_msr
# 
# [  115.301462]  intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915
# [  115.316258] 2021-11-14 08:52:50 ln -sf /usr/bin/clang
# [  115.318859]  intel_powerclamp sd_mod
# 
# [  115.322199] 2021-11-14 08:52:50 ln -sf /usr/bin/llc
# [  115.329009]  t10_pi
# 
# [  115.337404] 2021-11-14 08:52:50 sed -i s/default_timeout=45/default_timeout=1200/ kselftest/runner.sh
# [  115.339343]  sg
# 
# [  115.342523] 2021-11-14 08:52:50 make -C lkdtm
# [  115.347433]  coretemp crct10dif_pclmul
# 
# [  115.352626]  crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci
# [  115.367078] make: Entering directory '/usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm'
# [  115.367676]  rapl
# 
# [  115.377521]  cqhci sdhci intel_cstate ahci mmc_core
# [  115.384243] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/PANIC.sh
# [  115.389009]  mei_me
# 
# [  115.408938] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/BUG.sh
# [  115.409589]  libahci intel_gtt
# 
# [  115.419907] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/WARNING.sh
# [  115.431353]  i2c_i801
# 
# [  115.436450]  ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir
# [  115.457109] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/WARNING_MESSAGE.sh
# [  115.458504]  wmi rc_core video
# 
# [  115.479601] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXCEPTION.sh
# [  115.479876]  intel_pmc_core
# 
# [  115.507464]  acpi_pad
# [  115.515530] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/LOOP.sh
# [  115.529915]  ip_tables
# 
# 
# [  115.543273] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXHAUST_STACK.sh
# [  115.554941] CPU: 6 PID: 1439 Comm: cat Tainted: G      D W I       5.15.0 #1
# 
# [  115.563843] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/CORRUPT_STACK.sh
# [  115.579511] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# 
# [  115.594409] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/CORRUPT_STACK_STRONG.sh
# [  115.606433] RIP: 0010:lkdtm_WARNING_MESSAGE+0x20/0x40
# 
# [  115.622487] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/ARRAY_BOUNDS.sh
# [  115.635318] Code: 0f 1f 84 00 00 00 00 00 66 90 0f 1f 44 00 00 8b 05 d5 4d 19 05 48 c7 c7 00 0f 5b 84 8d 70 01 89 35 c5 4d 19 05 e8 ab 8a 09 01 <0f> 0b c3 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00
# 
# [  115.643562] RSP: 0018:ffffc90002cafdc0 EFLAGS: 00010286
# [  115.667031] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/CORRUPT_LIST_ADD.sh
# 
# [  115.680658] RAX: 0000000000000000 RBX: 0000000000000003 RCX: 0000000000000000
# 
# [  115.688998] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000595faa
# [  115.689004] RBP: ffffffff845af220 R08: 0000000000000001 R09: ffffed1102753fe8
# [  115.689009] R10: ffff888813a9ff3b R11: ffffed1102753fe7 R12: 0000000000000010
# [  115.689015] R13: dffffc0000000000 R14: 0000000000000030 R15: ffff888897997000
# [  115.712679] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/CORRUPT_LIST_DEL.sh
# [  115.716436] FS:  00007f07055bc540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# 
# [  115.725185] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/STACK_GUARD_PAGE_LEADING.sh
# [  115.728338] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# 
# [  115.742376] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/STACK_GUARD_PAGE_TRAILING.sh
# [  115.744203] CR2: 00007fe302524000 CR3: 00000008986ea004 CR4: 00000000003706e0
# 
# [  115.758088] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/UNSET_SMEP.sh
# [  115.769402] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# 
# [  115.783846] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/DOUBLE_FAULT.sh
# [  115.798538] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# 
# [  115.810417] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/CORRUPT_PAC.sh
# [  115.825335] Call Trace:
# 
# [  115.839152] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/UNALIGNED_LOAD_STORE_WRITE.sh
# [  115.852258]  direct_entry.cold+0x2f/0x6f
# 
# [  115.865868] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SLAB_LINEAR_OVERFLOW.sh
# [  115.879165]  full_proxy_write+0xfd/0x180
# 
# [  115.892951] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/VMALLOC_LINEAR_OVERFLOW.sh
# [  115.906052]  vfs_write+0x184/0x8c0
# 
# [  115.914638] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/WRITE_AFTER_FREE.sh
# [  115.929496]  ksys_write+0xf9/0x200
# 
# [  115.939369] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/READ_AFTER_FREE.sh
# [  115.954014]  ? __ia32_sys_read+0xc0/0xc0
# 
# [  115.964487] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/WRITE_BUDDY_AFTER_FREE.sh
# [  115.978873]  ? syscall_enter_from_user_mode+0x21/0x80
# 
# [  115.988604] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/READ_BUDDY_AFTER_FREE.sh
# [  116.002296]  ? syscall_enter_from_user_mode+0x21/0x80
# 
# [  116.012259] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SLAB_INIT_ON_ALLOC.sh
# [  116.025889]  do_syscall_64+0x5c/0x80
# 
# [  116.036273] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/BUDDY_INIT_ON_ALLOC.sh
# [  116.050680]  ? trace_hardirqs_on_prepare+0x27/0x180
# 
# [  116.062005] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SLAB_FREE_DOUBLE.sh
# [  116.076542]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# 
# [  116.087838] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SLAB_FREE_CROSS.sh
# [  116.102031] RIP: 0033:0x7f07054e4504
# 
# [  116.111960] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SLAB_FREE_PAGE.sh
# [  116.126041] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# 
# [  116.137040] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SOFTLOCKUP.sh
# [  116.151193] RSP: 002b:00007ffee1c64c88 EFLAGS: 00000246
# 
# [  116.162301] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/HARDLOCKUP.sh
# [  116.176370]  ORIG_RAX: 0000000000000001
# 
# [  116.186114] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/SPINLOCKUP.sh
# [  116.200212] RAX: ffffffffffffffda RBX: 0000000000000010 RCX: 00007f07054e4504
# 
# [  116.225445] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/HUNG_TASK.sh
# [  116.239138] RDX: 0000000000000010 RSI: 00007f0705233000 RDI: 0000000000000001
# 
# [  116.250264] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_DATA.sh
# [  116.264123] RBP: 00007f0705233000 R08: 00000000ffffffff R09: 0000000000000000
# 
# [  116.273848] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_STACK.sh
# [  116.287633] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f0705233000
# 
# [  116.300844] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_KMALLOC.sh
# [  116.314442] R13: 0000000000000001 R14: 0000000000000010 R15: 0000000000020000
# 
# [  116.327778] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_VMALLOC.sh
# [  116.341323] irq event stamp: 0
# 
# [  116.354591] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_RODATA.sh
# [  116.368263] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# 
# [  116.381451] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_USERSPACE.sh
# [  116.395471] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# 
# [  116.408665] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/EXEC_NULL.sh
# [  116.422804] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# 
# [  116.431843] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/ACCESS_USERSPACE.sh
# [  116.445631] softirqs last disabled at (0): [<0000000000000000>] 0x0
# 
# [  116.458849] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/ACCESS_NULL.sh
# [  116.472101] ---[ end trace 9201e83dba6482a4 ]---
# 
# WARNING_MESSAGE: saw 'message trigger': ok
ok 4 selftests: lkdtm: WARNING_MESSAGE.sh
# selftests: lkdtm: EXCEPTION.sh
# Segmentation fault
# [  116.746705] lkdtm: Performing direct entry EXCEPTION
# [  116.759006] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_DEC_ZERO.sh
# 
# [  116.759327] general protection fault, maybe for address 0xffffffff82a93080: 0000 [#2] PREEMPT SMP KASAN PTI
# [  116.784540] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_DEC_NEGATIVE.sh
# [  116.789580] CPU: 0 PID: 1477 Comm: cat Tainted: G      D W I       5.15.0 #1
# [  116.789587] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  116.789590] RIP: 0010:lkdtm_EXCEPTION+0x5/0x40
# [  116.789600] Code: e8 ab 8a 09 01 0f 0b c3 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <a0> 00 00 00 00 00 fc ff df 84 c0 74 04 3c 03 7e 0c c7 04 25 00 00
# [  116.789605] RSP: 0018:ffffc90002e0fdb0 EFLAGS: 00010282
# [  116.789610] RAX: ffffffff82a93080 RBX: 0000000000000004 RCX: 0000000000000000
# [  116.789614] RDX: 1ffffffff08b60b5 RSI: ffffffff8158eeb6 RDI: ffffffff845b05a8
# 
# [  116.815031] RBP: ffffffff845af260 R08: 0000000000000028 R09: ffffed1102745921
# [  116.815035] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 000000000000000a
# [  116.815037] R13: dffffc0000000000 R14: 0000000000000040 R15: ffff8881596df000
# [  116.815040] FS:  00007fe9a2215540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  116.815044] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  116.815049] CR2: 00007fe9a1e8c000 CR3: 0000000898190004 CR4: 00000000003706f0
# [  116.832028] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_DEC_AND_TEST_NEGATIVE.sh
# [  116.849629] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  116.849633] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  116.849636] Call Trace:
# [  116.849638]  direct_entry.cold+0x2f/0x6f
# [  116.849648]  full_proxy_write+0xfd/0x180
# [  116.849659]  vfs_write+0x184/0x8c0
# 
# [  116.863844]  ksys_write+0xf9/0x200
# [  116.863851]  ? __ia32_sys_read+0xc0/0xc0
# [  116.863856]  ? syscall_enter_from_user_mode+0x21/0x80
# [  116.863864]  ? syscall_enter_from_user_mode+0x21/0x80
# [  116.879450] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_SUB_AND_TEST_NEGATIVE.sh
# [  116.882244]  do_syscall_64+0x5c/0x80
# [  116.882254]  ? trace_hardirqs_on_prepare+0x27/0x180
# 
# [  116.898543]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  116.898550] RIP: 0033:0x7fe9a213d504
# [  116.898555] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  116.898559] RSP: 002b:00007ffcc2627b28 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  116.898567] RAX: ffffffffffffffda RBX: 000000000000000a RCX: 00007fe9a213d504
# [  116.898572] RDX: 000000000000000a RSI: 00007fe9a1e8c000 RDI: 0000000000000001
# [  116.914530] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_INC_ZERO.sh
# [  116.922360] RBP: 00007fe9a1e8c000 R08: 00000000ffffffff R09: 0000000000000000
# [  116.922364] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fe9a1e8c000
# [  116.922367] R13: 0000000000000001 R14: 000000000000000a R15: 0000000000020000
# [  116.922381] Modules linked in:
# 
# [  116.948616]  netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel
# [  116.962385] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_ADD_ZERO.sh
# [  116.964880]  intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci
# 
# [  116.973871]  mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus
# [  116.982095] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_INC_SATURATED.sh
# [  116.985178]  intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# 
# [  116.997128] ---[ end trace 9201e83dba6482a5 ]---
# [  117.021164] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_DEC_SATURATED.sh
# [  117.025718] RIP: 0010:lkdtm_BUG+0x5/0x40
# 
# [  117.034029] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  117.034034] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  117.034041] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  117.034045] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  117.044184] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_ADD_SATURATED.sh
# [  117.058557] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  117.058561] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  117.058564] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# 
# [  117.075300] FS:  00007fe9a2215540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  117.075305] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  117.075308] CR2: 00007fe9a1e8c000 CR3: 0000000898190004 CR4: 00000000003706f0
# [  117.075313] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  117.089359] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/REFCOUNT_INC_NOT_ZERO_SATURATED.sh
# [  117.100476] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# 
# EXCEPTION: saw 'call trace:': ok
ok 5 selftests: lkdtm: EXCEPTION.sh
# selftests: lkdtm: LOOP.sh
# Skipping LOOP: Hangs the system
ok 6 selftests: lkdtm: LOOP.sh # SKIP
# selftests: lkdtm: EXHAUST_STACK.sh
# Skipping EXHAUST_STACK: Corrupts memory on failure
ok 7 selftests: lkdtm: EXHAUST_STACK.sh # SKIP
# selftests: lkdtm: CORRUPT_STACK.sh
# Skipping CORRUPT_STACK: Crashes entire system on success
ok 8 selftests: lkdtm: CORRUPT_STACK.sh # SKIP
# selftests: lkdtm: CORRUPT_STACK_STRONG.sh
# Skipping CORRUPT_STACK_STRONG: Crashes entire system on success
ok 9 selftests: lkdtm: CORRUPT_STACK_STRONG.sh # SKIP
# selftests: lkdtm: ARRAY_BOUNDS.sh
# [  117.719312] lkdtm: Performing direct entry ARRAY_BOUNDS
# [  117.725727] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/USERCOPY_STACK_BEYOND.sh
# 
# [  117.733147] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/USERCOPY_KERNEL.sh
# [  117.743823] lkdtm: Array access within bounds ...
# 
# [  117.763026] lkdtm: Array access beyond bounds ...
# [  117.763028] ================================================================================
# [  117.763030] UBSAN: array-index-out-of-bounds in /kbuild/src/consumer/drivers/misc/lkdtm/bugs.c:265:16
# [  117.763035] index 8 is out of range for type 'char [8]'
# [  117.763039] CPU: 0 PID: 1628 Comm: cat Tainted: G      D W I       5.15.0 #1
# [  117.763045] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  117.763049] Call Trace:
# [  117.774442] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/STACKLEAK_ERASING.sh
# [  117.776497]  dump_stack_lvl+0x45/0x59
# [  117.776509]  ubsan_epilogue+0x5/0x40
# 
# [  117.796189]  __ubsan_handle_out_of_bounds+0x69/0x80
# [  117.796196]  ? suspend_devices_and_enter+0x7f8/0x1400
# [  117.796204]  lkdtm_ARRAY_BOUNDS.cold+0x41/0xf3
# [  117.796210]  ? lkdtm_HUNG_TASK+0x80/0x80
# [  117.796220]  direct_entry.cold+0x2f/0x6f
# [  117.808117] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/CFI_FORWARD_PROTO.sh
# [  117.810351]  full_proxy_write+0xfd/0x180
# [  117.810362]  vfs_write+0x184/0x8c0
# 
# [  117.822713]  ksys_write+0xf9/0x200
# [  117.822719]  ? __ia32_sys_read+0xc0/0xc0
# [  117.822725]  ? syscall_enter_from_user_mode+0x21/0x80
# [  117.822731]  ? syscall_enter_from_user_mode+0x21/0x80
# [  117.822737]  do_syscall_64+0x5c/0x80
# [  117.845597] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/FORTIFIED_STRSCPY.sh
# [  117.848677]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  117.848685]  ? trace_hardirqs_on_prepare+0x27/0x180
# 
# [  117.856720]  ? do_syscall_64+0x69/0x80
# [  117.856727]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  117.856731]  ? asm_exc_page_fault+0x8/0x30
# [  117.856737]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  117.856743]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  117.868581] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/FORTIFIED_OBJECT.sh
# [  117.872890] RIP: 0033:0x7f8a7d829504
# [  117.872897] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  117.872901] RSP: 002b:00007fff6468c8c8 EFLAGS: 00000246
# 
# [  117.894826]  ORIG_RAX: 0000000000000001
# [  117.894829] RAX: ffffffffffffffda RBX: 000000000000000d RCX: 00007f8a7d829504
# [  117.894832] RDX: 000000000000000d RSI: 00007f8a7d578000 RDI: 0000000000000001
# [  117.894835] RBP: 00007f8a7d578000 R08: 00000000ffffffff R09: 0000000000000000
# [  117.894837] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f8a7d578000
# [  117.894840] R13: 0000000000000001 R14: 000000000000000d R15: 0000000000020000
# [  117.894878] ================================================================================
# [  117.905607] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/FORTIFIED_SUBOBJECT.sh
# [  117.906348] lkdtm: FAIL: survived array bounds overflow!
# 
# [  117.915401] lkdtm: Unexpected! This kernel (5.15.0 x86_64) was built with CONFIG_UBSAN_BOUNDS=y
# ARRAY_BOUNDS: saw 'call trace:': ok
ok 10 selftests: lkdtm: ARRAY_BOUNDS.sh
# selftests: lkdtm: CORRUPT_LIST_ADD.sh
# Segmentation fault
# [  118.105261] lkdtm: Performing direct entry CORRUPT_LIST_ADD
# [  118.120115] install -m 0744 run.sh /usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm/PPC_SLB_MULTIHIT.sh
# [  118.121715] lkdtm: attempting good list addition
# [  118.121718] lkdtm: attempting corrupted list addition
# 
# [  118.137845] list_add corruption. next->prev should be prev (ffffc9000346fcd0), but was 0000000000000000. (next=ffffc9000346fcf0).
# [  118.137873] ------------[ cut here ]------------
# [  118.160024] make: Leaving directory '/usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm'
# [  118.160339] kernel BUG at lib/list_debug.c:23!
# 
# [  118.168527] invalid opcode: 0000 [#3] PREEMPT SMP KASAN PTI
# [  118.168535] CPU: 0 PID: 1663 Comm: cat Tainted: G      D W I       5.15.0 #1
# [  118.168540] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  118.168543] RIP: 0010:__list_add_valid.cold+0xf/0x3c
# [  118.182746] 2021-11-14 08:52:52 make run_tests -C lkdtm
# [  118.186766] Code: e8 ad 38 89 fd 48 c7 c0 f4 ff ff ff e9 80 83 8c fe 4c 89 e7 e8 99 94 ff fd eb d4 4c 89 e1 48 c7 c7 e0 0e 49 84 e8 45 4c fc ff <0f> 0b 48 89 f2 4c 89 e1 48 89 ee 48 c7 c7 20 10 49 84 e8 2e 4c fc
# [  118.186771] RSP: 0018:ffffc9000346fc50 EFLAGS: 00010282
# [  118.186776] RAX: 0000000000000075 RBX: 1ffff9200068df8e RCX: 0000000000000000
# 
# [  118.207950] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff5200068df7d
# [  118.207953] RBP: ffffc9000346fcb0 R08: 0000000000000075 R09: ffffed1102743fe8
# [  118.207956] R10: ffff888813a1ff3b R11: ffffed1102743fe7 R12: ffffc9000346fcf0
# [  118.207959] R13: ffffc9000346fcb0 R14: ffffc9000346fcf0 R15: ffff888899709000
# [  118.207961] FS:  00007f20edfa9540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  118.207965] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  118.207968] CR2: 00007f20edc20000 CR3: 00000001a2ab6003 CR4: 00000000003706f0
# [  118.207970] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  118.207973] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  118.216298] make: Entering directory '/usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm'
# [  118.216772] Call Trace:
# [  118.216777]  lkdtm_CORRUPT_LIST_ADD+0x12d/0x1ee
# 
# [  118.233846]  ? lkdtm_ARRAY_BOUNDS.cold+0xf3/0xf3
# [  118.233854]  ? record_print_text.cold+0x11/0x11
# [  118.233860]  ? drain_pages+0x80/0x80
# [  118.233867]  ? free_unref_page+0x33d/0x5c0
# [  118.233877]  direct_entry.cold+0x2f/0x6f
# [  118.240331] TAP version 13
# [  118.245847]  full_proxy_write+0xfd/0x180
# [  118.245858]  vfs_write+0x184/0x8c0
# [  118.245867]  ksys_write+0xf9/0x200
# 
# [  118.272398]  ? __ia32_sys_read+0xc0/0xc0
# [  118.272405]  ? syscall_enter_from_user_mode+0x21/0x80
# [  118.272411]  ? syscall_enter_from_user_mode+0x21/0x80
# [  118.272418]  do_syscall_64+0x5c/0x80
# [  118.280796] 1..79
# [  118.282912]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  118.282919]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  118.282924]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  118.282928]  ? asm_exc_page_fault+0x8/0x30
# [  118.282934]  ? trace_hardirqs_on_prepare+0x27/0x180
# 
# [  118.299318]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  118.299324] RIP: 0033:0x7f20eded1504
# [  118.299329] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  118.299333] RSP: 002b:00007ffdcb96ce18 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  118.299338] RAX: ffffffffffffffda RBX: 0000000000000011 RCX: 00007f20eded1504
# [  118.299341] RDX: 0000000000000011 RSI: 00007f20edc20000 RDI: 0000000000000001
# [  118.308426] # selftests: lkdtm: PANIC.sh
# [  118.315708] RBP: 00007f20edc20000 R08: 00000000ffffffff R09: 0000000000000000
# [  118.315711] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f20edc20000
# [  118.315714] R13: 0000000000000001 R14: 0000000000000011 R15: 0000000000020000
# [  118.315726] Modules linked in:
# 
# [  118.331710]  netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod
# [  118.341236] # Skipping PANIC: crashes entire system
# [  118.348161]  t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci
# 
# [  118.372034]  rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core
# [  118.376528] ok 1 selftests: lkdtm: PANIC.sh # SKIP
# [  118.380875]  video intel_pmc_core acpi_pad ip_tables
# [  118.380921] ---[ end trace 9201e83dba6482a6 ]---
# 
# [  118.384263] # selftests: lkdtm: BUG.sh
# [  118.389142] RIP: 0010:lkdtm_BUG+0x5/0x40
# 
# [  118.399010] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  118.399015] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  118.399020] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  118.399023] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  118.399026] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  118.404649] # Segmentation fault
# [  118.408762] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  118.408766] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  118.408769] FS:  00007f20edfa9540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  118.408772] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  118.408775] CR2: 00007f20edc20000 CR3: 00000001a2ab6003 CR4: 00000000003706f0
# [  118.408779] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  118.408781] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# 
# CORRUPT_LIST_ADD: saw 'list_add corruption': ok
ok 11 selftests: lkdtm: CORRUPT_LIST_ADD.sh
# selftests: lkdtm: CORRUPT_LIST_DEL.sh
# Segmentation fault
# [  118.608254] lkdtm: Performing direct entry CORRUPT_LIST_DEL
# [  118.611642] # [  113.947654] lkdtm: Performing direct entry BUG
# [  118.630391] lkdtm: attempting good list removal
# 
# [  118.638183] # [  113.953238] ------------[ cut here ]------------
# [  118.642042] lkdtm: attempting corrupted list removal
# 
# [  118.649902] # [  113.958825] kernel BUG at drivers/misc/lkdtm/bugs.c:76!
# [  118.654557] list_del corruption. next->prev should be ffffc900035afcc0, but was 0000000000000000
# 
# [  118.662029] # [  113.965086] invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
# [  118.681699] ------------[ cut here ]------------
# 
# [  118.691095] # [  113.971631] CPU: 0 PID: 1366 Comm: cat Tainted: G          I       5.15.0 #1
# [  118.695921] kernel BUG at lib/list_debug.c:54!
# 
# [  118.707976] # [  113.979768] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  118.712254] invalid opcode: 0000 [#4] PREEMPT SMP KASAN PTI
# 
# [  118.724404] CPU: 6 PID: 1701 Comm: cat Tainted: G      D W I       5.15.0 #1
# [  118.724410] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  118.724412] RIP: 0010:__list_del_entry_valid.cold+0x48/0x4a
# [  118.724422] Code: e8 f5 4b fc ff 0f 0b 4c 89 e2 48 89 ee 48 c7 c7 e0 10 49 84 e8 e1 4b fc ff 0f 0b 48 89 ee 48 c7 c7 a0 11 49 84 e8 d0 4b fc ff <0f> 0b 48 63 d1 4c 89 e6 48 c7 c7 a0 94 c4 85 89 0c 24 44 89 44 24
# [  118.724428] RSP: 0018:ffffc900035afc80 EFLAGS: 00010282
# [  118.724438] RAX: 0000000000000054 RBX: ffffc900035afce0 RCX: 0000000000000000
# [  118.724443] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff520006b5f83
# [  118.724448] RBP: ffffc900035afcc0 R08: 0000000000000054 R09: ffffed1102775921
# [  118.734402] # [  113.988885] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  118.741644] R10: ffff888813bac907 R11: ffffed1102775920 R12: ffffc900035afce0
# [  118.741648] R13: ffffc900035afd00 R14: ffffc900035afce0 R15: ffff8888984a6000
# [  118.741651] FS:  00007fc44eaab540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# [  118.741655] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  118.741658] CR2: 00007fc44e722000 CR3: 000000026e852006 CR4: 00000000003706e0
# 
# [  118.756362] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  118.756365] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  118.756367] Call Trace:
# [  118.756371]  lkdtm_CORRUPT_LIST_DEL.cold+0x8c/0x23a
# [  118.756379]  ? lkdtm_ARRAY_BOUNDS+0x200/0x200
# [  118.773629] # [  113.993646] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  118.775059]  ? record_print_text.cold+0x11/0x11
# [  118.775072]  ? free_unref_page+0x33d/0x5c0
# [  118.775084]  direct_entry.cold+0x2f/0x6f
# 
# [  118.788402]  full_proxy_write+0xfd/0x180
# [  118.788416]  vfs_write+0x184/0x8c0
# [  118.788437]  ksys_write+0xf9/0x200
# [  118.796267] # [  114.013673] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  118.802988]  ? __ia32_sys_read+0xc0/0xc0
# [  118.802997]  ? syscall_enter_from_user_mode+0x21/0x80
# [  118.803003]  ? syscall_enter_from_user_mode+0x21/0x80
# [  118.803011]  do_syscall_64+0x5c/0x80
# [  118.803018]  ? trace_hardirqs_on_prepare+0x27/0x180
# 
# [  118.811080]  ? do_syscall_64+0x69/0x80
# [  118.811086]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  118.811097]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  118.822090] # [  114.019814] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  118.828474] RIP: 0033:0x7fc44e9d3504
# [  118.828481] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  118.828484] RSP: 002b:00007ffc7fa68648 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# 
# [  118.838793] RAX: ffffffffffffffda RBX: 0000000000000011 RCX: 00007fc44e9d3504
# [  118.838796] RDX: 0000000000000011 RSI: 00007fc44e722000 RDI: 0000000000000001
# [  118.838799] RBP: 00007fc44e722000 R08: 00000000ffffffff R09: 0000000000000000
# [  118.838801] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fc44e722000
# [  118.838804] R13: 0000000000000001 R14: 0000000000000011 R15: 0000000000020000
# [  118.838831] Modules linked in:
# [  118.847631] # [  114.027882] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  118.856160]  netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c
# 
# [  118.864008]  x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl
# [  118.877868] # [  114.035916] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  118.881016]  cqhci sdhci intel_cstate ahci mmc_core mei_me libahci
# 
# [  118.891382]  intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core
# [  118.903778] # [  114.044006] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  118.906912]  video intel_pmc_core acpi_pad ip_tables
# [  118.907070] ---[ end trace 9201e83dba6482a7 ]---
# 
# [  118.933104] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  118.943980] # [  114.052065] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  118.949313] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# 
# [  118.961316] # [  114.060157] FS:  00007f0c485fb540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  118.963802] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# 
# 
# [  118.979993] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  118.991156] # [  114.069222] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  118.995779] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# 
# [  119.006713] # [  114.075955] CR2: 00007f0c48272000 CR3: 000000011c93a001 CR4: 00000000003706f0
# [  119.014497] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# 
# [  119.025224] # [  114.084043] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  119.027010] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# 
# [  119.034406] # [  114.092139] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  119.036975] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# 
# [  119.059576] # [  114.100300] Call Trace:
# [  119.064121] FS:  00007fc44eaab540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# 
# [  119.070550] # [  114.103561]  direct_entry.cold+0x2f/0x6f
# [  119.073957] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# 
# [  119.077707] # [  114.108350]  full_proxy_write+0xfd/0x180
# [  119.081163] CR2: 00007fc44e722000 CR3: 000000026e852006 CR4: 00000000003706e0
# 
# [  119.086688] # [  114.113168]  vfs_write+0x184/0x8c0
# [  119.089751] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  119.089755] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# 
# CORRUPT_LIST_DEL: saw 'list_del corruption': ok
ok 12 selftests: lkdtm: CORRUPT_LIST_DEL.sh
# selftests: lkdtm: STACK_GUARD_PAGE_LEADING.sh
# Segmentation fault
# [  119.098718] # [  114.117398]  ksys_write+0xf9/0x200
# [  119.307116] lkdtm: Performing direct entry STACK_GUARD_PAGE_LEADING
# 
# [  119.311854] # [  114.121666]  ? __ia32_sys_read+0xc0/0xc0
# [  119.319420] lkdtm: attempting bad read from page below current stack
# 
# [  119.327619] # [  114.126470]  ? lockdep_hardirqs_on_prepare+0x17b/0x400
# [  119.330723] ==================================================================
# 
# [  119.337799] BUG: KASAN: vmalloc-out-of-bounds in lkdtm_STACK_GUARD_PAGE_LEADING+0x9f/0xcf
# [  119.337808] Read of size 1 at addr ffffc90003707fff by task cat/1733
# 
# [  119.337816] CPU: 6 PID: 1733 Comm: cat Tainted: G      D W I       5.15.0 #1
# [  119.337825] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  119.349436] # [  114.132571]  ? syscall_enter_from_user_mode+0x21/0x80
# [  119.367611] Call Trace:
# [  119.367614]  dump_stack_lvl+0x45/0x59
# [  119.367621]  print_address_description.constprop.0+0x21/0x140
# 
# [  119.380402]  ? lkdtm_STACK_GUARD_PAGE_LEADING+0x9f/0xcf
# [  119.380407]  ? lkdtm_STACK_GUARD_PAGE_LEADING+0x9f/0xcf
# [  119.380411]  kasan_report.cold+0x7f/0x11b
# [  119.380420]  ? console_trylock+0x40/0x80
# [  119.387887] # [  114.138590]  do_syscall_64+0x5c/0x80
# [  119.388842]  ? lkdtm_STACK_GUARD_PAGE_LEADING+0x9f/0xcf
# [  119.388849]  lkdtm_STACK_GUARD_PAGE_LEADING+0x9f/0xcf
# [  119.388854]  ? lkdtm_CORRUPT_LIST_DEL.cold+0x23a/0x23a
# [  119.388861]  direct_entry.cold+0x2f/0x6f
# 
# [  119.399171]  full_proxy_write+0xfd/0x180
# [  119.399182]  vfs_write+0x184/0x8c0
# [  119.399196]  ksys_write+0xf9/0x200
# [  119.409032] # [  114.143014]  ? asm_exc_page_fault+0x1e/0x30
# [  119.415561]  ? __ia32_sys_read+0xc0/0xc0
# [  119.415568]  ? syscall_enter_from_user_mode+0x21/0x80
# 
# [  119.427567]  ? syscall_enter_from_user_mode+0x21/0x80
# [  119.427574]  do_syscall_64+0x5c/0x80
# [  119.427583]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  119.437208] # [  114.148030]  ? asm_exc_page_fault+0x8/0x30
# [  119.438027]  ? do_syscall_64+0x69/0x80
# [  119.438034]  ? rcu_read_lock_held_common+0xe/0xc0
# 
# [  119.455761]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  119.455765]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  119.455770]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  119.455775]  ? asm_exc_page_fault+0x8/0x30
# [  119.455784]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  119.459676] # [  114.152993]  ? lockdep_hardirqs_on+0x79/0x100
# [  119.467691]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  119.467697] RIP: 0033:0x7fa9dc040504
# 
# [  119.478149] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  119.478153] RSP: 002b:00007ffc98404cc8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  119.478159] RAX: ffffffffffffffda RBX: 0000000000000019 RCX: 00007fa9dc040504
# [  119.478164] RDX: 0000000000000019 RSI: 00007fa9dbd8f000 RDI: 0000000000000001
# [  119.478169] RBP: 00007fa9dbd8f000 R08: 00000000ffffffff R09: 0000000000000000
# [  119.484865] # [  114.158209]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  119.492107] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fa9dbd8f000
# [  119.492110] R13: 0000000000000001 R14: 0000000000000019 R15: 0000000000020000
# 
# 
# 
# [  119.500705] Memory state around the buggy address:
# [  119.500707]  ffffc90003707e80: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
# [  119.500710]  ffffc90003707f00: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
# [  119.500712] >ffffc90003707f80: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8
# [  119.500715]                                                                 ^
# [  119.500719]  ffffc90003708000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# [  119.500723]  ffffc90003708080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# [  119.508607] # [  114.164083] RIP: 0033:0x7f0c48523504
# [  119.509664] ==================================================================
# [  119.509763] BUG: stack guard page was hit at 00000000b123a168 (stack is 000000001ed0fa28..000000003dc47bd3)
# 
# [  119.524054] kernel stack overflow (page fault): 0000 [#5] PREEMPT SMP KASAN PTI
# [  119.524060] CPU: 2 PID: 1733 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  119.524066] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  119.524069] RIP: 0010:lkdtm_STACK_GUARD_PAGE_LEADING+0x9f/0xcf
# [  119.524080] Code: b8 ff ff 37 00 48 8d 7d ff 48 c1 e0 2a 48 89 fa 48 c1 ea 03 8a 04 02 48 89 fa 83 e2 07 38 d0 7f 09 84 c0 74 05 e8 da d2 fb fd <8a> 45 ff 48 c7 c7 a0 18 5b 84 88 44 24 20 0f b6 74 24 20 e8 3f 8b
# [  119.524087] RSP: 0018:ffffc9000370fc90 EFLAGS: 00010286
# [  119.535424] # [  114.168450] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  119.540272] RAX: 0000000000000001 RBX: 1ffff920006e1f92 RCX: 0000000000000000
# [  119.540277] RDX: 0000000000000001 RSI: 0000000000000000 RDI: ffffffff83c67e38
# [  119.540281] RBP: ffffc90003708000 R08: 0000000000000000 R09: 0000000000000000
# [  119.540286] R10: ffffffff85a148c3 R11: fffffbfff0b42918 R12: 0000000000000019
# [  119.540292] R13: dffffc0000000000 R14: 00000000000000c0 R15: ffff8888994fa000
# 
# [  119.550653] FS:  00007fa9dc118540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  119.550658] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  119.550661] CR2: ffffc90003707fff CR3: 00000001a2bbc004 CR4: 00000000003706e0
# [  119.550664] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  119.550667] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  119.550671] Call Trace:
# [  119.550677]  ? lkdtm_CORRUPT_LIST_DEL.cold+0x23a/0x23a
# [  119.559996] # [  114.188519] RSP: 002b:00007ffff1a54d08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  119.563657]  direct_entry.cold+0x2f/0x6f
# [  119.563671]  full_proxy_write+0xfd/0x180
# 
# [  119.572227]  vfs_write+0x184/0x8c0
# [  119.572241]  ksys_write+0xf9/0x200
# [  119.582780] # [  114.197095] RAX: ffffffffffffffda RBX: 0000000000000004 RCX: 00007f0c48523504
# [  119.589375]  ? __ia32_sys_read+0xc0/0xc0
# [  119.589385]  ? syscall_enter_from_user_mode+0x21/0x80
# [  119.589395]  ? syscall_enter_from_user_mode+0x21/0x80
# 
# [  119.599838]  do_syscall_64+0x5c/0x80
# [  119.599846]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  119.599857]  ? do_syscall_64+0x69/0x80
# [  119.612322] # [  114.205209] RDX: 0000000000000004 RSI: 00007f0c48272000 RDI: 0000000000000001
# [  119.616267]  ? rcu_read_lock_held_common+0xe/0xc0
# [  119.616275]  ? rcu_read_lock_sched_held+0x5f/0x100
# 
# [  119.626562]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  119.626570]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  119.626576]  ? asm_exc_page_fault+0x8/0x30
# [  119.626586]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  119.639018] # [  114.213313] RBP: 00007f0c48272000 R08: 00000000ffffffff R09: 0000000000000000
# [  119.643138]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  119.643146] RIP: 0033:0x7fa9dc040504
# [  119.643155] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# 
# [  119.650953] RSP: 002b:00007ffc98404cc8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  119.650959] RAX: ffffffffffffffda RBX: 0000000000000019 RCX: 00007fa9dc040504
# [  119.650962] RDX: 0000000000000019 RSI: 00007fa9dbd8f000 RDI: 0000000000000001
# [  119.650965] RBP: 00007fa9dbd8f000 R08: 00000000ffffffff R09: 0000000000000000
# [  119.650969] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fa9dbd8f000
# [  119.650973] R13: 0000000000000001 R14: 0000000000000019 R15: 0000000000020000
# [  119.660964] # [  114.221423] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f0c48272000
# [  119.666020] Modules linked in:
# 
# [  119.676962]  netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod
# [  119.685180] # [  114.229536] R13: 0000000000000001 R14: 0000000000000004 R15: 0000000000020000
# [  119.687679]  t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel
# 
# [  119.699757]  intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  120.460136] ---[ end trace 9201e83dba6482a8 ]---
# [  120.465599] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  120.470367] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  120.490685] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  120.496853] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  120.504874] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  120.512916] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  120.521014] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  120.529167] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  120.537419] FS:  00007fa9dc118540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  120.546560] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  120.553288] CR2: ffffc90003707fff CR3: 00000001a2bbc004 CR4: 00000000003706e0
# [  120.561318] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  120.569421] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  120.577577] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  120.587468] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 1733, name: cat
# [  120.595938] INFO: lockdep is turned off.
# [  120.600702] irq event stamp: 0
# [  120.604566] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  120.611764] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  120.621018] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  120.630297] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  120.637499] CPU: 2 PID: 1733 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  120.645456] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  120.654462] Call Trace:
# [  120.657770]  dump_stack_lvl+0x45/0x59
# [  120.662261]  ___might_sleep.cold+0x1f2/0x23d
# [  120.667476]  exit_signals+0x74/0x800
# [  120.671888]  ? do_signal_stop+0x700/0x700
# [  120.676752]  ? syscall_enter_from_user_mode+0x21/0x80
# [  120.682677]  do_exit+0x1f1/0x2500
# [  120.686829]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  120.692641]  ? do_syscall_64+0x69/0x80
# [  120.697248]  ? rcu_read_lock_held_common+0xe/0xc0
# [  120.702805]  ? exit_mm+0x5c0/0x5c0
# [  120.707064]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  120.712420]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  120.718150]  ? asm_exc_page_fault+0x8/0x30
# [  120.723068]  rewind_stack_do_exit+0x17/0x17
# [  120.728155] RIP: 0033:0x7fa9dc040504
# [  120.732548] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  120.752480] RSP: 002b:00007ffc98404cc8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  120.761013] RAX: ffffffffffffffda RBX: 0000000000000019 RCX: 00007fa9dc040504
# [  120.769091] RDX: 0000000000000019 RSI: 00007fa9dbd8f000 RDI: 0000000000000001
# [  120.777212] RBP: 00007fa9dbd8f000 R08: 00000000ffffffff R09: 0000000000000000
# [  120.785289] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fa9dbd8f000
# [  120.793382] R13: 0000000000000001 R14: 0000000000000019 R15: 0000000000020000
# STACK_GUARD_PAGE_LEADING: saw 'call trace:': ok
ok 13 selftests: lkdtm: STACK_GUARD_PAGE_LEADING.sh
# selftests: lkdtm: STACK_GUARD_PAGE_TRAILING.sh
# Segmentation fault
# [  121.078675] lkdtm: Performing direct entry STACK_GUARD_PAGE_TRAILING
# [  121.086147] lkdtm: attempting bad read from page above current stack
# [  121.093509] BUG: stack guard page was hit at 00000000e6815669 (stack is 00000000e856d5b8..00000000f47e98d1)
# [  121.104176] kernel stack overflow (page fault): 0000 [#6] PREEMPT SMP KASAN PTI
# [  121.112455] CPU: 2 PID: 1771 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  121.120529] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  121.129715] RIP: 0010:lkdtm_STACK_GUARD_PAGE_TRAILING+0xa2/0xd5
# [  121.136552] Code: 37 00 48 8d bd 00 80 00 00 48 c1 e0 2a 48 89 fa 48 c1 ea 03 8a 04 02 48 89 fa 83 e2 07 38 d0 7f 09 84 c0 74 05 e8 08 d2 fb fd <8a> 85 00 80 00 00 48 c7 c7 60 19 5b 84 88 44 24 20 0f b6 74 24 20
# [  121.156766] RSP: 0018:ffffc9000385fcc8 EFLAGS: 00010282
# [  121.162922] RAX: 0000000000000000 RBX: 1ffff9200070bf99 RCX: ffffffff83bb0278
# [  121.171070] RDX: 0000000000000000 RSI: 0000000000000001 RDI: ffffc90003860000
# [  121.179253] RBP: ffffc90003858000 R08: 0000000000000038 R09: ffffed1102755921
# [  121.187347] R10: ffff888813aac907 R11: ffffed1102755920 R12: 000000000000001a
# [  121.195431] R13: dffffc0000000000 R14: 00000000000000d0 R15: ffff8888958dc000
# [  121.203556] FS:  00007f7e28c00540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  121.212692] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  121.219384] CR2: ffffc90003860000 CR3: 00000001da130001 CR4: 00000000003706e0
# [  121.227508] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  121.235656] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  121.243794] Call Trace:
# [  121.247035]  ? lkdtm_STACK_GUARD_PAGE_LEADING+0xcf/0xcf
# [  121.253319]  direct_entry.cold+0x2f/0x6f
# [  121.258186]  full_proxy_write+0xfd/0x180
# [  121.263013]  vfs_write+0x184/0x8c0
# [  121.267251]  ksys_write+0xf9/0x200
# [  121.271554]  ? __ia32_sys_read+0xc0/0xc0
# [  121.276366]  ? syscall_enter_from_user_mode+0x21/0x80
# [  121.282314]  ? syscall_enter_from_user_mode+0x21/0x80
# [  121.288313]  do_syscall_64+0x5c/0x80
# [  121.292788]  ? handle_mm_fault+0x219/0x800
# [  121.297804]  ? rcu_read_lock_held_common+0xe/0xc0
# [  121.303400]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  121.309073]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  121.314455]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  121.320209]  ? asm_exc_page_fault+0x8/0x30
# [  121.325194]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  121.331029]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  121.337049] RIP: 0033:0x7f7e28b28504
# [  121.341578] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  121.361893] RSP: 002b:00007ffdd938b048 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  121.370582] RAX: ffffffffffffffda RBX: 000000000000001a RCX: 00007f7e28b28504
# [  121.378786] RDX: 000000000000001a RSI: 00007f7e28877000 RDI: 0000000000000001
# [  121.387025] RBP: 00007f7e28877000 R08: 00000000ffffffff R09: 0000000000000000
# [  121.395213] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f7e28877000
# [  121.403363] R13: 0000000000000001 R14: 000000000000001a R15: 0000000000020000
# [  121.411505] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  121.462518] ---[ end trace 9201e83dba6482a9 ]---
# [  121.468070] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  121.472870] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  121.493057] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  121.499183] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  121.507237] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  121.515417] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  121.523600] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  121.531669] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  121.539780] FS:  00007f7e28c00540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  121.548853] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  121.555581] CR2: ffffc90003860000 CR3: 00000001da130001 CR4: 00000000003706e0
# [  121.563770] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  121.571984] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  121.580175] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  121.590142] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 1771, name: cat
# [  121.598656] INFO: lockdep is turned off.
# [  121.603406] irq event stamp: 0
# [  121.607285] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  121.614536] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  121.623839] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  121.633163] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  121.640409] CPU: 2 PID: 1771 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  121.648393] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  121.657546] Call Trace:
# [  121.660870]  dump_stack_lvl+0x45/0x59
# [  121.665426]  ___might_sleep.cold+0x1f2/0x23d
# [  121.670566]  exit_signals+0x74/0x800
# [  121.674975]  ? do_signal_stop+0x700/0x700
# [  121.679869]  ? __ia32_sys_read+0xc0/0xc0
# [  121.684672]  ? syscall_enter_from_user_mode+0x21/0x80
# [  121.690701]  do_exit+0x1f1/0x2500
# [  121.694889]  ? do_syscall_64+0x5c/0x80
# [  121.699525]  ? handle_mm_fault+0x219/0x800
# [  121.704494]  ? rcu_read_lock_held_common+0xe/0xc0
# [  121.710174]  ? exit_mm+0x5c0/0x5c0
# [  121.714361]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  121.719646]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  121.725388]  ? asm_exc_page_fault+0x8/0x30
# [  121.730407]  rewind_stack_do_exit+0x17/0x17
# [  121.735448] RIP: 0033:0x7f7e28b28504
# [  121.739930] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  121.760105] RSP: 002b:00007ffdd938b048 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  121.768667] RAX: ffffffffffffffda RBX: 000000000000001a RCX: 00007f7e28b28504
# [  121.776795] RDX: 000000000000001a RSI: 00007f7e28877000 RDI: 0000000000000001
# [  121.784919] RBP: 00007f7e28877000 R08: 00000000ffffffff R09: 0000000000000000
# [  121.793046] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f7e28877000
# [  121.801107] R13: 0000000000000001 R14: 000000000000001a R15: 0000000000020000
# STACK_GUARD_PAGE_TRAILING: saw 'call trace:': ok
ok 14 selftests: lkdtm: STACK_GUARD_PAGE_TRAILING.sh
# selftests: lkdtm: UNSET_SMEP.sh
# [  122.081544] lkdtm: Performing direct entry UNSET_SMEP
# [  122.087512] lkdtm: trying to clear SMEP normally
# [  122.092968] ------------[ cut here ]------------
# [  122.098442] pinned CR4 bits changed: 0x100000!?
# [  122.103825] WARNING: CPU: 2 PID: 1812 at arch/x86/kernel/cpu/common.c:398 native_write_cr4+0x3e/0x80
# [  122.114025] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  122.165031] CPU: 2 PID: 1812 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  122.173137] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  122.182308] RIP: 0010:native_write_cr4+0x3e/0x80
# [  122.187822] Code: 08 31 00 48 39 c2 75 25 48 85 f6 75 01 c3 80 3d 1b bf f4 04 00 75 f6 48 c7 c7 80 35 25 84 c6 05 0b bf f4 04 01 e8 cd 27 88 02 <0f> 0b c3 48 89 d6 48 81 e7 ff f7 ce ff 48 31 c6 48 09 c7 eb af 66
# [  122.208063] RSP: 0018:ffffc900039dfd10 EFLAGS: 00010286
# [  122.214399] RAX: 0000000000000000 RBX: 00000000002706e0 RCX: 0000000000000000
# [  122.222529] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff5200073bf94
# [  122.230655] RBP: ffffffff845af4e0 R08: 0000000000000001 R09: ffffed1102755921
# [  122.238856] R10: ffff888813aac907 R11: ffffed1102755920 R12: 000000000000000b
# [  122.246997] R13: dffffc0000000000 R14: 00000000000000e0 R15: ffff8888986c2000
# [  122.255080] FS:  00007f302a5a2540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  122.264193] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  122.270899] CR2: 00007f302a219000 CR3: 000000089cd30005 CR4: 00000000003706e0
# [  122.279075] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  122.287265] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  122.295412] Call Trace:
# [  122.298707]  lkdtm_UNSET_SMEP.cold+0x1d/0x287
# [  122.304026]  direct_entry.cold+0x2f/0x6f
# [  122.308874]  full_proxy_write+0xfd/0x180
# [  122.313674]  vfs_write+0x184/0x8c0
# [  122.317997]  ksys_write+0xf9/0x200
# [  122.322687]  ? __ia32_sys_read+0xc0/0xc0
# [  122.327531]  ? syscall_enter_from_user_mode+0x21/0x80
# [  122.333544]  ? syscall_enter_from_user_mode+0x21/0x80
# [  122.339571]  do_syscall_64+0x5c/0x80
# [  122.344044]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  122.349733]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  122.355559]  ? do_syscall_64+0x69/0x80
# [  122.360253]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  122.366013]  ? asm_exc_page_fault+0x8/0x30
# [  122.371058]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  122.376887]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  122.382995] RIP: 0033:0x7f302a4ca504
# [  122.387493] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  122.407557] RSP: 002b:00007ffc5905e6c8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  122.416075] RAX: ffffffffffffffda RBX: 000000000000000b RCX: 00007f302a4ca504
# [  122.424317] RDX: 000000000000000b RSI: 00007f302a219000 RDI: 0000000000000001
# [  122.432423] RBP: 00007f302a219000 R08: 00000000ffffffff R09: 0000000000000000
# [  122.440670] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f302a219000
# [  122.448881] R13: 0000000000000001 R14: 000000000000000b R15: 0000000000020000
# [  122.457001] irq event stamp: 0
# [  122.460913] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  122.468112] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  122.477406] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  122.486794] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  122.494052] ---[ end trace 9201e83dba6482aa ]---
# [  122.499577] lkdtm: ok: SMEP did not get cleared
# [  122.505032] lkdtm: trying to clear SMEP with call gadget
# [  122.511202] lkdtm: ok: SMEP removal was reverted
# UNSET_SMEP: saw 'pinned CR4 bits changed:': ok
ok 15 selftests: lkdtm: UNSET_SMEP.sh
# selftests: lkdtm: DOUBLE_FAULT.sh
# [  122.740188] lkdtm: Performing direct entry DOUBLE_FAULT
# [  122.746380] lkdtm: XFAIL: this test is ia32-only
# DOUBLE_FAULT: saw 'XFAIL': [SKIP]
ok 16 selftests: lkdtm: DOUBLE_FAULT.sh # SKIP
# selftests: lkdtm: CORRUPT_PAC.sh
# [  122.970814] lkdtm: Performing direct entry CORRUPT_PAC
# [  122.976981] lkdtm: XFAIL: this test is arm64-only
# CORRUPT_PAC: saw 'XFAIL': [SKIP]
ok 17 selftests: lkdtm: CORRUPT_PAC.sh # SKIP
# selftests: lkdtm: UNALIGNED_LOAD_STORE_WRITE.sh
# [  123.200940] lkdtm: Performing direct entry UNALIGNED_LOAD_STORE_WRITE
# [  123.208387] lkdtm: XFAIL: arch has CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS
# UNALIGNED_LOAD_STORE_WRITE: saw 'XFAIL': [SKIP]
ok 18 selftests: lkdtm: UNALIGNED_LOAD_STORE_WRITE.sh # SKIP
# selftests: lkdtm: SLAB_LINEAR_OVERFLOW.sh
# [  123.435154] lkdtm: Performing direct entry SLAB_LINEAR_OVERFLOW
# [  123.442065] lkdtm: Attempting slab linear overflow ...
# SLAB_LINEAR_OVERFLOW: missing 'call trace:': [FAIL]
not ok 19 selftests: lkdtm: SLAB_LINEAR_OVERFLOW.sh # exit=1
# selftests: lkdtm: VMALLOC_LINEAR_OVERFLOW.sh
# Killed
# [  123.691862] lkdtm: Performing direct entry VMALLOC_LINEAR_OVERFLOW
# [  123.699110] lkdtm: Attempting vmalloc linear overflow ...
# [  123.705442] BUG: unable to handle page fault for address: ffffc900002e7000
# [  123.713312] #PF: supervisor write access in kernel mode
# [  123.719531] #PF: error_code(0x0002) - not-present page
# [  123.725572] PGD 100000067 P4D 100000067 PUD 100244067 PMD 100eb1067 PTE 0
# [  123.733356] Oops: 0002 [#7] PREEMPT SMP KASAN PTI
# [  123.739023] CPU: 3 PID: 1986 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  123.747096] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  123.756343] RIP: 0010:memset_erms+0x9/0x10
# [  123.761466] Code: c1 e9 03 40 0f b6 f6 48 b8 01 01 01 01 01 01 01 01 48 0f af c6 f3 48 ab 89 d1 f3 aa 4c 89 c8 c3 90 49 89 f9 40 88 f0 48 89 d1 <f3> aa 4c 89 c8 c3 90 49 89 fa 40 0f b6 ce 48 b8 01 01 01 01 01 01
# [  123.781727] RSP: 0018:ffffc9000412fcb8 EFLAGS: 00010202
# [  123.787970] RAX: 00000000000000aa RBX: 0000000000000012 RCX: 0000000000000001
# [  123.796060] RDX: 0000000000001001 RSI: 00000000000000aa RDI: ffffc900002e7000
# [  123.804292] RBP: ffffc900002e6000 R08: 0000000000000001 R09: ffffc900002e6000
# [  123.812378] R10: 0000000000000000 R11: fffff5200005ce00 R12: ffffc90000304000
# [  123.820514] R13: dffffc0000000000 R14: 0000000000000120 R15: ffff8882125dc000
# [  123.828722] FS:  00007f7ce0cca540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  123.837944] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  123.844606] CR2: ffffc900002e7000 CR3: 00000002ae0a0005 CR4: 00000000003706e0
# [  123.852756] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  123.860868] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  123.869057] Call Trace:
# [  123.872349]  lkdtm_VMALLOC_LINEAR_OVERFLOW+0x49/0x80
# [  123.878262]  direct_entry.cold+0x2f/0x6f
# [  123.883122]  full_proxy_write+0xfd/0x180
# [  123.887946]  vfs_write+0x184/0x8c0
# [  123.892221]  ksys_write+0xf9/0x200
# [  123.896524]  ? __ia32_sys_read+0xc0/0xc0
# [  123.901325]  ? syscall_enter_from_user_mode+0x21/0x80
# [  123.907337]  ? syscall_enter_from_user_mode+0x21/0x80
# [  123.913324]  do_syscall_64+0x5c/0x80
# [  123.917818]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  123.923184]  ? down_read_nested+0x441/0x480
# [  123.928281]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  123.933975]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  123.939792]  ? do_syscall_64+0x69/0x80
# [  123.944383]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  123.950068]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  123.955461]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  123.961195]  ? asm_exc_page_fault+0x8/0x30
# [  123.966207]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  123.971999]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  123.977958] RIP: 0033:0x7f7ce0bf2504
# [  123.982490] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  124.002715] RSP: 002b:00007ffd4671a618 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  124.011461] RAX: ffffffffffffffda RBX: 0000000000000018 RCX: 00007f7ce0bf2504
# [  124.019692] RDX: 0000000000000018 RSI: 00007f7ce0941000 RDI: 0000000000000001
# [  124.027916] RBP: 00007f7ce0941000 R08: 00000000ffffffff R09: 0000000000000000
# [  124.036063] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f7ce0941000
# [  124.044271] R13: 0000000000000001 R14: 0000000000000018 R15: 0000000000020000
# [  124.052396] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  124.103498] CR2: ffffc900002e7000
# [  124.107644] ---[ end trace 9201e83dba6482ab ]---
# [  124.113175] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  124.117895] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  124.137941] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  124.144113] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  124.152143] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  124.160359] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  124.168539] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  124.176602] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  124.184730] FS:  00007f7ce0cca540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  124.193855] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  124.200527] CR2: ffffc900002e7000 CR3: 00000002ae0a0005 CR4: 00000000003706e0
# [  124.208633] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  124.216752] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  124.224882] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  124.234697] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 1986, name: cat
# [  124.243273] INFO: lockdep is turned off.
# [  124.248071] irq event stamp: 0
# [  124.251978] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  124.259171] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  124.268433] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  124.277732] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  124.284955] CPU: 3 PID: 1986 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  124.292951] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  124.302057] Call Trace:
# [  124.305296]  dump_stack_lvl+0x45/0x59
# [  124.309830]  ___might_sleep.cold+0x1f2/0x23d
# [  124.314940]  exit_signals+0x74/0x800
# [  124.319392]  ? do_signal_stop+0x700/0x700
# [  124.324241]  ? syscall_enter_from_user_mode+0x21/0x80
# [  124.330274]  do_exit+0x1f1/0x2500
# [  124.334408]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  124.340142]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  124.345899]  ? do_syscall_64+0x69/0x80
# [  124.350564]  ? exit_mm+0x5c0/0x5c0
# [  124.354783]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  124.360092]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  124.365722]  ? asm_exc_page_fault+0x8/0x30
# [  124.370681]  rewind_stack_do_exit+0x17/0x17
# [  124.375753] RIP: 0033:0x7f7ce0bf2504
# [  124.380204] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  124.400423] RSP: 002b:00007ffd4671a618 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  124.409020] RAX: ffffffffffffffda RBX: 0000000000000018 RCX: 00007f7ce0bf2504
# [  124.417122] RDX: 0000000000000018 RSI: 00007f7ce0941000 RDI: 0000000000000001
# [  124.425209] RBP: 00007f7ce0941000 R08: 00000000ffffffff R09: 0000000000000000
# [  124.433285] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f7ce0941000
# [  124.441377] R13: 0000000000000001 R14: 0000000000000018 R15: 0000000000020000
# VMALLOC_LINEAR_OVERFLOW: saw 'call trace:': ok
ok 20 selftests: lkdtm: VMALLOC_LINEAR_OVERFLOW.sh
# selftests: lkdtm: WRITE_AFTER_FREE.sh
# Skipping WRITE_AFTER_FREE: Corrupts memory on failure
ok 21 selftests: lkdtm: WRITE_AFTER_FREE.sh # SKIP
# selftests: lkdtm: READ_AFTER_FREE.sh
# [  124.857868] lkdtm: Performing direct entry READ_AFTER_FREE
# [  124.864246] lkdtm: Value in memory before free: 12345678
# [  124.870507] lkdtm: Attempting bad read from freed memory
# [  124.876815] lkdtm: FAIL: Memory was not poisoned!
# [  124.882482] lkdtm: This is probably expected, since this kernel (5.15.0 x86_64) was built *without* CONFIG_INIT_ON_FREE_DEFAULT_ON=y (and booted without 'init_on_free' specified)
# READ_AFTER_FREE: missing 'call trace:|Memory correctly poisoned': [FAIL]
not ok 22 selftests: lkdtm: READ_AFTER_FREE.sh # exit=1
# selftests: lkdtm: WRITE_BUDDY_AFTER_FREE.sh
# Skipping WRITE_BUDDY_AFTER_FREE: Corrupts memory on failure
ok 23 selftests: lkdtm: WRITE_BUDDY_AFTER_FREE.sh # SKIP
# selftests: lkdtm: READ_BUDDY_AFTER_FREE.sh
# [  125.262486] lkdtm: Performing direct entry READ_BUDDY_AFTER_FREE
# [  125.269564] lkdtm: Value in memory before free: 12345678
# [  125.275874] lkdtm: Attempting to read from freed memory
# [  125.282103] lkdtm: FAIL: Buddy page was not poisoned!
# [  125.288235] lkdtm: This is probably expected, since this kernel (5.15.0 x86_64) was built *without* CONFIG_INIT_ON_FREE_DEFAULT_ON=y (and booted without 'init_on_free' specified)
# READ_BUDDY_AFTER_FREE: missing 'call trace:|Memory correctly poisoned': [FAIL]
not ok 24 selftests: lkdtm: READ_BUDDY_AFTER_FREE.sh # exit=1
# selftests: lkdtm: SLAB_INIT_ON_ALLOC.sh
# [  125.539959] lkdtm: Performing direct entry SLAB_INIT_ON_ALLOC
# [  125.546833] lkdtm: Reallocation missed clobbered memory.
# [  125.553159] lkdtm: Memory appears initialized (0, no earlier values)
# SLAB_INIT_ON_ALLOC: saw 'Memory appears initialized': ok
ok 25 selftests: lkdtm: SLAB_INIT_ON_ALLOC.sh
# selftests: lkdtm: BUDDY_INIT_ON_ALLOC.sh
# [  125.790757] lkdtm: Performing direct entry BUDDY_INIT_ON_ALLOC
# [  125.797642] lkdtm: Memory appears initialized (0, no earlier values)
# BUDDY_INIT_ON_ALLOC: saw 'Memory appears initialized': ok
ok 26 selftests: lkdtm: BUDDY_INIT_ON_ALLOC.sh
# selftests: lkdtm: SLAB_FREE_DOUBLE.sh
# [  126.026321] lkdtm: Performing direct entry SLAB_FREE_DOUBLE
# [  126.033031] lkdtm: Attempting double slab free ...
# [  126.039072] ==================================================================
# [  126.047293] BUG: KASAN: double-free or invalid-free in direct_entry.cold+0x2f/0x6f
# 
# [  126.058047] CPU: 0 PID: 2226 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  126.066137] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  126.075315] Call Trace:
# [  126.078581]  dump_stack_lvl+0x45/0x59
# [  126.083142]  print_address_description.constprop.0+0x21/0x140
# [  126.089891]  ? direct_entry.cold+0x2f/0x6f
# [  126.094859]  ? direct_entry.cold+0x2f/0x6f
# [  126.099843]  kasan_report_invalid_free+0x51/0x80
# [  126.105400]  ? direct_entry.cold+0x2f/0x6f
# [  126.110373]  __kasan_slab_free+0x106/0x140
# [  126.115383]  kmem_cache_free+0x101/0x3c0
# [  126.120238]  direct_entry.cold+0x2f/0x6f
# [  126.125021]  full_proxy_write+0xfd/0x180
# [  126.129847]  vfs_write+0x184/0x8c0
# [  126.134128]  ksys_write+0xf9/0x200
# [  126.138400]  ? __ia32_sys_read+0xc0/0xc0
# [  126.143238]  ? syscall_enter_from_user_mode+0x21/0x80
# [  126.149116]  ? syscall_enter_from_user_mode+0x21/0x80
# [  126.155019]  do_syscall_64+0x5c/0x80
# [  126.159431]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  126.165234]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  126.171159] RIP: 0033:0x7f0b93aee504
# [  126.175580] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  126.195724] RSP: 002b:00007ffeece48428 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  126.204196] RAX: ffffffffffffffda RBX: 0000000000000011 RCX: 00007f0b93aee504
# [  126.212377] RDX: 0000000000000011 RSI: 00007f0b9383d000 RDI: 0000000000000001
# [  126.220472] RBP: 00007f0b9383d000 R08: 00000000ffffffff R09: 0000000000000000
# [  126.228678] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f0b9383d000
# [  126.236832] R13: 0000000000000001 R14: 0000000000000011 R15: 0000000000020000
# 
# [  126.247098] Allocated by task 2226:
# [  126.251425]  kasan_save_stack+0x1b/0x40
# [  126.256110]  __kasan_slab_alloc+0x61/0x80
# [  126.260907]  kmem_cache_alloc+0x12d/0x680
# [  126.265769]  lkdtm_SLAB_FREE_DOUBLE+0x17/0x40
# [  126.271012]  direct_entry.cold+0x2f/0x6f
# [  126.275787]  full_proxy_write+0xfd/0x180
# [  126.280504]  vfs_write+0x184/0x8c0
# [  126.284724]  ksys_write+0xf9/0x200
# [  126.288963]  do_syscall_64+0x5c/0x80
# [  126.293373]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# 
# [  126.301672] Freed by task 2226:
# [  126.305737]  kasan_save_stack+0x1b/0x40
# [  126.310492]  kasan_set_track+0x1c/0x40
# [  126.315093]  kasan_set_free_info+0x20/0x40
# [  126.320110]  __kasan_slab_free+0xea/0x140
# [  126.325060]  kmem_cache_free+0x101/0x3c0
# [  126.329834]  lkdtm_SLAB_FREE_DOUBLE.cold+0x41/0x68
# [  126.335520]  direct_entry.cold+0x2f/0x6f
# [  126.340354]  full_proxy_write+0xfd/0x180
# [  126.345121]  vfs_write+0x184/0x8c0
# [  126.349316]  ksys_write+0xf9/0x200
# [  126.353624]  do_syscall_64+0x5c/0x80
# [  126.358015]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# 
# [  126.366158] The buggy address belongs to the object at ffff888893aee5b0
#                 which belongs to the cache lkdtm-heap-double_free of size 64
# [  126.381241] The buggy address is located 0 bytes inside of
#                 64-byte region [ffff888893aee5b0, ffff888893aee5f0)
# [  126.394399] The buggy address belongs to the page:
# [  126.400069] page:00000000aa22894c refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x893aee
# [  126.410465] flags: 0x17ffffc0000200(slab|node=0|zone=2|lastcpupid=0x1fffff)
# [  126.418454] raw: 0017ffffc0000200 0000000000000000 dead000000000122 ffff888103b3b540
# [  126.427200] raw: 0000000000000000 0000000080270027 00000001ffffffff 0000000000000000
# [  126.435937] page dumped because: kasan: bad access detected
# 
# [  126.444650] Memory state around the buggy address:
# [  126.450283]  ffff888893aee480: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
# [  126.458451]  ffff888893aee500: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
# [  126.466540] >ffff888893aee580: fc fc fc fc fc fc fa fb fb fb fb fb fb fb fc fc
# [  126.474614]                                      ^
# [  126.480236]  ffff888893aee600: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
# [  126.488343]  ffff888893aee680: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
# [  126.496445] ==================================================================
# SLAB_FREE_DOUBLE: saw 'call trace:': ok
ok 27 selftests: lkdtm: SLAB_FREE_DOUBLE.sh
# selftests: lkdtm: SLAB_FREE_CROSS.sh
# [  126.734446] lkdtm: Performing direct entry SLAB_FREE_CROSS
# [  126.741082] lkdtm: Attempting cross-cache slab free ...
# [  126.747218] ------------[ cut here ]------------
# [  126.752810] cache_from_obj: Wrong slab cache. lkdtm-heap-b but object is from lkdtm-heap-a
# [  126.762157] WARNING: CPU: 6 PID: 2261 at mm/slab.h:449 kmem_cache_free+0x2d3/0x3c0
# [  126.770944] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  126.821663] CPU: 6 PID: 2261 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  126.829768] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  126.838972] RIP: 0010:kmem_cache_free+0x2d3/0x3c0
# [  126.845016] Code: 85 65 fe ff ff e8 cc b8 49 ff e9 5b fe ff ff 48 8b 57 60 48 8b 4d 60 48 c7 c6 10 4b 39 84 48 c7 c7 a8 97 ab 84 e8 f8 31 fc 01 <0f> 0b 4c 89 e6 48 89 ef e8 60 80 ff ff 48 8b 0d 69 68 fe 02 e9 b7
# [  126.865300] RSP: 0018:ffffc90004b9fd88 EFLAGS: 00010282
# [  126.871526] RAX: 0000000000000000 RBX: ffff888937bb7410 RCX: 0000000000000000
# [  126.879655] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000973fa3
# [  126.887974] RBP: ffff888103b3b7c0 R08: 0000000000000001 R09: ffffed1102775921
# [  126.896154] R10: ffff888813bac907 R11: ffffed1102775920 R12: ffff8888b7bb7410
# [  126.904288] R13: dffffc0000000000 R14: 00000000000001a0 R15: 0000000000000000
# [  126.912475] FS:  00007f1865956540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# [  126.921734] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  126.928522] CR2: 00007f18655cd000 CR3: 000000089b97e005 CR4: 00000000003706e0
# [  126.936743] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  126.944888] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  126.953139] Call Trace:
# [  126.956478]  direct_entry.cold+0x2f/0x6f
# [  126.961375]  full_proxy_write+0xfd/0x180
# [  126.966232]  vfs_write+0x184/0x8c0
# [  126.970575]  ksys_write+0xf9/0x200
# [  126.974871]  ? __ia32_sys_read+0xc0/0xc0
# [  126.979738]  ? rcu_tasks_trace_pregp_step+0x101/0x180
# [  126.985803]  ? syscall_enter_from_user_mode+0x21/0x80
# [  126.991898]  ? syscall_enter_from_user_mode+0x21/0x80
# [  126.997850]  do_syscall_64+0x5c/0x80
# [  127.002366]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  127.008236]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  127.014285] RIP: 0033:0x7f186587e504
# [  127.018789] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  127.039026] RSP: 002b:00007ffee60d73b8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  127.047735] RAX: ffffffffffffffda RBX: 0000000000000010 RCX: 00007f186587e504
# [  127.055887] RDX: 0000000000000010 RSI: 00007f18655cd000 RDI: 0000000000000001
# [  127.064095] RBP: 00007f18655cd000 R08: 00000000ffffffff R09: 0000000000000000
# [  127.072351] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f18655cd000
# [  127.080536] R13: 0000000000000001 R14: 0000000000000010 R15: 0000000000020000
# [  127.088775] irq event stamp: 0
# [  127.092765] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  127.100055] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  127.109317] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  127.118676] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  127.125967] ---[ end trace 9201e83dba6482ac ]---
# SLAB_FREE_CROSS: saw 'call trace:': ok
ok 28 selftests: lkdtm: SLAB_FREE_CROSS.sh
# selftests: lkdtm: SLAB_FREE_PAGE.sh
# [  127.359205] lkdtm: Performing direct entry SLAB_FREE_PAGE
# [  127.365696] lkdtm: Attempting non-Slab slab free ...
# [  127.371668] ------------[ cut here ]------------
# [  127.377221] virt_to_cache: Object is not a Slab page!
# [  127.383159] WARNING: CPU: 0 PID: 2293 at mm/slab.h:413 kmem_cache_free+0x313/0x3c0
# [  127.391858] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  127.442801] CPU: 0 PID: 2293 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  127.450862] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  127.460540] RIP: 0010:kmem_cache_free+0x313/0x3c0
# [  127.466131] Code: fd ff ff 80 3d 09 ca 68 04 00 0f 85 55 fe ff ff 48 c7 c6 00 4b 39 84 48 c7 c7 88 97 ab 84 c6 05 ee c9 68 04 01 e8 b8 31 fc 01 <0f> 0b e9 34 fe ff ff 0f 0b e8 5e b8 49 ff e9 28 fe ff ff e8 55 18
# [  127.486491] RSP: 0018:ffffc90004cdfd68 EFLAGS: 00010286
# [  127.492761] RAX: 0000000000000000 RBX: ffff88891bad9000 RCX: 0000000000000000
# [  127.500910] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff5200099bf9f
# [  127.509171] RBP: ffff88889bad9000 R08: 0000000000000001 R09: ffffed1102745921
# [  127.517271] R10: ffff888813a2c907 R11: ffffed1102745920 R12: ffff88889bad9000
# [  127.525509] R13: dffffc0000000000 R14: 00000000000001b0 R15: 0000000000000000
# [  127.533765] FS:  00007f3f135d3540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  127.542757] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  127.549356] CR2: 00007f3f1324a000 CR3: 00000001315c8005 CR4: 00000000003706f0
# [  127.557497] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  127.565610] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  127.573703] Call Trace:
# [  127.576980]  lkdtm_SLAB_FREE_PAGE+0x2b/0x40
# [  127.582054]  direct_entry.cold+0x2f/0x6f
# [  127.586915]  full_proxy_write+0xfd/0x180
# [  127.591812]  vfs_write+0x184/0x8c0
# [  127.596152]  ksys_write+0xf9/0x200
# [  127.600411]  ? __ia32_sys_read+0xc0/0xc0
# [  127.605206]  ? rcu_read_lock_bh_held+0x81/0xc0
# [  127.610552]  ? syscall_enter_from_user_mode+0x21/0x80
# [  127.616451]  ? syscall_enter_from_user_mode+0x21/0x80
# [  127.622381]  do_syscall_64+0x5c/0x80
# [  127.626828]  ? do_syscall_64+0x69/0x80
# [  127.631449]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  127.637310]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  127.643282] RIP: 0033:0x7f3f134fb504
# [  127.647656] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  127.667770] RSP: 002b:00007ffcae4c72b8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  127.676367] RAX: ffffffffffffffda RBX: 000000000000000f RCX: 00007f3f134fb504
# [  127.684589] RDX: 000000000000000f RSI: 00007f3f1324a000 RDI: 0000000000000001
# [  127.692709] RBP: 00007f3f1324a000 R08: 00000000ffffffff R09: 0000000000000000
# [  127.699775] # [  114.237622] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# 
# [  127.700889] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f3f1324a000
# [  127.700895] R13: 0000000000000001 R14: 000000000000000f R15: 0000000000020000
# [  127.771421] irq event stamp: 0
# [  127.775335] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  127.782590] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  127.791888] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  127.801272] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  127.808554] ---[ end trace 9201e83dba6482ad ]---
# SLAB_FREE_PAGE: saw 'call trace:': ok
ok 29 selftests: lkdtm: SLAB_FREE_PAGE.sh
# selftests: lkdtm: SOFTLOCKUP.sh
# Skipping SOFTLOCKUP: Hangs the system
ok 30 selftests: lkdtm: SOFTLOCKUP.sh # SKIP
# selftests: lkdtm: HARDLOCKUP.sh
# Skipping HARDLOCKUP: Hangs the system
ok 31 selftests: lkdtm: HARDLOCKUP.sh # SKIP
# selftests: lkdtm: SPINLOCKUP.sh
# Skipping SPINLOCKUP: Hangs the system
ok 32 selftests: lkdtm: SPINLOCKUP.sh # SKIP
# selftests: lkdtm: HUNG_TASK.sh
# Skipping HUNG_TASK: Hangs the system
ok 33 selftests: lkdtm: HUNG_TASK.sh # SKIP
# selftests: lkdtm: EXEC_DATA.sh
# Killed
# [  128.521924] lkdtm: Performing direct entry EXEC_DATA
# [  128.527859] lkdtm: attempting ok execution at ffffffff82a93b40
# [  128.534630] lkdtm: attempting bad execution at ffffffff87c27f20
# [  128.541536] kernel tried to execute NX-protected page - exploit attempt? (uid: 0)
# [  128.550113] BUG: unable to handle page fault for address: ffffffff87c27f20
# [  128.558081] #PF: supervisor instruction fetch in kernel mode
# [  128.564733] #PF: error_code(0x0011) - permissions violation
# [  128.571233] PGD 8bc22d067 P4D 8bc22d067 PUD 8bc22e063 PMD 80000008bec000e3 
# [  128.579271] Oops: 0011 [#8] PREEMPT SMP KASAN PTI
# [  128.584899] CPU: 3 PID: 2444 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  128.592975] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  128.602127] RIP: 0010:data_area+0x0/0x60
# [  128.607012] Code: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 <0f> 1f 44 00 00 c3 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f
# [  128.627323] RSP: 0018:ffffc900051bfda0 EFLAGS: 00010286
# [  128.633493] RAX: 0000000000000033 RBX: ffffffff87c27f20 RCX: 0000000000000000
# [  128.641704] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000a37fa8
# [  128.649896] RBP: 0000000000000001 R08: 0000000000000033 R09: ffffed110275d921
# [  128.658077] R10: ffff888813aec907 R11: ffffed110275d920 R12: 000000000000000a
# [  128.666308] R13: dffffc0000000000 R14: 0000000000000230 R15: ffff88816ccec000
# [  128.674481] FS:  00007fa587129540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  128.683641] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  128.690402] CR2: ffffffff87c27f20 CR3: 0000000103f0e002 CR4: 00000000003706e0
# [  128.698569] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  128.706669] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  128.714861] Call Trace:
# [  128.718118]  ? execute_location+0x4c/0x5a
# [  128.723036]  ? direct_entry.cold+0x2f/0x6f
# [  128.728035]  ? full_proxy_write+0xfd/0x180
# [  128.733066]  ? vfs_write+0x184/0x8c0
# [  128.737581]  ? ksys_write+0xf9/0x200
# [  128.742029]  ? __ia32_sys_read+0xc0/0xc0
# [  128.746867]  ? syscall_enter_from_user_mode+0x21/0x80
# [  128.752877]  ? syscall_enter_from_user_mode+0x21/0x80
# [  128.758910]  ? do_syscall_64+0x5c/0x80
# [  128.763566]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  128.769412]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  128.775665] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  128.826716] CR2: ffffffff87c27f20
# [  128.830960] ---[ end trace 9201e83dba6482ae ]---
# [  128.836509] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  128.841325] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  128.861479] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  128.867622] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  128.875767] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  128.883885] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  128.892030] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  128.900203] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  128.908367] FS:  00007fa587129540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  128.917529] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  128.924282] CR2: ffffffff87c27f20 CR3: 0000000103f0e002 CR4: 00000000003706e0
# [  128.932467] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  128.940641] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  128.948823] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  128.958847] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2444, name: cat
# [  128.967498] INFO: lockdep is turned off.
# [  128.972353] irq event stamp: 0
# [  128.976285] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  128.983495] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  128.992839] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  129.002152] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  129.009390] CPU: 3 PID: 2444 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  129.017437] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  129.026634] Call Trace:
# [  129.029905]  dump_stack_lvl+0x45/0x59
# [  129.034448]  ___might_sleep.cold+0x1f2/0x23d
# [  129.039643]  exit_signals+0x74/0x800
# [  129.044050]  ? do_signal_stop+0x700/0x700
# [  129.048922]  ? full_proxy_write+0xfd/0x180
# [  129.053898]  do_exit+0x1f1/0x2500
# [  129.058125]  ? ksys_write+0xf9/0x200
# [  129.062590]  ? __ia32_sys_read+0xc0/0xc0
# [  129.067471]  ? syscall_enter_from_user_mode+0x21/0x80
# [  129.073487]  ? exit_mm+0x5c0/0x5c0
# [  129.077859]  ? syscall_enter_from_user_mode+0x21/0x80
# [  129.083808]  rewind_stack_do_exit+0x17/0x17
# [  129.088893] RIP: 0033:0x7fa587051504
# [  129.093358] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  129.113548] RSP: 002b:00007ffc7e817688 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  129.122153] RAX: ffffffffffffffda RBX: 000000000000000a RCX: 00007fa587051504
# [  129.130283] RDX: 000000000000000a RSI: 00007fa586da0000 RDI: 0000000000000001
# [  129.138473] RBP: 00007fa586da0000 R08: 00000000ffffffff R09: 0000000000000000
# [  129.146593] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fa586da0000
# [  129.154723] R13: 0000000000000001 R14: 000000000000000a R15: 0000000000020000
# EXEC_DATA: saw 'call trace:': ok
ok 34 selftests: lkdtm: EXEC_DATA.sh
# selftests: lkdtm: EXEC_STACK.sh
# Killed
# [  129.413215] lkdtm: Performing direct entry EXEC_STACK
# [  129.419344] lkdtm: attempting ok execution at ffffffff82a93b40
# [  129.426160] lkdtm: attempting bad execution at ffffc9000531fcc0
# [  129.433101] kernel tried to execute NX-protected page - exploit attempt? (uid: 0)
# [  129.441664] BUG: unable to handle page fault for address: ffffc9000531fcc0
# [  129.449637] #PF: supervisor instruction fetch in kernel mode
# [  129.456315] #PF: error_code(0x0011) - permissions violation
# [  129.462833] PGD 100000067 P4D 100000067 PUD 100244067 PMD 8954cc067 PTE 80000002b04c6063
# [  129.471966] Oops: 0011 [#9] PREEMPT SMP KASAN PTI
# [  129.477618] CPU: 2 PID: 2479 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  129.485795] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  129.494998] RIP: 0010:0xffffc9000531fcc0
# [  129.499844] Code: ff ff 11 10 bb 83 ff ff ff ff b3 8a b5 41 00 00 00 00 0a d3 b0 84 ff ff ff ff a8 0f bb 83 ff ff ff ff 08 fd 31 05 00 c9 ff ff <0f> 1f 44 00 00 c3 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f
# [  129.520229] RSP: 0018:ffffc9000531fc80 EFLAGS: 00010282
# [  129.526419] RAX: 0000000000000033 RBX: ffffc9000531fcc0 RCX: 0000000000000000
# [  129.534601] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000a63f84
# [  129.542820] RBP: 0000000000000001 R08: 0000000000000033 R09: ffffed1102755921
# [  129.551015] R10: ffff888813aac907 R11: ffffed1102755920 R12: 000000000000000b
# [  129.559144] R13: dffffc0000000000 R14: 0000000000000240 R15: ffff8881a3f0a000
# [  129.567345] FS:  00007fe82bfc9540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  129.576563] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  129.583306] CR2: ffffc9000531fcc0 CR3: 00000008a6e84005 CR4: 00000000003706e0
# [  129.591531] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  129.599765] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  129.607948] Call Trace:
# [  129.611291]  ? execute_location+0x4c/0x5a
# [  129.616298]  ? lkdtm_EXEC_STACK+0x69/0x97
# [  129.621218]  ? lkdtm_EXEC_DATA+0x16/0x16
# [  129.626126]  ? direct_entry.cold+0x2f/0x6f
# [  129.631179]  ? full_proxy_write+0xfd/0x180
# [  129.636163]  ? vfs_write+0x184/0x8c0
# [  129.640644]  ? ksys_write+0xf9/0x200
# [  129.645080]  ? __ia32_sys_read+0xc0/0xc0
# [  129.649933]  ? syscall_enter_from_user_mode+0x21/0x80
# [  129.655932]  ? syscall_enter_from_user_mode+0x21/0x80
# [  129.661934]  ? do_syscall_64+0x5c/0x80
# [  129.666585]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  129.672389]  ? do_syscall_64+0x69/0x80
# [  129.677055]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  129.682819]  ? asm_exc_page_fault+0x8/0x30
# [  129.687858]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  129.693605]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  129.699857] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  129.750871] CR2: ffffc9000531fcc0
# [  129.755055] ---[ end trace 9201e83dba6482af ]---
# [  129.760586] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  129.765379] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  129.785422] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  129.791667] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  129.799729] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  129.807900] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  129.816066] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  129.824265] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  129.832430] FS:  00007fe82bfc9540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  129.841629] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  129.848336] CR2: ffffc9000531fcc0 CR3: 00000008a6e84005 CR4: 00000000003706e0
# [  129.856420] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  129.864547] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# EXEC_STACK: saw 'call trace:': ok
ok 35 selftests: lkdtm: EXEC_STACK.sh
# selftests: lkdtm: EXEC_KMALLOC.sh
# Killed
# [  130.109545] lkdtm: Performing direct entry EXEC_KMALLOC
# [  130.115700] lkdtm: attempting ok execution at ffffffff82a93b40
# [  130.122491] lkdtm: attempting bad execution at ffff8888a16f5500
# [  130.129350] kernel tried to execute NX-protected page - exploit attempt? (uid: 0)
# [  130.137808] BUG: unable to handle page fault for address: ffff8888a16f5500
# [  130.145714] #PF: supervisor instruction fetch in kernel mode
# [  130.152313] #PF: error_code(0x0011) - permissions violation
# [  130.158822] PGD 8bee01067 P4D 8bee01067 PUD 8bee04067 PMD 80000008a16000e3 
# [  130.166836] Oops: 0011 [#10] PREEMPT SMP KASAN PTI
# [  130.172547] CPU: 7 PID: 2514 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  130.180667] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  130.189892] RIP: 0010:0xffff8888a16f5500
# [  130.194638] Code: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 <0f> 1f 44 00 00 c3 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f
# [  130.214789] RSP: 0018:ffffc9000546fd40 EFLAGS: 00010286
# [  130.220988] RAX: 0000000000000033 RBX: ffff8888a16f5500 RCX: 0000000000000000
# [  130.229105] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000a8df9c
# [  130.237183] RBP: 0000000000000001 R08: 0000000000000033 R09: ffffed110277d921
# [  130.245266] R10: ffff888813bec907 R11: ffffed110277d920 R12: 000000000000000d
# [  130.253509] R13: dffffc0000000000 R14: 0000000000000250 R15: ffff88824a13b000
# [  130.261769] FS:  00007f32e4939540(0000) GS:ffff888813bc0000(0000) knlGS:0000000000000000
# [  130.270965] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  130.277648] CR2: ffff8888a16f5500 CR3: 0000000212eb0003 CR4: 00000000003706e0
# [  130.285843] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  130.293999] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  130.302078] Call Trace:
# [  130.305344]  ? execute_location+0x4c/0x5a
# [  130.310218]  ? lkdtm_EXEC_KMALLOC+0x47/0x80
# [  130.315260]  ? direct_entry.cold+0x2f/0x6f
# [  130.320262]  ? full_proxy_write+0xfd/0x180
# [  130.325368]  ? vfs_write+0x184/0x8c0
# [  130.329865]  ? ksys_write+0xf9/0x200
# [  130.334316]  ? __ia32_sys_read+0xc0/0xc0
# [  130.339127]  ? syscall_enter_from_user_mode_prepare+0x1/0x40
# [  130.345789]  ? syscall_enter_from_user_mode+0x21/0x80
# [  130.351812]  ? syscall_enter_from_user_mode+0x21/0x80
# [  130.357795]  ? do_syscall_64+0x5c/0x80
# [  130.362395]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  130.367759]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  130.373526]  ? asm_exc_page_fault+0x8/0x30
# [  130.378519]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  130.384369]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  130.390560] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  130.441410] CR2: ffff8888a16f5500
# [  130.445657] ---[ end trace 9201e83dba6482b0 ]---
# [  130.451164] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  130.455961] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  130.476014] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  130.482204] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  130.490375] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  130.498427] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  130.506496] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  130.514554] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  130.522682] FS:  00007f32e4939540(0000) GS:ffff888813bc0000(0000) knlGS:0000000000000000
# [  130.531820] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  130.538522] CR2: ffff8888a16f5500 CR3: 0000000212eb0003 CR4: 00000000003706e0
# [  130.546618] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  130.554714] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  130.562857] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  130.572763] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2514, name: cat
# [  130.581338] INFO: lockdep is turned off.
# [  130.586132] irq event stamp: 0
# [  130.590006] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  130.597266] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  130.606620] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  130.615903] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  130.623066] CPU: 7 PID: 2514 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  130.631105] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  130.640205] Call Trace:
# [  130.643479]  dump_stack_lvl+0x45/0x59
# [  130.647942]  ___might_sleep.cold+0x1f2/0x23d
# [  130.653112]  exit_signals+0x74/0x800
# [  130.657564]  ? do_signal_stop+0x700/0x700
# [  130.662491]  ? vfs_write+0x184/0x8c0
# [  130.666927]  do_exit+0x1f1/0x2500
# [  130.671054]  ? syscall_enter_from_user_mode+0x21/0x80
# [  130.676971]  ? syscall_enter_from_user_mode+0x21/0x80
# [  130.682859]  ? exit_mm+0x5c0/0x5c0
# [  130.687183]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  130.692536]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  130.698229]  ? asm_exc_page_fault+0x8/0x30
# [  130.703151]  rewind_stack_do_exit+0x17/0x17
# [  130.708165] RIP: 0033:0x7f32e4861504
# [  130.712554] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  130.732696] RSP: 002b:00007fff4e28f6a8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  130.741249] RAX: ffffffffffffffda RBX: 000000000000000d RCX: 00007f32e4861504
# [  130.749434] RDX: 000000000000000d RSI: 00007f32e45b0000 RDI: 0000000000000001
# [  130.757469] RBP: 00007f32e45b0000 R08: 00000000ffffffff R09: 0000000000000000
# [  130.765535] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f32e45b0000
# [  130.773599] R13: 0000000000000001 R14: 000000000000000d R15: 0000000000020000
# EXEC_KMALLOC: saw 'call trace:': ok
ok 36 selftests: lkdtm: EXEC_KMALLOC.sh
# selftests: lkdtm: EXEC_VMALLOC.sh
# Killed
# [  131.043447] lkdtm: Performing direct entry EXEC_VMALLOC
# [  131.049712] lkdtm: attempting ok execution at ffffffff82a93b40
# [  131.056561] lkdtm: attempting bad execution at ffffc90000306000
# [  131.063439] kernel tried to execute NX-protected page - exploit attempt? (uid: 0)
# [  131.071898] BUG: unable to handle page fault for address: ffffc90000306000
# [  131.079815] #PF: supervisor instruction fetch in kernel mode
# [  131.086432] #PF: error_code(0x0011) - permissions violation
# [  131.092949] PGD 100000067 P4D 100000067 PUD 100244067 PMD 100eb1067 PTE 80000008a6a34063
# [  131.102115] Oops: 0011 [#11] PREEMPT SMP KASAN PTI
# [  131.107840] CPU: 0 PID: 2549 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  131.115930] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  131.125101] RIP: 0010:0xffffc90000306000
# [  131.130006] Code: Unable to access opcode bytes at RIP 0xffffc90000305fd6.
# [  131.137895] RSP: 0018:ffffc900055bfcc8 EFLAGS: 00010286
# [  131.144008] RAX: 0000000000000033 RBX: ffffc90000306000 RCX: 0000000000000000
# [  131.152085] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000ab7f8d
# [  131.160238] RBP: 0000000000000001 R08: 0000000000000033 R09: ffffed1102745921
# [  131.168343] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 000000000000000d
# [  131.176544] R13: dffffc0000000000 R14: 0000000000000260 R15: ffff8888a6a34000
# [  131.184671] FS:  00007fcc23a27540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  131.193871] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  131.200510] CR2: ffffc90000305fd6 CR3: 000000089e326005 CR4: 00000000003706f0
# [  131.208650] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  131.216754] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  131.224849] Call Trace:
# [  131.228124]  ? execute_location+0x4c/0x5a
# [  131.232996]  ? lkdtm_EXEC_VMALLOC+0x20/0x40
# [  131.238057]  ? direct_entry.cold+0x2f/0x6f
# [  131.243028]  ? full_proxy_write+0xfd/0x180
# [  131.248020]  ? vfs_write+0x184/0x8c0
# [  131.252582]  ? ksys_write+0xf9/0x200
# [  131.257066]  ? __ia32_sys_read+0xc0/0xc0
# [  131.261945]  ? syscall_enter_from_user_mode+0x21/0x80
# [  131.267952]  ? syscall_enter_from_user_mode+0x21/0x80
# [  131.273952]  ? do_syscall_64+0x5c/0x80
# [  131.278574]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  131.283960]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  131.289684]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  131.295482]  ? do_syscall_64+0x69/0x80
# [  131.300147]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  131.305856]  ? asm_exc_page_fault+0x8/0x30
# [  131.310809]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  131.316676]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  131.322886] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  131.373817] CR2: ffffc90000306000
# [  131.377992] ---[ end trace 9201e83dba6482b1 ]---
# [  131.383521] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  131.388288] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  131.408397] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  131.414521] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  131.422742] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  131.430853] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  131.438946] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  131.447041] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  131.455235] FS:  00007fcc23a27540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  131.464343] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  131.471007] CR2: ffffc90000305fd6 CR3: 000000089e326005 CR4: 00000000003706f0
# [  131.479136] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  131.487256] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# EXEC_VMALLOC: saw 'call trace:': ok
ok 37 selftests: lkdtm: EXEC_VMALLOC.sh
# selftests: lkdtm: EXEC_RODATA.sh
# Killed
# [  131.754163] lkdtm: Performing direct entry EXEC_RODATA
# [  131.760251] lkdtm: attempting ok execution at ffffffff82a93b40
# [  131.767090] lkdtm: attempting bad execution at ffffffff845b4500
# [  131.774062] kernel tried to execute NX-protected page - exploit attempt? (uid: 0)
# [  131.782575] BUG: unable to handle page fault for address: ffffffff845b4500
# [  131.790491] #PF: supervisor instruction fetch in kernel mode
# [  131.797109] #PF: error_code(0x0011) - permissions violation
# [  131.803662] PGD 8bc22d067 P4D 8bc22d067 PUD 8bc22e063 PMD 80000008bb4000e1 
# [  131.811742] Oops: 0011 [#12] PREEMPT SMP KASAN PTI
# [  131.817424] CPU: 2 PID: 2581 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  131.825443] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  131.834640] RIP: 0010:lkdtm_rodata_do_nothing+0x0/0xca0
# [  131.840836] Code: 6e 67 3a 20 64 6f 6e 65 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 <00> 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
# [  131.860986] RSP: 0018:ffffc900056dfcd0 EFLAGS: 00010286
# [  131.867186] RAX: 0000000000000033 RBX: ffffffff845b4500 RCX: 0000000000000000
# [  131.875337] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000adbf8e
# [  131.883447] RBP: 0000000000000000 R08: 0000000000000033 R09: ffffed1102755921
# [  131.891640] R10: ffff888813aac907 R11: ffffed1102755920 R12: 000000000000000c
# [  131.899821] R13: dffffc0000000000 R14: 0000000000000270 R15: ffff8888b60e0000
# [  131.907988] FS:  00007f9b669eb540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  131.917163] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  131.923864] CR2: ffffffff845b4500 CR3: 0000000895ffa002 CR4: 00000000003706e0
# [  131.932032] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  131.940224] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  131.948397] Call Trace:
# [  131.951689]  ? execute_location+0x4c/0x5a
# [  131.956623]  ? direct_entry.cold+0x2f/0x6f
# [  131.961608]  ? full_proxy_write+0xfd/0x180
# [  131.966627]  ? vfs_write+0x184/0x8c0
# [  131.971090]  ? ksys_write+0xf9/0x200
# [  131.975592]  ? __ia32_sys_read+0xc0/0xc0
# [  131.980439]  ? syscall_enter_from_user_mode+0x21/0x80
# [  131.986394]  ? syscall_enter_from_user_mode+0x21/0x80
# [  131.992377]  ? do_syscall_64+0x5c/0x80
# [  131.997043]  ? rcu_read_lock_held_common+0xe/0xc0
# [  132.002696]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  132.008398]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  132.013736]  ? handle_mm_fault+0x201/0x800
# [  132.018797]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  132.024503]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  132.030288]  ? do_syscall_64+0x69/0x80
# [  132.034994]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  132.040722]  ? asm_exc_page_fault+0x8/0x30
# [  132.045765]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  132.051567]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  132.057706] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  132.108858] CR2: ffffffff845b4500
# [  132.113043] ---[ end trace 9201e83dba6482b2 ]---
# [  132.118618] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  132.123413] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  132.143537] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  132.149722] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  132.157877] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  132.166047] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  132.174193] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  132.182420] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  132.190590] FS:  00007f9b669eb540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  132.199738] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  132.206411] CR2: ffffffff845b4500 CR3: 0000000895ffa002 CR4: 00000000003706e0
# [  132.214535] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  132.222604] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  132.230700] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  132.240660] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2581, name: cat
# [  132.249188] INFO: lockdep is turned off.
# [  132.254073] irq event stamp: 0
# [  132.258011] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  132.265231] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  132.274534] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  132.283864] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  132.291121] CPU: 2 PID: 2581 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  132.299212] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  132.308283] Call Trace:
# [  132.311589]  dump_stack_lvl+0x45/0x59
# [  132.316183]  ___might_sleep.cold+0x1f2/0x23d
# [  132.321375]  exit_signals+0x74/0x800
# [  132.325811]  ? do_signal_stop+0x700/0x700
# [  132.330747]  ? syscall_enter_from_user_mode+0x21/0x80
# [  132.336750]  ? syscall_enter_from_user_mode+0x21/0x80
# [  132.342761]  do_exit+0x1f1/0x2500
# [  132.347079]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  132.352542]  ? handle_mm_fault+0x201/0x800
# [  132.357686]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  132.363466]  ? exit_mm+0x5c0/0x5c0
# [  132.367776]  ? do_syscall_64+0x69/0x80
# [  132.372419]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  132.378210]  ? asm_exc_page_fault+0x8/0x30
# [  132.383186]  rewind_stack_do_exit+0x17/0x17
# [  132.388322] RIP: 0033:0x7f9b66913504
# [  132.392812] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  132.412931] RSP: 002b:00007ffe2b851278 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  132.421599] RAX: ffffffffffffffda RBX: 000000000000000c RCX: 00007f9b66913504
# [  132.429721] RDX: 000000000000000c RSI: 00007f9b66662000 RDI: 0000000000000001
# [  132.437822] RBP: 00007f9b66662000 R08: 00000000ffffffff R09: 0000000000000000
# [  132.445943] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f9b66662000
# [  132.454109] R13: 0000000000000001 R14: 000000000000000c R15: 0000000000020000
# EXEC_RODATA: saw 'call trace:': ok
ok 38 selftests: lkdtm: EXEC_RODATA.sh
# selftests: lkdtm: EXEC_USERSPACE.sh
# Killed
# [  132.718910] lkdtm: Performing direct entry EXEC_USERSPACE
# [  132.725226] lkdtm: attempting ok execution at ffffffff82a93b40
# [  132.732035] lkdtm: attempting bad execution at 00007f60695fc000
# [  132.738912] unable to execute userspace code (SMEP?) (uid: 0)
# [  132.745670] BUG: unable to handle page fault for address: 00007f60695fc000
# [  132.753559] #PF: supervisor instruction fetch in kernel mode
# [  132.760166] #PF: error_code(0x0011) - permissions violation
# [  132.766650] PGD 80000008a5f0e067 P4D 80000008a5f0e067 PUD 1dad13067 PMD 8a4bbd067 PTE 2b22ca067
# [  132.776440] Oops: 0011 [#13] PREEMPT SMP KASAN PTI
# [  132.782220] CPU: 0 PID: 2619 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  132.790365] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  132.799510] RIP: 0010:0x7f60695fc000
# [  132.803979] Code: Unable to access opcode bytes at RIP 0x7f60695fbfd6.
# [  132.811561] RSP: 0018:ffffc9000586fd08 EFLAGS: 00010282
# [  132.817753] RAX: 0000000000000033 RBX: ffff8888b41eb340 RCX: 0000000000000000
# [  132.825929] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000b0df95
# [  132.834051] RBP: 00007f60695fc000 R08: 0000000000000033 R09: ffffed1102745921
# [  132.842198] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 000000000000000f
# [  132.850386] R13: dffffc0000000000 R14: 0000000000000280 R15: ffff8888a4bbb000
# [  132.858568] FS:  00007f6069987540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  132.867712] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  132.874405] CR2: 00007f60695fc000 CR3: 00000008a197c006 CR4: 00000000003706f0
# [  132.882575] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  132.890799] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  132.899005] Call Trace:
# [  132.902283]  ? lkdtm_EXEC_USERSPACE.cold+0x4f/0xc5
# [  132.908024]  ? direct_entry.cold+0x2f/0x6f
# [  132.913059]  ? full_proxy_write+0xfd/0x180
# [  132.918049]  ? vfs_write+0x184/0x8c0
# [  132.922506]  ? ksys_write+0xf9/0x200
# [  132.926957]  ? __ia32_sys_read+0xc0/0xc0
# [  132.931768]  ? syscall_enter_from_user_mode+0x21/0x80
# [  132.937749]  ? syscall_enter_from_user_mode+0x21/0x80
# [  132.943724]  ? do_syscall_64+0x5c/0x80
# [  132.948393]  ? rcu_read_lock_held_common+0xe/0xc0
# [  132.953971]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  132.959674]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  132.965048]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  132.970810]  ? asm_exc_page_fault+0x8/0x30
# [  132.975830]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  132.981627]  ? entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  132.987800] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  133.038718] CR2: 00007f60695fc000
# [  133.042923] ---[ end trace 9201e83dba6482b3 ]---
# [  133.048431] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  133.053212] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  133.073289] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  133.079492] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  133.087563] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  133.095615] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  133.103777] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  133.111855] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  133.119988] FS:  00007f6069987540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  133.129121] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  133.135790] CR2: 00007f60695fc000 CR3: 00000008a197c006 CR4: 00000000003706f0
# [  133.143928] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  133.151984] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# EXEC_USERSPACE: saw 'call trace:': ok
ok 39 selftests: lkdtm: EXEC_USERSPACE.sh
# selftests: lkdtm: EXEC_NULL.sh
# Killed
# [  133.424921] lkdtm: Performing direct entry EXEC_NULL
# [  133.430791] lkdtm: attempting ok execution at ffffffff82a93b40
# [  133.437545] lkdtm: attempting bad execution at 0000000000000000
# [  133.444514] BUG: kernel NULL pointer dereference, address: 0000000000000000
# [  133.452518] #PF: supervisor instruction fetch in kernel mode
# [  133.459127] #PF: error_code(0x0010) - not-present page
# [  133.465158] PGD 0 P4D 0 
# [  133.468523] Oops: 0010 [#14] PREEMPT SMP KASAN PTI
# [  133.474232] CPU: 0 PID: 2654 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  133.482305] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  133.491427] RIP: 0010:0x0
# [  133.494944] Code: Unable to access opcode bytes at RIP 0xffffffffffffffd6.
# [  133.502854] RSP: 0018:ffffc900059bfd20 EFLAGS: 00010282
# [  133.509064] RAX: 0000000000000033 RBX: 0000000000000000 RCX: 0000000000000000
# [  133.517334] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000b37f98
# [  133.525502] RBP: 0000000000000000 R08: 0000000000000033 R09: ffffed1102745921
# [  133.533602] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 000000000000000a
# [  133.541746] R13: dffffc0000000000 R14: 0000000000000290 R15: ffff888153995000
# [  133.549965] FS:  00007f7f190af540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  133.559137] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  133.565856] CR2: ffffffffffffffd6 CR3: 0000000283fa2006 CR4: 00000000003706f0
# [  133.573981] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  133.582204] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  133.590342] Call Trace:
# [  133.593653]  execute_location+0x4c/0x5a
# [  133.598397]  direct_entry.cold+0x2f/0x6f
# [  133.603235]  full_proxy_write+0xfd/0x180
# [  133.608082]  vfs_write+0x184/0x8c0
# [  133.612359]  ksys_write+0xf9/0x200
# [  133.616640]  ? __ia32_sys_read+0xc0/0xc0
# [  133.618230] # [  114.288270] ---[ end trace 9201e83dba6482a2 ]---
# [  133.621414]  ? syscall_enter_from_user_mode+0x21/0x80
# [  133.621423]  ? syscall_enter_from_user_mode+0x21/0x80
# [  133.621431]  do_syscall_64+0x5c/0x80
# 
# [  133.634434]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  133.634440]  ? rcu_tasks_trace_pregp_step+0x101/0x180
# [  133.634446]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  133.634452]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  133.634461]  ? do_syscall_64+0x69/0x80
# [  133.642565] # [  114.294523] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  133.644854]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  133.644863]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  133.644869] RIP: 0033:0x7f7f18fd7504
# [  133.644874] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  133.644879] RSP: 002b:00007ffdc10b04c8 EFLAGS: 00000246
# 
# [  133.652471]  ORIG_RAX: 0000000000000001
# [  133.652474] RAX: ffffffffffffffda RBX: 000000000000000a RCX: 00007f7f18fd7504
# [  133.652477] RDX: 000000000000000a RSI: 00007f7f18d26000 RDI: 0000000000000001
# [  133.652480] RBP: 00007f7f18d26000 R08: 00000000ffffffff R09: 0000000000000000
# [  133.652483] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f7f18d26000
# [  133.652486] R13: 0000000000000001 R14: 000000000000000a R15: 0000000000020000
# [  133.652499] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  133.822254] CR2: 0000000000000000
# [  133.826453] ---[ end trace 9201e83dba6482b4 ]---
# [  133.831954] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  133.836809] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  133.856948] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  133.863161] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  133.871322] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  133.879490] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  133.887631] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  133.895839] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  133.904013] FS:  00007f7f190af540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  133.913153] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  133.919925] CR2: ffffffffffffffd6 CR3: 0000000283fa2006 CR4: 00000000003706f0
# [  133.928113] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  133.936272] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  133.944425] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  133.954524] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2654, name: cat
# [  133.963159] INFO: lockdep is turned off.
# [  133.967944] irq event stamp: 0
# [  133.971862] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  133.979080] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  133.988468] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  133.997836] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  134.005113] CPU: 0 PID: 2654 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  134.013240] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  134.022395] Call Trace:
# [  134.025675]  dump_stack_lvl+0x45/0x59
# [  134.030254]  ___might_sleep.cold+0x1f2/0x23d
# [  134.035452]  exit_signals+0x74/0x800
# [  134.039938]  ? do_signal_stop+0x700/0x700
# [  134.044853]  ? ksys_write+0xf9/0x200
# [  134.049292]  ? __ia32_sys_read+0xc0/0xc0
# [  134.054159]  do_exit+0x1f1/0x2500
# [  134.058333]  ? do_syscall_64+0x5c/0x80
# [  134.063002]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  134.068393]  ? rcu_tasks_trace_pregp_step+0x101/0x180
# [  134.074414]  ? exit_mm+0x5c0/0x5c0
# [  134.078662]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  134.084397]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  134.090204]  rewind_stack_do_exit+0x17/0x17
# [  134.095312] RIP: 0033:0x7f7f18fd7504
# [  134.099791] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  134.119962] RSP: 002b:00007ffdc10b04c8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  134.128577] RAX: ffffffffffffffda RBX: 000000000000000a RCX: 00007f7f18fd7504
# [  134.136801] RDX: 000000000000000a RSI: 00007f7f18d26000 RDI: 0000000000000001
# [  134.145002] RBP: 00007f7f18d26000 R08: 00000000ffffffff R09: 0000000000000000
# [  134.153127] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f7f18d26000
# [  134.161281] R13: 0000000000000001 R14: 000000000000000a R15: 0000000000020000
# EXEC_NULL: saw 'call trace:': ok
ok 40 selftests: lkdtm: EXEC_NULL.sh
# selftests: lkdtm: ACCESS_USERSPACE.sh
# Segmentation fault
# [  134.450009] lkdtm: Performing direct entry ACCESS_USERSPACE
# [  134.456580] lkdtm: attempting bad read at 00007f76ffe2f000
# [  134.463185] general protection fault, probably for non-canonical address 0xe0000beedffc5e00: 0000 [#15] PREEMPT SMP KASAN PTI
# [  134.475806] KASAN: probably user-memory-access in range [0x00007f76ffe2f000-0x00007f76ffe2f007]
# [  134.485614] CPU: 6 PID: 2689 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  134.493732] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  134.502883] RIP: 0010:lkdtm_ACCESS_USERSPACE.cold+0x1f/0xf5
# [  134.509429] Code: 00 00 31 f6 31 ff e9 2b fd ff ff 48 89 ee 48 c7 c7 00 32 5b 84 e8 c9 7b f8 ff 48 89 ea b8 ff ff 37 00 48 c1 ea 03 48 c1 e0 2a <80> 3c 02 00 74 08 48 89 ef e8 ee c3 fb fd 48 c7 c7 60 32 5b 84 b8
# [  134.529714] RSP: 0018:ffffc90005b0fd08 EFLAGS: 00010286
# [  134.535904] RAX: dffffc0000000000 RBX: 1ffff92000b61fa1 RCX: 0000000000000000
# [  134.544074] RDX: 00000feedffc5e00 RSI: ffffffff8158eeb6 RDI: fffff52000b61f94
# [  134.552210] RBP: 00007f76ffe2f000 R08: 000000000000002e R09: ffffed1102775921
# [  134.560410] R10: ffff888813bac907 R11: ffffed1102775920 R12: ffff8888b2ec8000
# [  134.568585] R13: dffffc0000000000 R14: 00000000000002a0 R15: ffff8888b70d1000
# [  134.576782] FS:  00007f77001ba540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# [  134.585971] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  134.592748] CR2: 00007f76ffe2f000 CR3: 00000008b6b2a002 CR4: 00000000003706e0
# [  134.600909] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  134.609117] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  134.617288] Call Trace:
# [  134.620590]  ? lkdtm_EXEC_USERSPACE+0xc0/0xc0
# [  134.625880]  ? trace_hardirqs_on+0x41/0x140
# [  134.630997]  direct_entry.cold+0x2f/0x6f
# [  134.635854]  full_proxy_write+0xfd/0x180
# [  134.640683]  vfs_write+0x184/0x8c0
# [  134.644975]  ksys_write+0xf9/0x200
# [  134.649268]  ? __ia32_sys_read+0xc0/0xc0
# [  134.654133]  ? syscall_enter_from_user_mode+0x21/0x80
# [  134.660184]  ? syscall_enter_from_user_mode+0x21/0x80
# [  134.666147]  do_syscall_64+0x5c/0x80
# [  134.671106]  ? irq_exit_rcu+0x2d/0x200
# [  134.675782]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  134.681493]  ? asm_sysvec_apic_timer_interrupt+0xa/0x20
# [  134.687676]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  134.693550]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  134.699555] RIP: 0033:0x7f77000e2504
# [  134.704014] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  134.724298] RSP: 002b:00007ffe24adc5e8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  134.732955] RAX: ffffffffffffffda RBX: 0000000000000011 RCX: 00007f77000e2504
# [  134.741188] RDX: 0000000000000011 RSI: 00007f76ffe31000 RDI: 0000000000000001
# [  134.749384] RBP: 00007f76ffe31000 R08: 00000000ffffffff R09: 0000000000000000
# [  134.757592] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f76ffe31000
# [  134.765830] R13: 0000000000000001 R14: 0000000000000011 R15: 0000000000020000
# [  134.774000] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  134.825177] ---[ end trace 9201e83dba6482b5 ]---
# [  134.830821] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  134.835756] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  134.856001] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  134.862252] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  134.870392] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  134.878590] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  134.886727] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  134.894970] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  134.903094] FS:  00007f77001ba540(0000) GS:ffff888813b00000(0000) knlGS:0000000000000000
# [  134.912178] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  134.918860] CR2: 000055c46e4bdda4 CR3: 00000008b6b2a005 CR4: 00000000003706e0
# [  134.926995] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  134.935212] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# ACCESS_USERSPACE: saw 'call trace:': ok
ok 41 selftests: lkdtm: ACCESS_USERSPACE.sh
# selftests: lkdtm: ACCESS_NULL.sh
# Segmentation fault
# [  135.197252] lkdtm: Performing direct entry ACCESS_NULL
# [  135.203409] lkdtm: attempting bad read at 0000000000000000
# [  135.209883] general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#16] PREEMPT SMP KASAN PTI
# [  135.222431] KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
# [  135.231103] CPU: 3 PID: 2721 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  135.239188] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  135.248289] RIP: 0010:lkdtm_ACCESS_NULL+0x1d/0x7d
# [  135.253992] Code: 48 89 ef e8 6b c4 fb fd e9 7c ff ff ff 0f 1f 44 00 00 53 31 f6 48 c7 c7 00 32 5b 84 e8 cf 7a f8 ff b8 ff ff 37 00 48 c1 e0 2a <80> 38 00 74 07 31 ff e8 fd c2 fb fd 48 8b 1c 25 00 00 00 00 b8 de
# [  135.274579] RSP: 0018:ffffc90005c6fce8 EFLAGS: 00010286
# [  135.280908] RAX: dffffc0000000000 RBX: 000000000000002b RCX: 0000000000000000
# [  135.289116] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000b8df90
# [  135.297301] RBP: ffffffff845afc20 R08: 000000000000002e R09: ffffed110275d921
# [  135.305550] R10: ffff888813aec907 R11: ffffed110275d920 R12: 000000000000000c
# [  135.313727] R13: dffffc0000000000 R14: 00000000000002b0 R15: ffff8888b5db9000
# [  135.322028] FS:  00007f49b1924540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  135.331232] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  135.337962] CR2: 00007f49b159b000 CR3: 00000008b3394006 CR4: 00000000003706e0
# [  135.346193] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  135.354482] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  135.362666] Call Trace:
# [  135.366013]  direct_entry.cold+0x2f/0x6f
# [  135.370869]  full_proxy_write+0xfd/0x180
# [  135.375725]  vfs_write+0x184/0x8c0
# [  135.380045]  ksys_write+0xf9/0x200
# [  135.384341]  ? __ia32_sys_read+0xc0/0xc0
# [  135.389223]  ? rcu_read_lock_bh_held+0x81/0xc0
# [  135.394643]  ? syscall_enter_from_user_mode+0x21/0x80
# [  135.400714]  ? syscall_enter_from_user_mode+0x21/0x80
# [  135.406750]  do_syscall_64+0x5c/0x80
# [  135.411232]  ? do_syscall_64+0x69/0x80
# [  135.415938]  ? handle_mm_fault+0x219/0x800
# [  135.420984]  ? rcu_read_lock_held_common+0xe/0xc0
# [  135.426702]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  135.432461]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  135.437909]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  135.443666]  ? asm_exc_page_fault+0x8/0x30
# [  135.448719]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  135.454567]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  135.460596] RIP: 0033:0x7f49b184c504
# [  135.465037] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  135.485366] RSP: 002b:00007ffd6f71b928 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  135.494016] RAX: ffffffffffffffda RBX: 000000000000000c RCX: 00007f49b184c504
# [  135.502168] RDX: 000000000000000c RSI: 00007f49b159b000 RDI: 0000000000000001
# [  135.510415] RBP: 00007f49b159b000 R08: 00000000ffffffff R09: 0000000000000000
# [  135.518643] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f49b159b000
# [  135.526880] R13: 0000000000000001 R14: 000000000000000c R15: 0000000000020000
# [  135.535043] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  135.586295] ---[ end trace 9201e83dba6482b6 ]---
# [  135.591997] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  135.596828] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  135.616977] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  135.623553] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  135.631766] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  135.639890] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  135.648122] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  135.656341] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  135.664459] FS:  00007f49b1924540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  135.673674] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  135.680436] CR2: 00007f49b159b000 CR3: 00000008b3394006 CR4: 00000000003706e0
# [  135.688628] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  135.696732] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# ACCESS_NULL: saw 'call trace:': ok
ok 42 selftests: lkdtm: ACCESS_NULL.sh
# selftests: lkdtm: WRITE_RO.sh
# Killed
# [  135.967401] lkdtm: Performing direct entry WRITE_RO
# [  135.973235] lkdtm: attempting bad rodata write at ffffffff845b3320
# [  135.980450] BUG: unable to handle page fault for address: ffffffff845b3320
# [  135.988298] #PF: supervisor write access in kernel mode
# [  135.994409] #PF: error_code(0x0003) - permissions violation
# [  136.000873] PGD 8bc22d067 P4D 8bc22d067 PUD 8bc22e063 PMD 80000008bb4000e1 
# [  136.008807] Oops: 0003 [#17] PREEMPT SMP KASAN PTI
# [  136.014456] CPU: 4 PID: 2756 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  136.022530] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  136.031684] RIP: 0010:lkdtm_WRITE_RO+0x2e/0x3a
# [  136.037066] Code: 00 48 c7 c7 80 2f 5b 84 48 c7 c6 20 33 5b 84 e8 3b 7e f8 ff 48 8b 05 57 24 a0 00 ba 34 12 cd ab 48 c7 c7 e0 2f 5b 84 48 31 d0 <48> 89 05 41 24 a0 00 e9 19 7e f8 ff 0f 1f 44 00 00 48 8b 05 d8 89
# [  136.057393] RSP: 0018:ffffc90005e0fdb8 EFLAGS: 00010202
# [  136.063610] RAX: 000000000198b861 RBX: 000000000000002c RCX: 0000000000000000
# [  136.071746] RDX: 00000000abcd1234 RSI: ffffffff8158eeb6 RDI: ffffffff845b2fe0
# [  136.079954] RBP: ffffffff845afc60 R08: 0000000000000036 R09: ffffed1102765921
# [  136.088108] R10: ffff888813b2c907 R11: ffffed1102765920 R12: 0000000000000009
# [  136.096261] R13: dffffc0000000000 R14: 00000000000002c0 R15: ffff88816d528000
# [  136.104357] FS:  00007f2188109540(0000) GS:ffff888813b00000(0000) knlGS:0000000000000000
# [  136.113493] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  136.120283] CR2: ffffffff845b3320 CR3: 00000008b64ec006 CR4: 00000000003706e0
# [  136.128494] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  136.136701] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  136.144899] Call Trace:
# [  136.148185]  direct_entry.cold+0x2f/0x6f
# [  136.153035]  full_proxy_write+0xfd/0x180
# [  136.157834]  vfs_write+0x184/0x8c0
# [  136.162109]  ksys_write+0xf9/0x200
# [  136.166401]  ? __ia32_sys_read+0xc0/0xc0
# [  136.171241]  ? syscall_enter_from_user_mode+0x21/0x80
# [  136.177316]  ? syscall_enter_from_user_mode+0x21/0x80
# [  136.183353]  do_syscall_64+0x5c/0x80
# [  136.187809]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  136.193600]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  136.199535] RIP: 0033:0x7f2188031504
# [  136.204036] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  136.224296] RSP: 002b:00007fffd4fcc828 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  136.232932] RAX: ffffffffffffffda RBX: 0000000000000009 RCX: 00007f2188031504
# [  136.241101] RDX: 0000000000000009 RSI: 00007f2187d80000 RDI: 0000000000000001
# [  136.249262] RBP: 00007f2187d80000 R08: 00000000ffffffff R09: 0000000000000000
# [  136.257405] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f2187d80000
# [  136.265563] R13: 0000000000000001 R14: 0000000000000009 R15: 0000000000020000
# [  136.273732] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  136.324523] CR2: ffffffff845b3320
# [  136.328677] ---[ end trace 9201e83dba6482b7 ]---
# [  136.334197] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  136.339018] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  136.359147] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  136.365302] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  136.373367] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  136.381488] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  136.389640] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  136.397729] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  136.405867] FS:  00007f2188109540(0000) GS:ffff888813b00000(0000) knlGS:0000000000000000
# [  136.414943] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  136.421621] CR2: ffffffff845b3320 CR3: 00000008b64ec006 CR4: 00000000003706e0
# [  136.429806] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  136.437950] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  136.446031] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  136.455971] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2756, name: cat
# [  136.464547] INFO: lockdep is turned off.
# [  136.469321] irq event stamp: 0
# [  136.473248] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  136.480436] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  136.489734] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  136.499060] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  136.506317] CPU: 4 PID: 2756 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  136.514336] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  136.523464] Call Trace:
# [  136.526660]  dump_stack_lvl+0x45/0x59
# [  136.531117]  ___might_sleep.cold+0x1f2/0x23d
# [  136.536286]  exit_signals+0x74/0x800
# [  136.540701]  ? do_signal_stop+0x700/0x700
# [  136.545608]  ? full_proxy_write+0xfd/0x180
# [  136.550569]  do_exit+0x1f1/0x2500
# [  136.554786]  ? ksys_write+0xf9/0x200
# [  136.559220]  ? __ia32_sys_read+0xc0/0xc0
# [  136.564015]  ? syscall_enter_from_user_mode+0x21/0x80
# [  136.569902]  ? exit_mm+0x5c0/0x5c0
# [  136.574107]  ? syscall_enter_from_user_mode+0x21/0x80
# [  136.579983]  rewind_stack_do_exit+0x17/0x17
# [  136.585059] RIP: 0033:0x7f2188031504
# [  136.589435] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  136.609727] RSP: 002b:00007fffd4fcc828 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  136.618370] RAX: ffffffffffffffda RBX: 0000000000000009 RCX: 00007f2188031504
# [  136.626429] RDX: 0000000000000009 RSI: 00007f2187d80000 RDI: 0000000000000001
# [  136.634575] RBP: 00007f2187d80000 R08: 00000000ffffffff R09: 0000000000000000
# [  136.642688] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f2187d80000
# [  136.650781] R13: 0000000000000001 R14: 0000000000000009 R15: 0000000000020000
# WRITE_RO: saw 'call trace:': ok
ok 43 selftests: lkdtm: WRITE_RO.sh
# selftests: lkdtm: WRITE_RO_AFTER_INIT.sh
# Killed
# [  136.927966] lkdtm: Performing direct entry WRITE_RO_AFTER_INIT
# [  136.934819] lkdtm: attempting bad ro_after_init write at ffffffff84b698c8
# [  136.942607] BUG: unable to handle page fault for address: ffffffff84b698c8
# [  136.950475] #PF: supervisor write access in kernel mode
# [  136.956570] #PF: error_code(0x0003) - permissions violation
# [  136.963094] PGD 8bc22d067 P4D 8bc22d067 PUD 8bc22e063 PMD 80000008bba000e1 
# [  136.971124] Oops: 0003 [#18] PREEMPT SMP KASAN PTI
# [  136.976860] CPU: 7 PID: 2791 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  136.984993] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  136.994144] RIP: 0010:lkdtm_WRITE_RO_AFTER_INIT+0x4e/0x5a
# [  137.000500] Code: 30 5b 84 e9 ed 7d f8 ff 48 c7 c7 a0 30 5b 84 e8 e1 7d f8 ff 48 8b 05 a5 89 fb 00 ba 34 12 cd ab 48 c7 c7 e0 2f 5b 84 48 31 d0 <48> 89 05 8f 89 fb 00 e9 bf 7d f8 ff 0f 1f 44 00 00 41 54 49 c7 c4
# [  137.020725] RSP: 0018:ffffc90005f4fd50 EFLAGS: 00010202
# [  137.026882] RAX: 00000000fe67479e RBX: 000000000000002d RCX: 0000000000000000
# [  137.035112] RDX: 00000000abcd1234 RSI: ffffffff8158eeb6 RDI: ffffffff845b2fe0
# [  137.043229] RBP: ffffffff845afca0 R08: 000000000000003d R09: ffffed110277d921
# [  137.051403] R10: ffff888813bec907 R11: ffffed110277d920 R12: 0000000000000014
# [  137.059462] R13: dffffc0000000000 R14: 00000000000002d0 R15: ffff88824a2db000
# [  137.067593] FS:  00007f6bd15dc540(0000) GS:ffff888813bc0000(0000) knlGS:0000000000000000
# [  137.076684] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  137.083325] CR2: ffffffff84b698c8 CR3: 000000024d13e005 CR4: 00000000003706e0
# [  137.091381] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  137.099579] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  137.107740] Call Trace:
# [  137.110992]  direct_entry.cold+0x2f/0x6f
# [  137.115802]  full_proxy_write+0xfd/0x180
# [  137.120679]  vfs_write+0x184/0x8c0
# [  137.124959]  ksys_write+0xf9/0x200
# [  137.129254]  ? __ia32_sys_read+0xc0/0xc0
# [  137.134056]  ? syscall_enter_from_user_mode+0x21/0x80
# [  137.140059]  ? syscall_enter_from_user_mode+0x21/0x80
# [  137.146039]  do_syscall_64+0x5c/0x80
# [  137.150514]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  137.156336]  ? do_syscall_64+0x69/0x80
# [  137.160949]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  137.166687]  ? asm_exc_page_fault+0x8/0x30
# [  137.171671]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  137.177452]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  137.183432] RIP: 0033:0x7f6bd1504504
# [  137.187892] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  137.208180] RSP: 002b:00007ffe9b8909e8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  137.216848] RAX: ffffffffffffffda RBX: 0000000000000014 RCX: 00007f6bd1504504
# [  137.224993] RDX: 0000000000000014 RSI: 00007f6bd1253000 RDI: 0000000000000001
# [  137.233166] RBP: 00007f6bd1253000 R08: 00000000ffffffff R09: 0000000000000000
# [  137.241390] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f6bd1253000
# [  137.249528] R13: 0000000000000001 R14: 0000000000000014 R15: 0000000000020000
# [  137.257661] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  137.308775] CR2: ffffffff84b698c8
# [  137.312975] ---[ end trace 9201e83dba6482b8 ]---
# [  137.318469] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  137.323296] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  137.343519] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  137.349701] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  137.357915] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  137.366103] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  137.374267] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  137.382423] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  137.390638] FS:  00007f6bd15dc540(0000) GS:ffff888813bc0000(0000) knlGS:0000000000000000
# [  137.399803] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  137.406528] CR2: ffffffff84b698c8 CR3: 000000024d13e005 CR4: 00000000003706e0
# [  137.414784] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  137.422871] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# WRITE_RO_AFTER_INIT: saw 'call trace:': ok
ok 44 selftests: lkdtm: WRITE_RO_AFTER_INIT.sh
# selftests: lkdtm: WRITE_KERN.sh
# Killed
# [  137.692976] lkdtm: Performing direct entry WRITE_KERN
# [  137.699004] lkdtm: attempting bad 17945343 byte write at ffffffff83bb0e3f
# [  137.707751] BUG: unable to handle page fault for address: ffffffff83bb0e3f
# [  137.715660] #PF: supervisor write access in kernel mode
# [  137.721874] #PF: error_code(0x0003) - permissions violation
# [  137.728440] PGD 8bc22d067 P4D 8bc22d067 PUD 8bc22e063 PMD 8baa000e1 
# [  137.735845] Oops: 0003 [#19] PREEMPT SMP KASAN PTI
# [  137.741530] CPU: 2 PID: 2826 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  137.749594] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  137.758781] RIP: 0010:memcpy_erms+0x6/0x10
# [  137.763730] Code: fe ff ff cc eb 1e 0f 1f 00 48 89 f8 48 89 d1 48 c1 e9 03 83 e2 07 f3 48 a5 89 d1 f3 a4 c3 66 0f 1f 44 00 00 48 89 f8 48 89 d1 <f3> a4 c3 0f 1f 80 00 00 00 00 48 89 f8 48 83 fa 20 72 7e 40 38 fe
# [  137.783981] RSP: 0018:ffffc9000609fd00 EFLAGS: 00010202
# [  137.790199] RAX: ffffffff83bb0e3f RBX: 000000000000002e RCX: 000000000111d2ff
# [  137.798373] RDX: 000000000111d2ff RSI: ffffffff82a93b40 RDI: ffffffff83bb0e3f
# [  137.806492] RBP: ffffffff845afce0 R08: 0000000000000001 R09: 0000000000223a60
# [  137.814638] R10: ffffffff84cce13d R11: fffffbfff0999c27 R12: 000000000111d2ff
# [  137.822807] R13: dffffc0000000000 R14: 00000000000002e0 R15: ffff888112078000
# [  137.831016] FS:  00007f2f8e74d540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  137.840151] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  137.846851] CR2: ffffffff83bb0e3f CR3: 00000008b78dc001 CR4: 00000000003706e0
# [  137.855015] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  137.863174] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  137.871297] Call Trace:
# [  137.874595]  lkdtm_WRITE_KERN+0x41/0x54
# [  137.879366]  direct_entry.cold+0x2f/0x6f
# [  137.884229]  full_proxy_write+0xfd/0x180
# [  137.889107]  vfs_write+0x184/0x8c0
# [  137.893418]  ksys_write+0xf9/0x200
# [  137.897694]  ? __ia32_sys_read+0xc0/0xc0
# [  137.902463]  ? syscall_enter_from_user_mode+0x21/0x80
# [  137.908455]  ? syscall_enter_from_user_mode+0x21/0x80
# [  137.914435]  do_syscall_64+0x5c/0x80
# [  137.918945]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  137.924824]  ? do_syscall_64+0x69/0x80
# [  137.929480]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  137.935266]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  137.940659]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  137.946342]  ? asm_exc_page_fault+0x8/0x30
# [  137.951359]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  137.957227]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  137.963226] RIP: 0033:0x7f2f8e675504
# [  137.967694] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  137.987919] RSP: 002b:00007ffee6eb4c38 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  137.996498] RAX: ffffffffffffffda RBX: 000000000000000b RCX: 00007f2f8e675504
# [  138.004552] RDX: 000000000000000b RSI: 00007f2f8e3c4000 RDI: 0000000000000001
# [  138.012602] RBP: 00007f2f8e3c4000 R08: 00000000ffffffff R09: 0000000000000000
# [  138.020689] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f2f8e3c4000
# [  138.028759] R13: 0000000000000001 R14: 000000000000000b R15: 0000000000020000
# [  138.036823] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  138.087980] CR2: ffffffff83bb0e3f
# [  138.092141] ---[ end trace 9201e83dba6482b9 ]---
# [  138.097680] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  138.102503] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  138.122681] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  138.128891] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  138.136941] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  138.145142] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  138.153296] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  138.161381] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  138.169529] FS:  00007f2f8e74d540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  138.178674] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  138.185360] CR2: ffffffff83bb0e3f CR3: 00000008b78dc001 CR4: 00000000003706e0
# [  138.193482] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  138.201543] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  138.209699] BUG: sleeping function called from invalid context at include/linux/percpu-rwsem.h:49
# [  138.219528] in_atomic(): 0, irqs_disabled(): 1, non_block: 0, pid: 2826, name: cat
# [  138.228132] INFO: lockdep is turned off.
# [  138.232914] irq event stamp: 0
# [  138.236798] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  138.244011] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  138.253419] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  138.262765] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  138.270105] CPU: 2 PID: 2826 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  138.278224] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  138.287424] Call Trace:
# [  138.290696]  dump_stack_lvl+0x45/0x59
# [  138.295266]  ___might_sleep.cold+0x1f2/0x23d
# [  138.300421]  ? lkdtm_SLAB_FREE_CROSS.cold+0x59/0x59
# [  138.306212]  exit_signals+0x74/0x800
# [  138.310675]  ? do_signal_stop+0x700/0x700
# [  138.315586]  ? __ia32_sys_read+0xc0/0xc0
# [  138.320385]  ? syscall_enter_from_user_mode+0x21/0x80
# [  138.326298]  ? lkdtm_SLAB_FREE_CROSS.cold+0x59/0x59
# [  138.332105]  do_exit+0x1f1/0x2500
# [  138.336319]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  138.342145]  ? do_syscall_64+0x69/0x80
# [  138.346822]  ? exit_mm+0x5c0/0x5c0
# [  138.351115]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  138.356417]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  138.362160]  ? asm_exc_page_fault+0x8/0x30
# [  138.367141]  ? lkdtm_SLAB_FREE_CROSS.cold+0x59/0x59
# [  138.372863]  rewind_stack_do_exit+0x17/0x17
# [  138.377882] RIP: 0033:0x7f2f8e675504
# [  138.382317] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  138.402624] RSP: 002b:00007ffee6eb4c38 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  138.411185] RAX: ffffffffffffffda RBX: 000000000000000b RCX: 00007f2f8e675504
# [  138.419281] RDX: 000000000000000b RSI: 00007f2f8e3c4000 RDI: 0000000000000001
# [  138.427412] RBP: 00007f2f8e3c4000 R08: 00000000ffffffff R09: 0000000000000000
# [  138.435460] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f2f8e3c4000
# [  138.443615] R13: 0000000000000001 R14: 000000000000000b R15: 0000000000020000
# WRITE_KERN: saw 'call trace:': ok
ok 45 selftests: lkdtm: WRITE_KERN.sh
# selftests: lkdtm: REFCOUNT_INC_OVERFLOW.sh
# [  138.736707] lkdtm: Performing direct entry REFCOUNT_INC_OVERFLOW
# [  138.743816] lkdtm: attempting good refcount_inc() without overflow
# [  138.750975] lkdtm: attempting bad refcount_inc() overflow
# [  138.757337] ------------[ cut here ]------------
# [  138.762933] refcount_t: saturated; leaking memory.
# [  138.768722] WARNING: CPU: 3 PID: 2861 at lib/refcount.c:22 refcount_warn_saturate+0x8a/0x140
# [  138.778298] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  138.828908] CPU: 3 PID: 2861 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  138.837103] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  138.846232] RIP: 0010:refcount_warn_saturate+0x8a/0x140
# [  138.852501] Code: 00 00 00 5b 5d c3 85 ed 0f 84 83 00 00 00 80 3d 0c ce dc 03 00 75 ec 48 c7 c7 40 d6 48 84 c6 05 fc cd dc 03 01 e8 81 35 70 01 <0f> 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05
# [  138.872654] RSP: 0018:ffffc900061efd48 EFLAGS: 00010286
# [  138.878859] RAX: 0000000000000000 RBX: ffffc900061efd80 RCX: 0000000000000000
# [  138.887003] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000c3df9b
# [  138.895154] RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed110275d921
# [  138.903233] R10: ffff888813aec907 R11: ffffed110275d920 R12: 0000000000000016
# [  138.911310] R13: dffffc0000000000 R14: 00000000000002f0 R15: ffff8888b16d8000
# [  138.919448] FS:  00007f1c2500c540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  138.928581] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  138.935257] CR2: 00007f1c24c83000 CR3: 0000000155396006 CR4: 00000000003706e0
# [  138.943438] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  138.951607] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  138.959795] Call Trace:
# [  138.963132]  lkdtm_REFCOUNT_INC_OVERFLOW+0xab/0xd7
# [  138.969283]  ? __refcount_add_not_zero.constprop.0+0x128/0x128
# [  138.976034]  direct_entry.cold+0x2f/0x6f
# [  138.980823]  full_proxy_write+0xfd/0x180
# [  138.985674]  vfs_write+0x184/0x8c0
# [  138.990013]  ksys_write+0xf9/0x200
# [  138.994289]  ? __ia32_sys_read+0xc0/0xc0
# [  138.999075]  ? rcu_tasks_trace_pregp_step+0x101/0x180
# [  139.005121]  ? syscall_enter_from_user_mode+0x21/0x80
# [  139.011230]  ? syscall_enter_from_user_mode+0x21/0x80
# [  139.017190]  do_syscall_64+0x5c/0x80
# [  139.021648]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  139.027487]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  139.033507] RIP: 0033:0x7f1c24f34504
# [  139.038006] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  139.058257] RSP: 002b:00007fff097009d8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  139.066760] RAX: ffffffffffffffda RBX: 0000000000000016 RCX: 00007f1c24f34504
# [  139.074979] RDX: 0000000000000016 RSI: 00007f1c24c83000 RDI: 0000000000000001
# [  139.083155] RBP: 00007f1c24c83000 R08: 00000000ffffffff R09: 0000000000000000
# [  139.091289] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f1c24c83000
# [  139.099410] R13: 0000000000000001 R14: 0000000000000016 R15: 0000000000020000
# [  139.107541] irq event stamp: 0
# [  139.111475] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  139.118722] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  139.128086] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  139.137419] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  139.144656] ---[ end trace 9201e83dba6482ba ]---
# [  139.150223] lkdtm: Overflow detected: saturated
# REFCOUNT_INC_OVERFLOW: saw 'call trace:': ok
ok 46 selftests: lkdtm: REFCOUNT_INC_OVERFLOW.sh
# selftests: lkdtm: REFCOUNT_ADD_OVERFLOW.sh
# [  139.407766] lkdtm: Performing direct entry REFCOUNT_ADD_OVERFLOW
# [  139.414768] lkdtm: attempting good refcount_add() without overflow
# [  139.421917] lkdtm: attempting bad refcount_add() overflow
# [  139.428293] ------------[ cut here ]------------
# [  139.433848] refcount_t: saturated; leaking memory.
# [  139.439535] WARNING: CPU: 4 PID: 2896 at lib/refcount.c:22 refcount_warn_saturate+0x8a/0x140
# [  139.449044] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  139.499854] CPU: 4 PID: 2896 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  139.508095] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  139.517163] RIP: 0010:refcount_warn_saturate+0x8a/0x140
# [  139.523357] Code: 00 00 00 5b 5d c3 85 ed 0f 84 83 00 00 00 80 3d 0c ce dc 03 00 75 ec 48 c7 c7 40 d6 48 84 c6 05 fc cd dc 03 01 e8 81 35 70 01 <0f> 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05
# [  139.543412] RSP: 0018:ffffc9000636fd08 EFLAGS: 00010286
# [  139.549569] RAX: 0000000000000000 RBX: ffffc9000636fd40 RCX: 0000000000000000
# [  139.557707] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000c6df93
# [  139.565802] RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed1102765921
# [  139.573900] R10: ffff888813b2c907 R11: ffffed1102765920 R12: 0000000000000016
# [  139.582032] R13: dffffc0000000000 R14: 0000000000000300 R15: ffff8888b1850000
# [  139.590100] FS:  00007f0a2a339540(0000) GS:ffff888813b00000(0000) knlGS:0000000000000000
# [  139.599264] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  139.606016] CR2: 00007f0a29fb0000 CR3: 00000008af014004 CR4: 00000000003706e0
# [  139.614020] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  139.622601] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  139.630691] Call Trace:
# [  139.634010]  lkdtm_REFCOUNT_ADD_OVERFLOW+0xba/0xe6
# [  139.639774]  ? lkdtm_REFCOUNT_INC_OVERFLOW+0xd7/0xd7
# [  139.645730]  direct_entry.cold+0x2f/0x6f
# [  139.650578]  full_proxy_write+0xfd/0x180
# [  139.655396]  vfs_write+0x184/0x8c0
# [  139.659692]  ksys_write+0xf9/0x200
# [  139.663929]  ? __ia32_sys_read+0xc0/0xc0
# [  139.668756]  ? syscall_enter_from_user_mode+0x21/0x80
# [  139.674714]  ? syscall_enter_from_user_mode+0x21/0x80
# [  139.680713]  do_syscall_64+0x5c/0x80
# [  139.685228]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  139.690960]  ? asm_exc_page_fault+0x8/0x30
# [  139.695929]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  139.701711]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  139.707668] RIP: 0033:0x7f0a2a261504
# [  139.712196] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  139.732311] RSP: 002b:00007fff2680b318 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  139.741041] RAX: ffffffffffffffda RBX: 0000000000000016 RCX: 00007f0a2a261504
# [  139.749300] RDX: 0000000000000016 RSI: 00007f0a29fb0000 RDI: 0000000000000001
# [  139.757448] RBP: 00007f0a29fb0000 R08: 00000000ffffffff R09: 0000000000000000
# [  139.765563] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f0a29fb0000
# [  139.773653] R13: 0000000000000001 R14: 0000000000000016 R15: 0000000000020000
# [  139.781873] irq event stamp: 0
# [  139.785845] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  139.793097] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  139.802419] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  139.811717] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  139.818941] ---[ end trace 9201e83dba6482bb ]---
# [  139.824464] lkdtm: Overflow detected: saturated
# REFCOUNT_ADD_OVERFLOW: saw 'call trace:': ok
ok 47 selftests: lkdtm: REFCOUNT_ADD_OVERFLOW.sh
# selftests: lkdtm: REFCOUNT_INC_NOT_ZERO_OVERFLOW.sh
# [  140.083235] lkdtm: Performing direct entry REFCOUNT_INC_NOT_ZERO_OVERFLOW
# [  140.091190] lkdtm: attempting bad refcount_inc_not_zero() overflow
# [  140.098288] ------------[ cut here ]------------
# [  140.103855] refcount_t: saturated; leaking memory.
# [  140.109592] WARNING: CPU: 2 PID: 2928 at lib/refcount.c:19 refcount_warn_saturate+0x111/0x140
# [  140.119153] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  140.169947] CPU: 2 PID: 2928 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  140.178032] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  140.187260] RIP: 0010:refcount_warn_saturate+0x111/0x140
# [  140.193572] Code: 35 70 01 0f 0b e9 72 ff ff ff 80 3d 8a cd dc 03 00 0f 85 65 ff ff ff 48 c7 c7 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 <0f> 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8
# [  140.213801] RSP: 0018:ffffc900064afbb8 EFLAGS: 00010282
# [  140.220649] RAX: 0000000000000000 RBX: ffffc900064afc88 RCX: 0000000000000000
# [  140.228799] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000c95f69
# [  140.236951] RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed1102755921
# [  140.245071] R10: ffff888813aac907 R11: ffffed1102755920 R12: 1ffff92000c95f7b
# [  140.253213] R13: 0000000080000000 R14: ffffc900064afbf8 R15: ffff8888afa69000
# [  140.261395] FS:  00007f258da95540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  140.270658] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  140.277409] CR2: 00007f258d70c000 CR3: 00000008af870003 CR4: 00000000003706e0
# [  140.285561] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  140.293744] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  140.301946] Call Trace:
# [  140.305232]  __refcount_add_not_zero.constprop.0+0xed/0x128
# [  140.311797]  ? __refcount_dec.constprop.0+0x2a/0x2a
# [  140.317623]  ? _printk+0xb2/0xe3
# [  140.321754]  ? record_print_text.cold+0x11/0x11
# [  140.327344]  ? wake_up_klogd.part.0+0x76/0xc0
# [  140.332713]  lkdtm_REFCOUNT_INC_NOT_ZERO_OVERFLOW+0x79/0xbf
# [  140.339270]  ? lkdtm_REFCOUNT_ADD_OVERFLOW+0xe6/0xe6
# [  140.345238]  direct_entry.cold+0x2f/0x6f
# [  140.350068]  full_proxy_write+0xfd/0x180
# [  140.354922]  vfs_write+0x184/0x8c0
# [  140.359266]  ksys_write+0xf9/0x200
# [  140.363633]  ? __ia32_sys_read+0xc0/0xc0
# [  140.368512]  ? rcu_read_lock_bh_held+0x81/0xc0
# [  140.373939]  ? syscall_enter_from_user_mode+0x21/0x80
# [  140.380049]  ? syscall_enter_from_user_mode+0x21/0x80
# [  140.386092]  do_syscall_64+0x5c/0x80
# [  140.390546]  ? do_syscall_64+0x69/0x80
# [  140.395235]  ? handle_mm_fault+0x219/0x800
# [  140.400295]  ? rcu_read_lock_held_common+0xe/0xc0
# [  140.405909]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  140.411675]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  140.417034]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  140.422810]  ? asm_exc_page_fault+0x8/0x30
# [  140.427902]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  140.433824]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  140.439911] RIP: 0033:0x7f258d9bd504
# [  140.444450] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  140.464730] RSP: 002b:00007fff438a6e48 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  140.473430] RAX: ffffffffffffffda RBX: 000000000000001f RCX: 00007f258d9bd504
# [  140.481647] RDX: 000000000000001f RSI: 00007f258d70c000 RDI: 0000000000000001
# [  140.489929] RBP: 00007f258d70c000 R08: 00000000ffffffff R09: 0000000000000000
# [  140.498087] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f258d70c000
# [  140.506303] R13: 0000000000000001 R14: 000000000000001f R15: 0000000000020000
# [  140.514577] irq event stamp: 0
# [  140.518510] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  140.525836] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  140.535193] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  140.544592] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  140.551898] ---[ end trace 9201e83dba6482bc ]---
# [  140.557499] lkdtm: Overflow detected: saturated
# REFCOUNT_INC_NOT_ZERO_OVERFLOW: saw 'call trace:': ok
ok 48 selftests: lkdtm: REFCOUNT_INC_NOT_ZERO_OVERFLOW.sh
# selftests: lkdtm: REFCOUNT_ADD_NOT_ZERO_OVERFLOW.sh
# [  140.837737] lkdtm: Performing direct entry REFCOUNT_ADD_NOT_ZERO_OVERFLOW
# [  140.845699] lkdtm: attempting bad refcount_add_not_zero() overflow
# [  140.853013] ------------[ cut here ]------------
# [  140.859071] refcount_t: saturated; leaking memory.
# [  140.864860] WARNING: CPU: 2 PID: 2963 at lib/refcount.c:19 refcount_warn_saturate+0x111/0x140
# [  140.874465] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  140.925270] CPU: 2 PID: 2963 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  140.933443] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  140.942771] RIP: 0010:refcount_warn_saturate+0x111/0x140
# [  140.949083] Code: 35 70 01 0f 0b e9 72 ff ff ff 80 3d 8a cd dc 03 00 0f 85 65 ff ff ff 48 c7 c7 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 <0f> 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8
# [  140.969437] RSP: 0018:ffffc9000660fc10 EFLAGS: 00010286
# [  140.975550] RAX: 0000000000000000 RBX: ffffc9000660fce0 RCX: 0000000000000000
# [  140.983725] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000cc1f74
# [  140.991903] RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed1102755921
# [  141.000104] R10: ffff888813aac907 R11: ffffed1102755920 R12: 1ffff92000cc1f86
# [  141.008159] R13: 0000000080000005 R14: ffffc9000660fc50 R15: ffff8881a4840000
# [  141.016244] FS:  00007f489231e540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  141.025438] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  141.032180] CR2: 00007f4891f95000 CR3: 00000008b1f74004 CR4: 00000000003706e0
# [  141.040294] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  141.048498] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  141.056592] Call Trace:
# [  141.059921]  __refcount_add_not_zero.constprop.0+0xed/0x128
# [  141.066467]  ? __refcount_dec.constprop.0+0x2a/0x2a
# [  141.072328]  ? _printk+0xb2/0xe3
# [  141.076494]  ? record_print_text.cold+0x11/0x11
# [  141.082005]  ? wake_up_klogd.part.0+0x76/0xc0
# [  141.087377]  lkdtm_REFCOUNT_ADD_NOT_ZERO_OVERFLOW+0x79/0xbf
# [  141.093975]  ? lkdtm_REFCOUNT_INC_NOT_ZERO_OVERFLOW+0xbf/0xbf
# [  141.100728]  direct_entry.cold+0x2f/0x6f
# [  141.105586]  full_proxy_write+0xfd/0x180
# [  141.110466]  vfs_write+0x184/0x8c0
# [  141.114804]  ksys_write+0xf9/0x200
# [  141.119175]  ? __ia32_sys_read+0xc0/0xc0
# [  141.124058]  ? syscall_enter_from_user_mode+0x21/0x80
# [  141.130214]  ? syscall_enter_from_user_mode+0x21/0x80
# [  141.136242]  do_syscall_64+0x5c/0x80
# [  141.140720]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  141.146197]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  141.151957]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  141.157823]  ? do_syscall_64+0x69/0x80
# [  141.162484]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  141.168366]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  141.174460] RIP: 0033:0x7f4892246504
# [  141.178974] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  141.199212] RSP: 002b:00007ffc34b2d138 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  141.207857] RAX: ffffffffffffffda RBX: 000000000000001f RCX: 00007f4892246504
# [  141.216071] RDX: 000000000000001f RSI: 00007f4891f95000 RDI: 0000000000000001
# [  141.224253] RBP: 00007f4891f95000 R08: 00000000ffffffff R09: 0000000000000000
# [  141.232393] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f4891f95000
# [  141.240517] R13: 0000000000000001 R14: 000000000000001f R15: 0000000000020000
# [  141.248665] irq event stamp: 0
# [  141.252627] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  141.259881] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  141.269279] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  141.278584] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  141.285798] ---[ end trace 9201e83dba6482bd ]---
# [  141.291373] lkdtm: Overflow detected: saturated
# REFCOUNT_ADD_NOT_ZERO_OVERFLOW: saw 'call trace:': ok
ok 49 selftests: lkdtm: REFCOUNT_ADD_NOT_ZERO_OVERFLOW.sh
# selftests: lkdtm: REFCOUNT_DEC_ZERO.sh
# [  141.559347] lkdtm: Performing direct entry REFCOUNT_DEC_ZERO
# [  141.566068] lkdtm: attempting good refcount_dec()
# [  141.571855] lkdtm: attempting bad refcount_dec() to zero
# [  141.578151] ------------[ cut here ]------------
# [  141.583751] refcount_t: decrement hit 0; leaking memory.
# [  141.590119] WARNING: CPU: 2 PID: 2998 at lib/refcount.c:31 refcount_warn_saturate+0x12b/0x140
# [  141.599789] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  141.650509] CPU: 2 PID: 2998 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  141.658544] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  141.667741] RIP: 0010:refcount_warn_saturate+0x12b/0x140
# [  141.674024] Code: 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 0f 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8 e0 34 70 01 <0f> 0b e9 31 ff ff ff 48 89 df e8 06 50 74 ff e9 fc fe ff ff 90 41
# [  141.694711] RSP: 0018:ffffc9000676fd40 EFLAGS: 00010282
# [  141.700928] RAX: 0000000000000000 RBX: ffffc9000676fd78 RCX: 0000000000000000
# [  141.709073] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000cedf9a
# [  141.717346] RBP: 0000000000000004 R08: 0000000000000001 R09: ffffed1102755921
# [  141.725561] R10: ffff888813aac907 R11: ffffed1102755920 R12: 0000000000000012
# [  141.733777] R13: dffffc0000000000 R14: 0000000000000330 R15: ffff88824a1c6000
# [  141.741972] FS:  00007faa6152e540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  141.751071] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  141.757783] CR2: 00007faa611a5000 CR3: 0000000895b1e005 CR4: 00000000003706e0
# [  141.766032] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  141.774206] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  141.782456] Call Trace:
# [  141.785720]  lkdtm_REFCOUNT_DEC_ZERO+0x88/0x124
# [  141.791252]  ? lkdtm_REFCOUNT_ADD_NOT_ZERO_OVERFLOW+0xbf/0xbf
# [  141.797967]  direct_entry.cold+0x2f/0x6f
# [  141.802834]  full_proxy_write+0xfd/0x180
# [  141.807720]  vfs_write+0x184/0x8c0
# [  141.812026]  ksys_write+0xf9/0x200
# [  141.816381]  ? __ia32_sys_read+0xc0/0xc0
# [  141.821263]  ? do_syscall_64+0x1/0x80
# [  141.825879]  ? syscall_enter_from_user_mode+0x21/0x80
# [  141.831936]  ? syscall_enter_from_user_mode+0x21/0x80
# [  141.838023]  do_syscall_64+0x5c/0x80
# [  141.842500]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  141.848356]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  141.854354] RIP: 0033:0x7faa61456504
# [  141.858993] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  141.879497] RSP: 002b:00007ffe6a719b08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  141.888113] RAX: ffffffffffffffda RBX: 0000000000000012 RCX: 00007faa61456504
# [  141.896274] RDX: 0000000000000012 RSI: 00007faa611a5000 RDI: 0000000000000001
# [  141.904499] RBP: 00007faa611a5000 R08: 00000000ffffffff R09: 0000000000000000
# [  141.912727] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007faa611a5000
# [  141.920887] R13: 0000000000000001 R14: 0000000000000012 R15: 0000000000020000
# [  141.929077] irq event stamp: 0
# [  141.933043] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  141.940355] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  141.949781] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  141.959109] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  141.966377] ---[ end trace 9201e83dba6482be ]---
# [  141.972002] lkdtm: Zero detected: saturated
# REFCOUNT_DEC_ZERO: saw 'call trace:': ok
ok 50 selftests: lkdtm: REFCOUNT_DEC_ZERO.sh
# selftests: lkdtm: REFCOUNT_DEC_NEGATIVE.sh
# [  142.239615] lkdtm: Performing direct entry REFCOUNT_DEC_NEGATIVE
# [  142.246622] lkdtm: attempting bad refcount_dec() below zero
# [  142.253127] ------------[ cut here ]------------
# [  142.258690] refcount_t: decrement hit 0; leaking memory.
# [  142.265034] WARNING: CPU: 3 PID: 3033 at lib/refcount.c:31 refcount_warn_saturate+0x12b/0x140
# [  142.274826] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  142.325301] CPU: 3 PID: 3033 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  142.333393] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  142.342620] RIP: 0010:refcount_warn_saturate+0x12b/0x140
# [  142.348919] Code: 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 0f 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8 e0 34 70 01 <0f> 0b e9 31 ff ff ff 48 89 df e8 06 50 74 ff e9 fc fe ff ff 90 41
# [  142.368885] RSP: 0018:ffffc9000688fc60 EFLAGS: 00010282
# [  142.375076] RAX: 0000000000000000 RBX: ffffc9000688fc98 RCX: 0000000000000000
# [  142.383174] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000d11f7e
# [  142.391771] RBP: 0000000000000004 R08: 0000000000000001 R09: ffffed110275d921
# [  142.399916] R10: ffff888813aec907 R11: ffffed110275d920 R12: 0000000000000016
# [  142.408039] R13: dffffc0000000000 R14: 0000000000000340 R15: ffff888230907000
# [  142.416155] FS:  00007f205cb3b540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  142.425265] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  142.431954] CR2: 00007f205c7b2000 CR3: 00000008aeeba006 CR4: 00000000003706e0
# [  142.440107] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  142.448170] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  142.456262] Call Trace:
# [  142.459568]  lkdtm_REFCOUNT_DEC_NEGATIVE+0x72/0xa0
# [  142.465340]  ? lkdtm_REFCOUNT_DEC_ZERO+0x124/0x124
# [  142.471115]  direct_entry.cold+0x2f/0x6f
# [  142.476003]  full_proxy_write+0xfd/0x180
# [  142.480850]  vfs_write+0x184/0x8c0
# [  142.485198]  ksys_write+0xf9/0x200
# [  142.489515]  ? __ia32_sys_read+0xc0/0xc0
# [  142.494313]  ? syscall_enter_from_user_mode+0x21/0x80
# [  142.500332]  ? syscall_enter_from_user_mode+0x21/0x80
# [  142.506360]  do_syscall_64+0x5c/0x80
# [  142.510908]  ? do_syscall_64+0x69/0x80
# [  142.515589]  ? handle_mm_fault+0x219/0x800
# [  142.520606]  ? rcu_read_lock_held_common+0xe/0xc0
# [  142.526208]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  142.531933]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  142.537314]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  142.543026]  ? asm_exc_page_fault+0x8/0x30
# [  142.548109]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  142.553949]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  142.559908] RIP: 0033:0x7f205ca63504
# [  142.564390] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  142.584624] RSP: 002b:00007fffa6ecb6e8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  142.593285] RAX: ffffffffffffffda RBX: 0000000000000016 RCX: 00007f205ca63504
# [  142.601443] RDX: 0000000000000016 RSI: 00007f205c7b2000 RDI: 0000000000000001
# [  142.609636] RBP: 00007f205c7b2000 R08: 00000000ffffffff R09: 0000000000000000
# [  142.617726] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f205c7b2000
# [  142.625866] R13: 0000000000000001 R14: 0000000000000016 R15: 0000000000020000
# [  142.634056] irq event stamp: 0
# [  142.638036] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  142.645228] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  142.654611] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  142.663847] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  142.671066] ---[ end trace 9201e83dba6482bf ]---
# [  142.676599] lkdtm: Negative detected: saturated
# REFCOUNT_DEC_NEGATIVE: saw 'Negative detected: saturated': ok
ok 51 selftests: lkdtm: REFCOUNT_DEC_NEGATIVE.sh
# selftests: lkdtm: REFCOUNT_DEC_AND_TEST_NEGATIVE.sh
# [  142.965601] lkdtm: Performing direct entry REFCOUNT_DEC_AND_TEST_NEGATIVE
# [  142.973536] lkdtm: attempting bad refcount_dec_and_test() below zero
# [  142.980971] ------------[ cut here ]------------
# [  142.986516] refcount_t: underflow; use-after-free.
# [  142.992330] WARNING: CPU: 0 PID: 3071 at lib/refcount.c:28 refcount_warn_saturate+0xaa/0x140
# [  143.001827] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  143.052664] CPU: 0 PID: 3071 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  143.060744] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  143.069908] RIP: 0010:refcount_warn_saturate+0xaa/0x140
# [  143.076131] Code: fc cd dc 03 01 e8 81 35 70 01 0f 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05 da cd dc 03 01 e8 61 35 70 01 <0f> 0b eb b5 80 3d c8 cd dc 03 00 75 ac 48 c7 c7 00 d8 48 84 c6 05
# [  143.096289] RSP: 0018:ffffc900069ffd18 EFLAGS: 00010282
# [  143.102739] RAX: 0000000000000000 RBX: ffffc900069ffd68 RCX: 0000000000000000
# [  143.110861] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000d3ff95
# [  143.118966] RBP: 0000000000000003 R08: 0000000000000001 R09: ffffed1102745921
# [  143.127070] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 000000000000001f
# [  143.135226] R13: dffffc0000000000 R14: 0000000000000350 R15: ffff8888b5591000
# [  143.143337] FS:  00007f38672fe540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  143.152454] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  143.159209] CR2: 00007f3866f75000 CR3: 00000008b2f1a005 CR4: 00000000003706f0
# [  143.167390] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  143.175540] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  143.183608] Call Trace:
# [  143.186903]  __refcount_sub_and_test.constprop.0+0x4b/0x80
# [  143.193428]  lkdtm_REFCOUNT_DEC_AND_TEST_NEGATIVE+0x79/0xc1
# [  143.200021]  ? lkdtm_REFCOUNT_DEC_NEGATIVE+0xa0/0xa0
# [  143.205972]  direct_entry.cold+0x2f/0x6f
# [  143.211068]  full_proxy_write+0xfd/0x180
# [  143.215956]  vfs_write+0x184/0x8c0
# [  143.220317]  ksys_write+0xf9/0x200
# [  143.224685]  ? __ia32_sys_read+0xc0/0xc0
# [  143.229541]  ? syscall_enter_from_user_mode+0x21/0x80
# [  143.235518]  ? syscall_enter_from_user_mode+0x21/0x80
# [  143.241493]  do_syscall_64+0x5c/0x80
# [  143.246026]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  143.251884]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  143.257896] RIP: 0033:0x7f3867226504
# [  143.262380] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  143.282549] RSP: 002b:00007fff352a1468 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  143.291123] RAX: ffffffffffffffda RBX: 000000000000001f RCX: 00007f3867226504
# [  143.299294] RDX: 000000000000001f RSI: 00007f3866f75000 RDI: 0000000000000001
# [  143.307520] RBP: 00007f3866f75000 R08: 00000000ffffffff R09: 0000000000000000
# [  143.315704] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f3866f75000
# [  143.323853] R13: 0000000000000001 R14: 000000000000001f R15: 0000000000020000
# [  143.331975] irq event stamp: 0
# [  143.335938] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  143.343199] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  143.352578] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  143.361957] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  143.369239] ---[ end trace 9201e83dba6482c0 ]---
# [  143.374838] lkdtm: Negative detected: saturated
# REFCOUNT_DEC_AND_TEST_NEGATIVE: saw 'Negative detected: saturated': ok
ok 52 selftests: lkdtm: REFCOUNT_DEC_AND_TEST_NEGATIVE.sh
# selftests: lkdtm: REFCOUNT_SUB_AND_TEST_NEGATIVE.sh
# [  143.666199] lkdtm: Performing direct entry REFCOUNT_SUB_AND_TEST_NEGATIVE
# [  143.674115] lkdtm: attempting bad refcount_sub_and_test() below zero
# [  143.681498] ------------[ cut here ]------------
# [  143.687112] refcount_t: underflow; use-after-free.
# [  143.692867] WARNING: CPU: 0 PID: 3112 at lib/refcount.c:28 refcount_warn_saturate+0xaa/0x140
# [  143.702396] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  143.752953] CPU: 0 PID: 3112 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  143.761032] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  143.770233] RIP: 0010:refcount_warn_saturate+0xaa/0x140
# [  143.776422] Code: fc cd dc 03 01 e8 81 35 70 01 0f 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05 da cd dc 03 01 e8 61 35 70 01 <0f> 0b eb b5 80 3d c8 cd dc 03 00 75 ac 48 c7 c7 00 d8 48 84 c6 05
# [  143.796813] RSP: 0018:ffffc90006bafc78 EFLAGS: 00010282
# [  143.803014] RAX: 0000000000000000 RBX: ffffc90006bafcc8 RCX: 0000000000000000
# [  143.811104] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000d75f81
# [  143.819240] RBP: 0000000000000003 R08: 0000000000000001 R09: ffffed1102745921
# [  143.827343] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 000000000000001f
# [  143.835531] R13: dffffc0000000000 R14: 0000000000000360 R15: ffff8882b016e000
# [  143.843672] FS:  00007f0bf3299540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  143.852821] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  143.859529] CR2: 00007f0bf2f10000 CR3: 00000008ac744003 CR4: 00000000003706f0
# [  143.867683] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  143.875794] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  143.884060] Call Trace:
# [  143.887366]  __refcount_sub_and_test.constprop.0+0x4b/0x80
# [  143.894274]  lkdtm_REFCOUNT_SUB_AND_TEST_NEGATIVE+0x79/0xc4
# [  143.900859]  ? lkdtm_REFCOUNT_DEC_AND_TEST_NEGATIVE+0xc1/0xc1
# [  143.907616]  direct_entry.cold+0x2f/0x6f
# [  143.912450]  full_proxy_write+0xfd/0x180
# [  143.917306]  vfs_write+0x184/0x8c0
# [  143.921590]  ksys_write+0xf9/0x200
# [  143.925903]  ? __ia32_sys_read+0xc0/0xc0
# [  143.930768]  ? syscall_enter_from_user_mode+0x21/0x80
# [  143.936754]  ? syscall_enter_from_user_mode+0x21/0x80
# [  143.942713]  do_syscall_64+0x5c/0x80
# [  143.947200]  ? do_syscall_64+0x69/0x80
# [  143.951807]  ? rcu_read_lock_held_common+0xe/0xc0
# [  143.957496]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  143.963239]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  143.968603]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  143.974323]  ? asm_exc_page_fault+0x8/0x30
# [  143.979330]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  143.985106]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  143.991108] RIP: 0033:0x7f0bf31c1504
# [  143.995607] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  144.015914] RSP: 002b:00007ffcc9df3028 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  144.024537] RAX: ffffffffffffffda RBX: 000000000000001f RCX: 00007f0bf31c1504
# [  144.032819] RDX: 000000000000001f RSI: 00007f0bf2f10000 RDI: 0000000000000001
# [  144.041052] RBP: 00007f0bf2f10000 R08: 00000000ffffffff R09: 0000000000000000
# [  144.049288] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f0bf2f10000
# [  144.057528] R13: 0000000000000001 R14: 000000000000001f R15: 0000000000020000
# [  144.065744] irq event stamp: 0
# [  144.069676] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  144.076917] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  144.086343] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  144.095675] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  144.103015] ---[ end trace 9201e83dba6482c1 ]---
# [  144.108645] lkdtm: Negative detected: saturated
# REFCOUNT_SUB_AND_TEST_NEGATIVE: saw 'Negative detected: saturated': ok
ok 53 selftests: lkdtm: REFCOUNT_SUB_AND_TEST_NEGATIVE.sh
# selftests: lkdtm: REFCOUNT_INC_ZERO.sh
# [  144.383234] lkdtm: Performing direct entry REFCOUNT_INC_ZERO
# [  144.389886] lkdtm: attempting safe refcount_inc_not_zero() from zero
# [  144.397189] lkdtm: Good: zero detected
# [  144.401834] lkdtm: Correctly stayed at zero
# [  144.406937] lkdtm: attempting bad refcount_inc() from zero
# [  144.413320] ------------[ cut here ]------------
# [  144.418819] refcount_t: addition on 0; use-after-free.
# [  144.424919] WARNING: CPU: 7 PID: 3146 at lib/refcount.c:25 refcount_warn_saturate+0xea/0x140
# [  144.434452] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  144.485378] CPU: 7 PID: 3146 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  144.493452] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  144.503144] RIP: 0010:refcount_warn_saturate+0xea/0x140
# [  144.509294] Code: b8 cd dc 03 01 e8 41 35 70 01 0f 0b eb 95 80 3d ab cd dc 03 00 75 8c 48 c7 c7 e0 d6 48 84 c6 05 9b cd dc 03 01 e8 21 35 70 01 <0f> 0b e9 72 ff ff ff 80 3d 8a cd dc 03 00 0f 85 65 ff ff ff 48 c7
# [  144.529465] RSP: 0018:ffffc90006cdfc68 EFLAGS: 00010286
# [  144.535588] RAX: 0000000000000000 RBX: ffffc90006cdfca0 RCX: 0000000000000000
# [  144.543821] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000d9bf7f
# [  144.551958] RBP: 0000000000000002 R08: 0000000000000001 R09: ffffed110277d921
# [  144.560208] R10: ffff888813bec907 R11: ffffed110277d920 R12: 0000000000000012
# [  144.568371] R13: dffffc0000000000 R14: 0000000000000370 R15: ffff8888ae9eb000
# [  144.576540] FS:  00007f991d525540(0000) GS:ffff888813bc0000(0000) knlGS:0000000000000000
# [  144.585677] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  144.592341] CR2: 00007f991d19c000 CR3: 00000008a2ef0002 CR4: 00000000003706e0
# [  144.600472] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  144.608668] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  144.616884] Call Trace:
# [  144.620227]  lkdtm_REFCOUNT_INC_ZERO+0xe7/0x11c
# [  144.625649]  ? lkdtm_REFCOUNT_SUB_AND_TEST_NEGATIVE+0xc4/0xc4
# [  144.632394]  direct_entry.cold+0x2f/0x6f
# [  144.637200]  full_proxy_write+0xfd/0x180
# [  144.642119]  vfs_write+0x184/0x8c0
# [  144.646471]  ksys_write+0xf9/0x200
# [  144.650806]  ? __ia32_sys_read+0xc0/0xc0
# [  144.655642]  ? syscall_enter_from_user_mode+0x21/0x80
# [  144.661649]  ? syscall_enter_from_user_mode+0x21/0x80
# [  144.667658]  do_syscall_64+0x5c/0x80
# [  144.672150]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  144.677859]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  144.683701]  ? do_syscall_64+0x69/0x80
# [  144.688291]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  144.693682]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  144.699398]  ? asm_exc_page_fault+0x8/0x30
# [  144.704436]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  144.710197]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  144.716140] RIP: 0033:0x7f991d44d504
# [  144.720584] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  144.740895] RSP: 002b:00007ffd047857e8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  144.749557] RAX: ffffffffffffffda RBX: 0000000000000012 RCX: 00007f991d44d504
# [  144.757650] RDX: 0000000000000012 RSI: 00007f991d19c000 RDI: 0000000000000001
# [  144.765801] RBP: 00007f991d19c000 R08: 00000000ffffffff R09: 0000000000000000
# [  144.773955] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f991d19c000
# [  144.782049] R13: 0000000000000001 R14: 0000000000000012 R15: 0000000000020000
# [  144.790253] irq event stamp: 0
# [  144.794190] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  144.801477] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  144.810815] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  144.820113] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  144.827373] ---[ end trace 9201e83dba6482c2 ]---
# [  144.832918] lkdtm: Zero detected: saturated
# REFCOUNT_INC_ZERO: saw 'call trace:': ok
ok 54 selftests: lkdtm: REFCOUNT_INC_ZERO.sh
# selftests: lkdtm: REFCOUNT_ADD_ZERO.sh
# [  145.115220] lkdtm: Performing direct entry REFCOUNT_ADD_ZERO
# [  145.121893] lkdtm: attempting safe refcount_add_not_zero() from zero
# [  145.129229] lkdtm: Good: zero detected
# [  145.133917] lkdtm: Correctly stayed at zero
# [  145.139021] lkdtm: attempting bad refcount_add() from zero
# [  145.145488] ------------[ cut here ]------------
# [  145.151024] refcount_t: addition on 0; use-after-free.
# [  145.157131] WARNING: CPU: 0 PID: 3179 at lib/refcount.c:25 refcount_warn_saturate+0xea/0x140
# [  145.166603] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  145.217526] CPU: 0 PID: 3179 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  145.225646] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  145.234855] RIP: 0010:refcount_warn_saturate+0xea/0x140
# [  145.241725] Code: b8 cd dc 03 01 e8 41 35 70 01 0f 0b eb 95 80 3d ab cd dc 03 00 75 8c 48 c7 c7 e0 d6 48 84 c6 05 9b cd dc 03 01 e8 21 35 70 01 <0f> 0b e9 72 ff ff ff 80 3d 8a cd dc 03 00 0f 85 65 ff ff ff 48 c7
# [  145.261890] RSP: 0018:ffffc90006e3fd48 EFLAGS: 00010286
# [  145.268093] RAX: 0000000000000000 RBX: ffffc90006e3fd80 RCX: 0000000000000000
# [  145.276258] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000dc7f9b
# [  145.284403] RBP: 0000000000000002 R08: 0000000000000001 R09: ffffed1102745921
# [  145.292541] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000012
# [  145.300771] R13: dffffc0000000000 R14: 0000000000000380 R15: ffff888897af0000
# [  145.308980] FS:  00007f9eba96d540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  145.318277] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  145.324995] CR2: 00007f9eba5e4000 CR3: 00000008b6b46005 CR4: 00000000003706f0
# [  145.333140] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  145.341426] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  145.349639] Call Trace:
# [  145.352939]  lkdtm_REFCOUNT_ADD_ZERO+0xe7/0x11c
# [  145.358398]  ? lkdtm_REFCOUNT_INC_ZERO+0x11c/0x11c
# [  145.364166]  direct_entry.cold+0x2f/0x6f
# [  145.369043]  full_proxy_write+0xfd/0x180
# [  145.373910]  vfs_write+0x184/0x8c0
# [  145.378206]  ksys_write+0xf9/0x200
# [  145.382493]  ? __ia32_sys_read+0xc0/0xc0
# [  145.387337]  ? syscall_enter_from_user_mode+0x21/0x80
# [  145.393371]  ? syscall_enter_from_user_mode+0x21/0x80
# [  145.399372]  do_syscall_64+0x5c/0x80
# [  145.403878]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  145.409934] RIP: 0033:0x7f9eba895504
# [  145.414442] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  145.434546] RSP: 002b:00007ffecfa03548 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  145.443251] RAX: ffffffffffffffda RBX: 0000000000000012 RCX: 00007f9eba895504
# [  145.451450] RDX: 0000000000000012 RSI: 00007f9eba5e4000 RDI: 0000000000000001
# [  145.459657] RBP: 00007f9eba5e4000 R08: 00000000ffffffff R09: 0000000000000000
# [  145.467923] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f9eba5e4000
# [  145.476091] R13: 0000000000000001 R14: 0000000000000012 R15: 0000000000020000
# [  145.484267] irq event stamp: 0
# [  145.488171] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  145.495375] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  145.504709] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  145.514067] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  145.521361] ---[ end trace 9201e83dba6482c3 ]---
# [  145.526911] lkdtm: Zero detected: saturated
# REFCOUNT_ADD_ZERO: saw 'call trace:': ok
ok 55 selftests: lkdtm: REFCOUNT_ADD_ZERO.sh
# selftests: lkdtm: REFCOUNT_INC_SATURATED.sh
# [  145.812645] lkdtm: Performing direct entry REFCOUNT_INC_SATURATED
# [  145.819769] lkdtm: attempting bad refcount_inc() from saturated
# [  145.826681] ------------[ cut here ]------------
# [  145.832223] refcount_t: saturated; leaking memory.
# [  145.837931] WARNING: CPU: 7 PID: 3217 at lib/refcount.c:22 refcount_warn_saturate+0x8a/0x140
# [  145.847347] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  145.898142] CPU: 7 PID: 3217 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  145.906201] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  145.915322] RIP: 0010:refcount_warn_saturate+0x8a/0x140
# [  145.921527] Code: 00 00 00 5b 5d c3 85 ed 0f 84 83 00 00 00 80 3d 0c ce dc 03 00 75 ec 48 c7 c7 40 d6 48 84 c6 05 fc cd dc 03 01 e8 81 35 70 01 <0f> 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05
# [  145.941681] RSP: 0018:ffffc90006f7fcf8 EFLAGS: 00010286
# [  145.948323] RAX: 0000000000000000 RBX: ffffc90006f7fd30 RCX: 0000000000000000
# [  145.956434] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000deff91
# [  145.964599] RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed110277d921
# [  145.972728] R10: ffff888813bec907 R11: ffffed110277d920 R12: 0000000000000017
# [  145.980920] R13: dffffc0000000000 R14: 0000000000000390 R15: ffff8888ad59c000
# [  145.988961] FS:  00007fabe31d4540(0000) GS:ffff888813bc0000(0000) knlGS:0000000000000000
# [  145.998084] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  146.004800] CR2: 00007fabe2e4b000 CR3: 00000008b26b4005 CR4: 00000000003706e0
# [  146.012940] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  146.021160] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  146.029269] Call Trace:
# [  146.032577]  lkdtm_REFCOUNT_INC_SATURATED+0x77/0xa3
# [  146.038323]  ? lkdtm_REFCOUNT_ADD_ZERO+0x11c/0x11c
# [  146.044026]  direct_entry.cold+0x2f/0x6f
# [  146.048836]  full_proxy_write+0xfd/0x180
# [  146.053637]  vfs_write+0x184/0x8c0
# [  146.058054]  ksys_write+0xf9/0x200
# [  146.062332]  ? __ia32_sys_read+0xc0/0xc0
# [  146.067181]  ? syscall_enter_from_user_mode+0x21/0x80
# [  146.073158]  ? syscall_enter_from_user_mode+0x21/0x80
# [  146.079167]  do_syscall_64+0x5c/0x80
# [  146.083643]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  146.089483]  ? do_syscall_64+0x69/0x80
# [  146.094115]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  146.099909]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  146.105850] RIP: 0033:0x7fabe30fc504
# [  146.110313] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  146.130914] RSP: 002b:00007ffc8ace64b8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  146.139572] RAX: ffffffffffffffda RBX: 0000000000000017 RCX: 00007fabe30fc504
# [  146.147722] RDX: 0000000000000017 RSI: 00007fabe2e4b000 RDI: 0000000000000001
# [  146.156063] RBP: 00007fabe2e4b000 R08: 00000000ffffffff R09: 0000000000000000
# [  146.164259] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fabe2e4b000
# [  146.172400] R13: 0000000000000001 R14: 0000000000000017 R15: 0000000000020000
# [  146.180547] irq event stamp: 0
# [  146.184496] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  146.191797] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  146.201106] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  146.210475] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  146.217725] ---[ end trace 9201e83dba6482c4 ]---
# [  146.223316] lkdtm: Saturation detected: still saturated
# REFCOUNT_INC_SATURATED: saw 'Saturation detected: still saturated': ok
ok 56 selftests: lkdtm: REFCOUNT_INC_SATURATED.sh
# selftests: lkdtm: REFCOUNT_DEC_SATURATED.sh
# [  146.512401] lkdtm: Performing direct entry REFCOUNT_DEC_SATURATED
# [  146.519541] lkdtm: attempting bad refcount_dec() from saturated
# [  146.526345] ------------[ cut here ]------------
# [  146.531942] refcount_t: decrement hit 0; leaking memory.
# [  146.538301] WARNING: CPU: 0 PID: 3255 at lib/refcount.c:31 refcount_warn_saturate+0x12b/0x140
# [  146.547797] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  146.598704] CPU: 0 PID: 3255 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  146.606802] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  146.616049] RIP: 0010:refcount_warn_saturate+0x12b/0x140
# [  146.622401] Code: 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 0f 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8 e0 34 70 01 <0f> 0b e9 31 ff ff ff 48 89 df e8 06 50 74 ff e9 fc fe ff ff 90 41
# [  146.642994] RSP: 0018:ffffc900070dfc50 EFLAGS: 00010286
# [  146.649205] RAX: 0000000000000000 RBX: ffffc900070dfc88 RCX: 0000000000000000
# [  146.657360] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000e1bf7c
# [  146.665472] RBP: 0000000000000004 R08: 0000000000000001 R09: ffffed1102745921
# [  146.673723] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000017
# [  146.681955] R13: dffffc0000000000 R14: 00000000000003a0 R15: ffff888899d09000
# [  146.690207] FS:  00007fd1c0454540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  146.699346] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  146.706058] CR2: 00007fd1c00cb000 CR3: 00000008b6b12002 CR4: 00000000003706f0
# [  146.714276] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  146.722511] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  146.730749] Call Trace:
# [  146.734059]  lkdtm_REFCOUNT_DEC_SATURATED+0x72/0x9e
# [  146.740050]  ? lkdtm_REFCOUNT_INC_SATURATED+0xa3/0xa3
# [  146.746104]  direct_entry.cold+0x2f/0x6f
# [  146.750970]  full_proxy_write+0xfd/0x180
# [  146.755794]  vfs_write+0x184/0x8c0
# [  146.760115]  ksys_write+0xf9/0x200
# [  146.764405]  ? __ia32_sys_read+0xc0/0xc0
# [  146.769172]  ? syscall_enter_from_user_mode+0x21/0x80
# [  146.775182]  ? syscall_enter_from_user_mode+0x21/0x80
# [  146.781210]  do_syscall_64+0x5c/0x80
# [  146.785723]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  146.791144]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  146.796905]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  146.802738]  ? do_syscall_64+0x69/0x80
# [  146.807362]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  146.812776]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  146.818503]  ? asm_exc_page_fault+0x8/0x30
# [  146.823516]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  146.829334]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  146.835355] RIP: 0033:0x7fd1c037c504
# [  146.839852] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  146.860125] RSP: 002b:00007ffc3a33e398 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  146.868769] RAX: ffffffffffffffda RBX: 0000000000000017 RCX: 00007fd1c037c504
# [  146.876962] RDX: 0000000000000017 RSI: 00007fd1c00cb000 RDI: 0000000000000001
# [  146.885089] RBP: 00007fd1c00cb000 R08: 00000000ffffffff R09: 0000000000000000
# [  146.893306] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fd1c00cb000
# [  146.901427] R13: 0000000000000001 R14: 0000000000000017 R15: 0000000000020000
# [  146.909562] irq event stamp: 0
# [  146.913519] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  146.920796] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  146.930100] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  146.939459] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  146.946793] ---[ end trace 9201e83dba6482c5 ]---
# [  146.952343] lkdtm: Saturation detected: still saturated
# REFCOUNT_DEC_SATURATED: saw 'Saturation detected: still saturated': ok
ok 57 selftests: lkdtm: REFCOUNT_DEC_SATURATED.sh
# selftests: lkdtm: REFCOUNT_ADD_SATURATED.sh
# [  147.241438] lkdtm: Performing direct entry REFCOUNT_ADD_SATURATED
# [  147.248714] lkdtm: attempting bad refcount_dec() from saturated
# [  147.255761] ------------[ cut here ]------------
# [  147.261315] refcount_t: saturated; leaking memory.
# [  147.267138] WARNING: CPU: 6 PID: 3290 at lib/refcount.c:22 refcount_warn_saturate+0x8a/0x140
# [  147.276744] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  147.327419] CPU: 6 PID: 3290 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  147.335510] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  147.344755] RIP: 0010:refcount_warn_saturate+0x8a/0x140
# [  147.351048] Code: 00 00 00 5b 5d c3 85 ed 0f 84 83 00 00 00 80 3d 0c ce dc 03 00 75 ec 48 c7 c7 40 d6 48 84 c6 05 fc cd dc 03 01 e8 81 35 70 01 <0f> 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05
# [  147.371319] RSP: 0018:ffffc9000723fd00 EFLAGS: 00010282
# [  147.377662] RAX: 0000000000000000 RBX: ffffc9000723fd38 RCX: 0000000000000000
# [  147.385938] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000e47f92
# [  147.394147] RBP: 0000000000000001 R08: 0000000000000001 R09: ffffed1102775921
# [  147.402328] R10: ffff888813bac907 R11: ffffed1102775920 R12: 0000000000000017
# [  147.402541] # [  114.299375] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# 
# [  147.410584] R13: dffffc0000000000 R14: 00000000000003b0 R15: ffff88819093e000
# [  147.434796] # [  114.319369] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# 
# [  147.442643] FS:  00007f3206ec7540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# [  147.453442] # [  114.325462] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# 
# [  147.461813] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  147.474628] # [  114.333670] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# 
# [  147.480862] CR2: 00007f3206b3e000 CR3: 00000001187fc003 CR4: 00000000003706e0
# [  147.493675] # [  114.341712] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# 
# [  147.501083] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  147.513585] # [  114.349745] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# 
# [  147.521197] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  147.533797] # [  114.357852] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# 
# [  147.541416] Call Trace:
# [  147.554348] # [  114.365902] FS:  00007f0c485fb540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# 
# [  147.556637]  lkdtm_REFCOUNT_ADD_SATURATED+0x77/0xa3
# [  147.569677] # [  114.374968] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# 
# [  147.575493]  ? lkdtm_REFCOUNT_DEC_SATURATED+0x9e/0x9e
# [  147.586692] # [  114.381531] CR2: 00007f0c48272000 CR3: 000000011c93a001 CR4: 00000000003706f0
# 
# [  147.592128]  direct_entry.cold+0x2f/0x6f
# [  147.604720] # [  114.389614] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# 
# [  147.608960]  full_proxy_write+0xfd/0x180
# [  147.621448] # [  114.397701] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# 
# [  147.625781]  vfs_write+0x184/0x8c0
# [  147.636303] # BUG: saw 'kernel BUG at': ok
# [  147.637632]  ksys_write+0xf9/0x200
# 
# [  147.643062] ok 2 selftests: lkdtm: BUG.sh
# [  147.646846]  ? __ia32_sys_read+0xc0/0xc0
# 
# [  147.652277] # selftests: lkdtm: WARNING.sh
# [  147.653400]  ? syscall_enter_from_user_mode+0x21/0x80
# 
# [  147.660603] # [  114.604337] lkdtm: Performing direct entry WARNING
# [  147.663157]  ? syscall_enter_from_user_mode+0x21/0x80
# 
# [  147.667824] # [  114.610167] ------------[ cut here ]------------
# [  147.670551]  do_syscall_64+0x5c/0x80
# 
# [  147.681017] # [  114.615715] WARNING: CPU: 2 PID: 1404 at drivers/misc/lkdtm/bugs.c:83 lkdtm_WARNING+0xf/0x40
# [  147.686308]  ? irqentry_exit_to_user_mode+0xa/0x40
# 
# [  147.727862]  ? asm_exc_page_fault+0x8/0x30
# [  147.732967]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  147.738877]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  147.744926] RIP: 0033:0x7f3206def504
# [  147.749533] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  147.769741] RSP: 002b:00007ffecdbd1b08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  147.778366] RAX: ffffffffffffffda RBX: 0000000000000017 RCX: 00007f3206def504
# [  147.786602] RDX: 0000000000000017 RSI: 00007f3206b3e000 RDI: 0000000000000001
# [  147.794856] RBP: 00007f3206b3e000 R08: 00000000ffffffff R09: 0000000000000000
# [  147.803052] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f3206b3e000
# [  147.811339] R13: 0000000000000001 R14: 0000000000000017 R15: 0000000000020000
# [  147.819542] irq event stamp: 0
# [  147.823490] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  147.830771] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  147.840137] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  147.849543] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  147.856866] ---[ end trace 9201e83dba6482c6 ]---
# [  147.862480] lkdtm: Saturation detected: still saturated
# REFCOUNT_ADD_SATURATED: saw 'Saturation detected: still saturated': ok
ok 58 selftests: lkdtm: REFCOUNT_ADD_SATURATED.sh
# selftests: lkdtm: REFCOUNT_INC_NOT_ZERO_SATURATED.sh
# [  148.164849] lkdtm: Performing direct entry REFCOUNT_INC_NOT_ZERO_SATURATED
# [  148.172601] lkdtm: attempting bad refcount_inc_not_zero() from saturated
# [  148.180291] ------------[ cut here ]------------
# [  148.185856] refcount_t: saturated; leaking memory.
# [  148.191649] WARNING: CPU: 3 PID: 3325 at lib/refcount.c:19 refcount_warn_saturate+0x111/0x140
# [  148.201317] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  148.251997] CPU: 3 PID: 3325 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  148.260104] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  148.269298] RIP: 0010:refcount_warn_saturate+0x111/0x140
# [  148.275635] Code: 35 70 01 0f 0b e9 72 ff ff ff 80 3d 8a cd dc 03 00 0f 85 65 ff ff ff 48 c7 c7 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 <0f> 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8
# [  148.296103] RSP: 0018:ffffc9000738fc58 EFLAGS: 00010282
# [  148.302264] RAX: 0000000000000000 RBX: ffffc9000738fd28 RCX: 0000000000000000
# [  148.310443] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000e71f7d
# [  148.318634] RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed110275d921
# [  148.326871] R10: ffff888813aec907 R11: ffffed110275d920 R12: 1ffff92000e71f8f
# [  148.335048] R13: 0000000000000001 R14: ffffc9000738fc98 R15: ffff8888a7f7f000
# [  148.343260] FS:  00007f2af968b540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  148.352455] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  148.359223] CR2: 00007f2af9302000 CR3: 00000008b5db8006 CR4: 00000000003706e0
# [  148.367353] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  148.375630] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  148.383801] Call Trace:
# [  148.387094]  __refcount_add_not_zero.constprop.0+0xed/0x128
# [  148.394147]  ? __refcount_dec.constprop.0+0x2a/0x2a
# [  148.399968]  ? _printk+0xb2/0xe3
# [  148.404116]  ? record_print_text.cold+0x11/0x11
# [  148.409632]  ? wake_up_klogd.part.0+0x76/0xc0
# [  148.414913]  lkdtm_REFCOUNT_INC_NOT_ZERO_SATURATED+0x79/0xbf
# [  148.421604]  ? lkdtm_REFCOUNT_ADD_SATURATED+0xa3/0xa3
# [  148.427723]  direct_entry.cold+0x2f/0x6f
# [  148.432625]  full_proxy_write+0xfd/0x180
# [  148.437531]  vfs_write+0x184/0x8c0
# [  148.441902]  ksys_write+0xf9/0x200
# [  148.446266]  ? __ia32_sys_read+0xc0/0xc0
# [  148.451141]  ? trace_hardirqs_on_prepare+0x1/0x180
# [  148.456976]  ? syscall_enter_from_user_mode+0x21/0x80
# [  148.463040]  ? syscall_enter_from_user_mode+0x21/0x80
# [  148.469034]  do_syscall_64+0x5c/0x80
# [  148.473540]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  148.478899]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  148.484562]  ? asm_exc_page_fault+0x8/0x30
# [  148.489529]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  148.495402]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  148.501417] RIP: 0033:0x7f2af95b3504
# [  148.505913] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  148.526187] RSP: 002b:00007ffe2366f838 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  148.534762] RAX: ffffffffffffffda RBX: 0000000000000020 RCX: 00007f2af95b3504
# [  148.542975] RDX: 0000000000000020 RSI: 00007f2af9302000 RDI: 0000000000000001
# [  148.551153] RBP: 00007f2af9302000 R08: 00000000ffffffff R09: 0000000000000000
# [  148.559295] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f2af9302000
# [  148.567509] R13: 0000000000000001 R14: 0000000000000020 R15: 0000000000020000
# [  148.575684] irq event stamp: 0
# [  148.579645] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  148.586921] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  148.596333] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  148.605651] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  148.612887] ---[ end trace 9201e83dba6482c7 ]---
# [  148.618473] lkdtm: Saturation detected: still saturated
# REFCOUNT_INC_NOT_ZERO_SATURATED: saw 'call trace:': ok
ok 59 selftests: lkdtm: REFCOUNT_INC_NOT_ZERO_SATURATED.sh
# selftests: lkdtm: REFCOUNT_ADD_NOT_ZERO_SATURATED.sh
# [  148.893156] lkdtm: Performing direct entry REFCOUNT_ADD_NOT_ZERO_SATURATED
# [  148.901163] lkdtm: attempting bad refcount_add_not_zero() from saturated
# [  148.908930] ------------[ cut here ]------------
# [  148.914529] refcount_t: saturated; leaking memory.
# [  148.920522] WARNING: CPU: 2 PID: 3360 at lib/refcount.c:19 refcount_warn_saturate+0x111/0x140
# [  148.930239] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  148.981334] CPU: 2 PID: 3360 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  148.989440] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  148.998637] RIP: 0010:refcount_warn_saturate+0x111/0x140
# [  149.004930] Code: 35 70 01 0f 0b e9 72 ff ff ff 80 3d 8a cd dc 03 00 0f 85 65 ff ff ff 48 c7 c7 40 d6 48 84 c6 05 76 cd dc 03 01 e8 fa 34 70 01 <0f> 0b e9 4b ff ff ff 48 c7 c7 a0 d7 48 84 c6 05 58 cd dc 03 01 e8
# [  149.025211] RSP: 0018:ffffc900074cfc08 EFLAGS: 00010286
# [  149.031398] RAX: 0000000000000000 RBX: ffffc900074cfcd8 RCX: 0000000000000000
# [  149.040183] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000e99f73
# [  149.048431] RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed1102755921
# [  149.056697] R10: ffff888813aac907 R11: ffffed1102755920 R12: 1ffff92000e99f85
# [  149.064923] R13: 0000000000000007 R14: ffffc900074cfc48 R15: ffff8888af305000
# [  149.073001] FS:  00007f41f79bb540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  149.082070] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  149.088823] CR2: 00007f41f7632000 CR3: 000000015259e004 CR4: 00000000003706e0
# [  149.097009] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  149.105235] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  149.113407] Call Trace:
# [  149.116765]  __refcount_add_not_zero.constprop.0+0xed/0x128
# [  149.123262]  ? __refcount_dec.constprop.0+0x2a/0x2a
# [  149.129176]  ? _printk+0xb2/0xe3
# [  149.133276]  ? record_print_text.cold+0x11/0x11
# [  149.138802]  ? wake_up_klogd.part.0+0x76/0xc0
# [  149.144080]  lkdtm_REFCOUNT_ADD_NOT_ZERO_SATURATED+0x79/0xbf
# [  149.150848]  ? lkdtm_REFCOUNT_INC_NOT_ZERO_SATURATED+0xbf/0xbf
# [  149.157679]  direct_entry.cold+0x2f/0x6f
# [  149.162487]  full_proxy_write+0xfd/0x180
# [  149.167309]  vfs_write+0x184/0x8c0
# [  149.171623]  ksys_write+0xf9/0x200
# [  149.176003]  ? __ia32_sys_read+0xc0/0xc0
# [  149.180848]  ? syscall_enter_from_user_mode+0x21/0x80
# [  149.186858]  ? syscall_enter_from_user_mode+0x21/0x80
# [  149.192918]  do_syscall_64+0x5c/0x80
# [  149.197456]  ? rcu_read_lock_held_common+0xe/0xc0
# [  149.203100]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  149.208887]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  149.214250]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  149.220072]  ? asm_exc_page_fault+0x8/0x30
# [  149.225142]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  149.231072]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  149.237086] RIP: 0033:0x7f41f78e3504
# [  149.241597] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  149.261832] RSP: 002b:00007ffc3170a5f8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  149.270500] RAX: ffffffffffffffda RBX: 0000000000000020 RCX: 00007f41f78e3504
# [  149.278712] RDX: 0000000000000020 RSI: 00007f41f7632000 RDI: 0000000000000001
# [  149.286943] RBP: 00007f41f7632000 R08: 00000000ffffffff R09: 0000000000000000
# [  149.295157] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f41f7632000
# [  149.303345] R13: 0000000000000001 R14: 0000000000000020 R15: 0000000000020000
# [  149.311589] irq event stamp: 0
# [  149.315612] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  149.322965] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  149.332376] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  149.341731] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  149.349056] ---[ end trace 9201e83dba6482c8 ]---
# [  149.354700] lkdtm: Saturation detected: still saturated
# REFCOUNT_ADD_NOT_ZERO_SATURATED: saw 'call trace:': ok
ok 60 selftests: lkdtm: REFCOUNT_ADD_NOT_ZERO_SATURATED.sh
# selftests: lkdtm: REFCOUNT_DEC_AND_TEST_SATURATED.sh
# [  149.651562] lkdtm: Performing direct entry REFCOUNT_DEC_AND_TEST_SATURATED
# [  149.659501] lkdtm: attempting bad refcount_dec_and_test() from saturated
# [  149.667181] ------------[ cut here ]------------
# [  149.672718] refcount_t: underflow; use-after-free.
# [  149.678492] WARNING: CPU: 2 PID: 3398 at lib/refcount.c:28 refcount_warn_saturate+0xaa/0x140
# [  149.688022] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  149.738762] CPU: 2 PID: 3398 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  149.746857] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  149.756076] RIP: 0010:refcount_warn_saturate+0xaa/0x140
# [  149.762341] Code: fc cd dc 03 01 e8 81 35 70 01 0f 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05 da cd dc 03 01 e8 61 35 70 01 <0f> 0b eb b5 80 3d c8 cd dc 03 00 75 ac 48 c7 c7 00 d8 48 84 c6 05
# [  149.782709] RSP: 0018:ffffc9000761fcd8 EFLAGS: 00010286
# [  149.788927] RAX: 0000000000000000 RBX: ffffc9000761fd28 RCX: 0000000000000000
# [  149.797101] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000ec3f8d
# [  149.805284] RBP: 0000000000000003 R08: 0000000000000001 R09: ffffed1102755921
# [  149.813492] R10: ffff888813aac907 R11: ffffed1102755920 R12: 0000000000000020
# [  149.821649] R13: dffffc0000000000 R14: 00000000000003e0 R15: ffff8888a8861000
# [  149.829853] FS:  00007fc57d746540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  149.839089] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  149.845865] CR2: 00007fc57d3bd000 CR3: 000000018946e004 CR4: 00000000003706e0
# [  149.853919] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  149.862065] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  149.870286] Call Trace:
# [  149.873633]  __refcount_sub_and_test.constprop.0+0x4b/0x80
# [  149.880399]  lkdtm_REFCOUNT_DEC_AND_TEST_SATURATED+0x79/0xbf
# [  149.887081]  ? lkdtm_REFCOUNT_ADD_NOT_ZERO_SATURATED+0xbf/0xbf
# [  149.893866]  direct_entry.cold+0x2f/0x6f
# [  149.898737]  full_proxy_write+0xfd/0x180
# [  149.903551]  vfs_write+0x184/0x8c0
# [  149.907876]  ksys_write+0xf9/0x200
# [  149.912142]  ? __ia32_sys_read+0xc0/0xc0
# [  149.917050]  ? syscall_enter_from_user_mode+0x21/0x80
# [  149.923027]  ? syscall_enter_from_user_mode+0x21/0x80
# [  149.928973]  do_syscall_64+0x5c/0x80
# [  149.933428]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  149.938833]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  149.944569]  ? asm_exc_page_fault+0x8/0x30
# [  149.949631]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  149.955473]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  149.961436] RIP: 0033:0x7fc57d66e504
# [  149.965918] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  149.986082] RSP: 002b:00007ffca98b5158 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  149.994581] RAX: ffffffffffffffda RBX: 0000000000000020 RCX: 00007fc57d66e504
# [  150.002721] RDX: 0000000000000020 RSI: 00007fc57d3bd000 RDI: 0000000000000001
# [  150.010860] RBP: 00007fc57d3bd000 R08: 00000000ffffffff R09: 0000000000000000
# [  150.018994] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fc57d3bd000
# [  150.027081] R13: 0000000000000001 R14: 0000000000000020 R15: 0000000000020000
# [  150.035325] irq event stamp: 0
# [  150.039250] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  150.046499] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  150.055866] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  150.065175] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  150.072517] ---[ end trace 9201e83dba6482c9 ]---
# [  150.078041] lkdtm: Saturation detected: still saturated
# REFCOUNT_DEC_AND_TEST_SATURATED: saw 'Saturation detected: still saturated': ok
ok 61 selftests: lkdtm: REFCOUNT_DEC_AND_TEST_SATURATED.sh
# selftests: lkdtm: REFCOUNT_SUB_AND_TEST_SATURATED.sh
# [  150.379123] lkdtm: Performing direct entry REFCOUNT_SUB_AND_TEST_SATURATED
# [  150.387050] lkdtm: attempting bad refcount_sub_and_test() from saturated
# [  150.394861] ------------[ cut here ]------------
# [  150.400454] refcount_t: underflow; use-after-free.
# [  150.406542] WARNING: CPU: 6 PID: 3433 at lib/refcount.c:28 refcount_warn_saturate+0xaa/0x140
# [  150.416079] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  150.467115] CPU: 6 PID: 3433 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  150.475241] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  150.484422] RIP: 0010:refcount_warn_saturate+0xaa/0x140
# [  150.490648] Code: fc cd dc 03 01 e8 81 35 70 01 0f 0b eb d5 80 3d ea cd dc 03 00 75 cc 48 c7 c7 40 d7 48 84 c6 05 da cd dc 03 01 e8 61 35 70 01 <0f> 0b eb b5 80 3d c8 cd dc 03 00 75 ac 48 c7 c7 00 d8 48 84 c6 05
# [  150.510958] RSP: 0018:ffffc9000777fc60 EFLAGS: 00010282
# [  150.517184] RAX: 0000000000000000 RBX: ffffc9000777fcb0 RCX: 0000000000000000
# [  150.525399] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000eeff7e
# [  150.533556] RBP: 0000000000000003 R08: 0000000000000001 R09: ffffed1102775921
# [  150.541637] R10: ffff888813bac907 R11: ffffed1102775920 R12: 0000000000000020
# [  150.549768] R13: dffffc0000000000 R14: 00000000000003f0 R15: ffff8888b5d97000
# [  150.557998] FS:  00007fc8e4c0a540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  150.567159] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  150.573896] CR2: 00007ffe70e72058 CR3: 00000008a872a001 CR4: 00000000003706e0
# [  150.582111] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  150.590394] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  150.598718] Call Trace:
# [  150.602074]  __refcount_sub_and_test.constprop.0+0x4b/0x80
# [  150.608610]  lkdtm_REFCOUNT_SUB_AND_TEST_SATURATED+0x79/0xbf
# [  150.615288]  ? lkdtm_REFCOUNT_DEC_AND_TEST_SATURATED+0xbf/0xbf
# [  150.622131]  direct_entry.cold+0x2f/0x6f
# [  150.626994]  full_proxy_write+0xfd/0x180
# [  150.631948]  vfs_write+0x184/0x8c0
# [  150.636305]  ksys_write+0xf9/0x200
# [  150.640575]  ? __ia32_sys_read+0xc0/0xc0
# [  150.645411]  ? syscall_enter_from_user_mode+0x21/0x80
# [  150.651510]  ? syscall_enter_from_user_mode+0x21/0x80
# [  150.657615]  do_syscall_64+0x5c/0x80
# [  150.662088]  ? do_syscall_64+0x69/0x80
# [  150.666802]  ? rcu_read_lock_held_common+0xe/0xc0
# [  150.672532]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  150.678315]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  150.683726]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  150.689473]  ? asm_exc_page_fault+0x8/0x30
# [  150.694513]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  150.700446]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  150.706500] RIP: 0033:0x7fc8e4b32504
# [  150.711033] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  150.731347] RSP: 002b:00007ffc688535a8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  150.739956] RAX: ffffffffffffffda RBX: 0000000000000020 RCX: 00007fc8e4b32504
# [  150.748194] RDX: 0000000000000020 RSI: 00007fc8e4881000 RDI: 0000000000000001
# [  150.756328] RBP: 00007fc8e4881000 R08: 00000000ffffffff R09: 0000000000000000
# [  150.764448] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fc8e4881000
# [  150.772679] R13: 0000000000000001 R14: 0000000000000020 R15: 0000000000020000
# [  150.780859] irq event stamp: 0
# [  150.784842] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  150.792099] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  150.801447] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  150.810845] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  150.818212] ---[ end trace 9201e83dba6482ca ]---
# [  150.823811] lkdtm: Saturation detected: still saturated
# REFCOUNT_SUB_AND_TEST_SATURATED: saw 'Saturation detected: still saturated': ok
ok 62 selftests: lkdtm: REFCOUNT_SUB_AND_TEST_SATURATED.sh
# selftests: lkdtm: REFCOUNT_TIMING.sh
# Skipping REFCOUNT_TIMING: timing only
ok 63 selftests: lkdtm: REFCOUNT_TIMING.sh # SKIP
# selftests: lkdtm: ATOMIC_TIMING.sh
# Skipping ATOMIC_TIMING: timing only
ok 64 selftests: lkdtm: ATOMIC_TIMING.sh # SKIP
# selftests: lkdtm: USERCOPY_HEAP_SIZE_TO.sh
# Segmentation fault
# [  151.367818] lkdtm: Performing direct entry USERCOPY_HEAP_SIZE_TO
# [  151.374824] lkdtm: attempting good copy_to_user of correct size
# [  151.381702] lkdtm: attempting bad copy_to_user of too large size
# [  151.388620] usercopy: Kernel memory exposure attempt detected from SLUB object 'kmalloc-1k' (offset 16, size 1024)!
# [  151.400139] ------------[ cut here ]------------
# [  151.405557] kernel BUG at mm/usercopy.c:99!
# [  151.410680] invalid opcode: 0000 [#20] PREEMPT SMP KASAN PTI
# [  151.417293] CPU: 3 PID: 3526 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  151.425375] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  151.434479] RIP: 0010:usercopy_abort+0x77/0x79
# [  151.439867] Code: 4c 0f 45 de 51 4c 89 d1 48 c7 c2 60 1a 3a 84 57 48 c7 c6 e0 19 3a 84 48 c7 c7 80 1b 3a 84 48 0f 45 f2 4c 89 da e8 dd 4b fe ff <0f> 0b e8 d9 84 01 fe 4c 89 e1 49 89 d8 44 89 ea 4c 29 f1 31 f6 48
# [  151.460073] RSP: 0018:ffffc90007a8fd20 EFLAGS: 00010282
# [  151.466258] RAX: 0000000000000067 RBX: 0000000000000400 RCX: 0000000000000000
# [  151.474419] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000f51f97
# [  151.482530] RBP: ffff8881c27b7c10 R08: 0000000000000067 R09: ffffed110275d921
# [  151.490684] R10: ffff888813aec907 R11: ffffed110275d920 R12: ffff8881c27b7810
# [  151.498882] R13: 0000000000000001 R14: ffffea000709ec00 R15: ffffea000709ec00
# [  151.507095] FS:  00007f6ded402540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  151.516153] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  151.522871] CR2: 00007f6ded077010 CR3: 00000008a802a002 CR4: 00000000003706e0
# [  151.531029] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  151.539235] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  151.547419] Call Trace:
# [  151.550751]  __check_heap_object+0xdb/0x140
# [  151.555889]  __check_object_size+0x23e/0x300
# [  151.561100]  do_usercopy_heap_size.cold+0x1fc/0x303
# [  151.566953]  direct_entry.cold+0x2f/0x6f
# [  151.571743]  full_proxy_write+0xfd/0x180
# [  151.576601]  vfs_write+0x184/0x8c0
# [  151.580891]  ksys_write+0xf9/0x200
# [  151.585177]  ? __ia32_sys_read+0xc0/0xc0
# [  151.590018]  ? trace_hardirqs_on_prepare+0x1/0x180
# [  151.595772]  ? syscall_enter_from_user_mode+0x21/0x80
# [  151.601819]  ? syscall_enter_from_user_mode+0x21/0x80
# [  151.607763]  do_syscall_64+0x5c/0x80
# [  151.612193]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  151.618065]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  151.624060] RIP: 0033:0x7f6ded32a504
# [  151.628530] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  151.648880] RSP: 002b:00007ffc108103c8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  151.657389] RAX: ffffffffffffffda RBX: 0000000000000016 RCX: 00007f6ded32a504
# [  151.665526] RDX: 0000000000000016 RSI: 00007f6ded079000 RDI: 0000000000000001
# [  151.673674] RBP: 00007f6ded079000 R08: 00000000ffffffff R09: 0000000000000000
# [  151.681849] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f6ded079000
# [  151.690003] R13: 0000000000000001 R14: 0000000000000016 R15: 0000000000020000
# [  151.698169] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  151.749375] ---[ end trace 9201e83dba6482cb ]---
# [  151.755176] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  151.759950] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  151.779998] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  151.786206] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  151.794310] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  151.802434] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  151.810552] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  151.818647] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  151.826786] FS:  00007f6ded402540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  151.835895] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  151.842529] CR2: 00007f6ded077010 CR3: 00000008a802a002 CR4: 00000000003706e0
# [  151.850594] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  151.858773] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# USERCOPY_HEAP_SIZE_TO: saw 'call trace:': ok
ok 65 selftests: lkdtm: USERCOPY_HEAP_SIZE_TO.sh
# selftests: lkdtm: USERCOPY_HEAP_SIZE_FROM.sh
# Segmentation fault
# [  152.151804] lkdtm: Performing direct entry USERCOPY_HEAP_SIZE_FROM
# [  152.159201] lkdtm: attempting good copy_from_user of correct size
# [  152.166371] lkdtm: attempting bad copy_from_user of too large size
# [  152.173492] usercopy: Kernel memory overwrite attempt detected to SLUB object 'kmalloc-1k' (offset 16, size 1024)!
# [  152.184933] ------------[ cut here ]------------
# [  152.190599] kernel BUG at mm/usercopy.c:99!
# [  152.195768] invalid opcode: 0000 [#21] PREEMPT SMP KASAN PTI
# [  152.202376] CPU: 2 PID: 3561 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  152.210470] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  152.219662] RIP: 0010:usercopy_abort+0x77/0x79
# [  152.225067] Code: 4c 0f 45 de 51 4c 89 d1 48 c7 c2 60 1a 3a 84 57 48 c7 c6 e0 19 3a 84 48 c7 c7 80 1b 3a 84 48 0f 45 f2 4c 89 da e8 dd 4b fe ff <0f> 0b e8 d9 84 01 fe 4c 89 e1 49 89 d8 44 89 ea 4c 29 f1 31 f6 48
# [  152.245368] RSP: 0018:ffffc90007befd00 EFLAGS: 00010286
# [  152.251528] RAX: 0000000000000066 RBX: 0000000000000400 RCX: 0000000000000000
# [  152.259716] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000f7df93
# [  152.267896] RBP: ffff88889a261c10 R08: 0000000000000066 R09: ffffed1102755921
# [  152.276121] R10: ffff888813aac907 R11: ffffed1102755920 R12: ffff88889a261810
# [  152.284300] R13: 0000000000000000 R14: ffffea0022689800 R15: ffffea0022689800
# [  152.292448] FS:  00007f8150331540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  152.301603] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  152.308321] CR2: 00007f814ffa6010 CR3: 00000008a60d0003 CR4: 00000000003706e0
# [  152.316547] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  152.324733] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  152.332930] Call Trace:
# [  152.336265]  __check_heap_object+0xdb/0x140
# [  152.341366]  __check_object_size+0x23e/0x300
# [  152.346577]  do_usercopy_heap_size.cold+0xe4/0x303
# [  152.352279]  direct_entry.cold+0x2f/0x6f
# [  152.357072]  full_proxy_write+0xfd/0x180
# [  152.361900]  vfs_write+0x184/0x8c0
# [  152.366205]  ksys_write+0xf9/0x200
# [  152.370492]  ? __ia32_sys_read+0xc0/0xc0
# [  152.375353]  ? syscall_enter_from_user_mode+0x21/0x80
# [  152.381409]  ? syscall_enter_from_user_mode+0x21/0x80
# [  152.387418]  do_syscall_64+0x5c/0x80
# [  152.391908]  ? asm_exc_page_fault+0x8/0x30
# [  152.396955]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  152.402800]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  152.408825] RIP: 0033:0x7f8150259504
# [  152.413306] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  152.433620] RSP: 002b:00007ffd70649b08 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  152.442251] RAX: ffffffffffffffda RBX: 0000000000000018 RCX: 00007f8150259504
# [  152.450414] RDX: 0000000000000018 RSI: 00007f814ffa8000 RDI: 0000000000000001
# [  152.458569] RBP: 00007f814ffa8000 R08: 00000000ffffffff R09: 0000000000000000
# [  152.466775] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f814ffa8000
# [  152.474949] R13: 0000000000000001 R14: 0000000000000018 R15: 0000000000020000
# [  152.483165] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  152.534267] ---[ end trace 9201e83dba6482cc ]---
# [  152.540233] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  152.545120] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  152.565400] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  152.571528] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  152.579694] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  152.587872] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  152.596022] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  152.604188] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  152.612334] FS:  00007f8150331540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  152.621556] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  152.628263] CR2: 00007f814ffa6010 CR3: 00000008a60d0003 CR4: 00000000003706e0
# [  152.636462] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  152.644626] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# USERCOPY_HEAP_SIZE_FROM: saw 'call trace:': ok
ok 66 selftests: lkdtm: USERCOPY_HEAP_SIZE_FROM.sh
# selftests: lkdtm: USERCOPY_HEAP_WHITELIST_TO.sh
# [  152.943741] lkdtm: Performing direct entry USERCOPY_HEAP_WHITELIST_TO
# [  152.951424] lkdtm: attempting good copy_to_user inside whitelist
# [  152.958541] lkdtm: attempting bad copy_to_user outside whitelist
# [  152.965466] ------------[ cut here ]------------
# [  152.970973] Bad or missing usercopy whitelist? Kernel memory exposure attempt detected from SLUB object 'lkdtm-usercopy' (offset 255, size 64)!
# [  152.985357] WARNING: CPU: 4 PID: 3596 at mm/usercopy.c:75 usercopy_warn+0x7d/0xc0
# [  152.993934] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  153.044562] CPU: 4 PID: 3596 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  153.052624] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  153.061800] RIP: 0010:usercopy_warn+0x7d/0xc0
# [  153.067127] Code: 3a 84 41 51 49 89 c0 49 c7 c2 e0 19 3a 84 49 89 f1 48 89 f9 4c 0f 45 d2 48 c7 c7 a0 1a 3a 84 4c 89 da 4c 89 d6 e8 0e 26 f4 01 <0f> 0b 48 83 c4 18 c3 48 c7 c6 a0 18 3a 84 49 89 f1 48 89 f0 eb 96
# [  153.087284] RSP: 0018:ffffc90007d2fcc8 EFLAGS: 00010282
# [  153.093458] RAX: 0000000000000000 RBX: 0000000000000040 RCX: 0000000000000000
# [  153.101607] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000fa5f8b
# [  153.109664] RBP: ffff88818b28a0bf R08: 0000000000000001 R09: ffffed1102765921
# [  153.117901] R10: ffff888813b2c907 R11: ffffed1102765920 R12: ffff88818b28a07f
# [  153.126066] R13: 0000000000000001 R14: ffffea00062ca200 R15: ffffea00062ca200
# [  153.134259] FS:  00007f021e152540(0000) GS:ffff888813b00000(0000) knlGS:0000000000000000
# [  153.143465] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  153.150213] CR2: 00007f021ddc7000 CR3: 0000000104e34005 CR4: 00000000003706e0
# [  153.158417] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  153.166592] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  153.174717] Call Trace:
# [  153.178072]  __check_object_size+0x23e/0x300
# [  153.183257]  do_usercopy_heap_whitelist.cold+0x146/0x24d
# [  153.189611]  direct_entry.cold+0x2f/0x6f
# [  153.194484]  full_proxy_write+0xfd/0x180
# [  153.199363]  vfs_write+0x184/0x8c0
# [  153.203593]  ksys_write+0xf9/0x200
# [  153.207901]  ? __ia32_sys_read+0xc0/0xc0
# [  153.212701]  ? syscall_enter_from_user_mode+0x21/0x80
# [  153.218698]  ? syscall_enter_from_user_mode+0x21/0x80
# [  153.224744]  do_syscall_64+0x5c/0x80
# [  153.229191]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  153.234873]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  153.240316]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  153.246023]  ? asm_exc_page_fault+0x8/0x30
# [  153.251127]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  153.256876]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  153.262910] RIP: 0033:0x7f021e07a504
# [  153.267376] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  153.287316] RSP: 002b:00007fff448d7ab8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  153.295859] RAX: ffffffffffffffda RBX: 000000000000001b RCX: 00007f021e07a504
# [  153.304066] RDX: 000000000000001b RSI: 00007f021ddc9000 RDI: 0000000000000001
# [  153.312165] RBP: 00007f021ddc9000 R08: 00000000ffffffff R09: 0000000000000000
# [  153.320401] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f021ddc9000
# [  153.328637] R13: 0000000000000001 R14: 000000000000001b R15: 0000000000020000
# [  153.336902] irq event stamp: 0
# [  153.340836] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  153.348133] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  153.357474] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  153.366729] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  153.374032] ---[ end trace 9201e83dba6482cd ]---
# [  153.379606] lkdtm: FAIL: bad usercopy not detected!
# [  153.385379] lkdtm: Unexpected! This kernel (5.15.0 x86_64) was built with CONFIG_HARDENED_USERCOPY=y (and booted without 'hardened_usercopy' specified)
# USERCOPY_HEAP_WHITELIST_TO: saw 'call trace:': ok
ok 67 selftests: lkdtm: USERCOPY_HEAP_WHITELIST_TO.sh
# selftests: lkdtm: USERCOPY_HEAP_WHITELIST_FROM.sh
# [  153.701290] lkdtm: Performing direct entry USERCOPY_HEAP_WHITELIST_FROM
# [  153.709054] lkdtm: attempting good copy_from_user inside whitelist
# [  153.716215] lkdtm: attempting bad copy_from_user outside whitelist
# [  153.723458] ------------[ cut here ]------------
# [  153.729100] Bad or missing usercopy whitelist? Kernel memory overwrite attempt detected to SLUB object 'lkdtm-usercopy' (offset 255, size 64)!
# [  153.743166] WARNING: CPU: 6 PID: 3631 at mm/usercopy.c:75 usercopy_warn+0x7d/0xc0
# [  153.751799] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  153.802684] CPU: 6 PID: 3631 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  153.810901] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  153.820064] RIP: 0010:usercopy_warn+0x7d/0xc0
# [  153.825401] Code: 3a 84 41 51 49 89 c0 49 c7 c2 e0 19 3a 84 49 89 f1 48 89 f9 4c 0f 45 d2 48 c7 c7 a0 1a 3a 84 4c 89 da 4c 89 d6 e8 0e 26 f4 01 <0f> 0b 48 83 c4 18 c3 48 c7 c6 a0 18 3a 84 49 89 f1 48 89 f0 eb 96
# [  153.845802] RSP: 0018:ffffc90007ebfd20 EFLAGS: 00010286
# [  153.852097] RAX: 0000000000000000 RBX: 0000000000000040 RCX: 0000000000000000
# [  153.860803] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52000fd7f96
# [  153.869076] RBP: ffff888230faed3f R08: 0000000000000001 R09: ffffed1102775921
# [  153.877372] R10: ffff888813bac907 R11: ffffed1102775920 R12: ffff888230faecff
# [  153.885710] R13: 0000000000000000 R14: ffffea0008c3ea00 R15: ffffea0008c3ea00
# [  153.894009] FS:  00007efd169df540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# [  153.903256] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  153.910069] CR2: 00007efd16654000 CR3: 00000008a793c005 CR4: 00000000003706e0
# [  153.918216] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  153.926386] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  153.934574] Call Trace:
# [  153.937998]  __check_object_size+0x23e/0x300
# [  153.943252]  do_usercopy_heap_whitelist.cold+0xdd/0x24d
# [  153.949444]  direct_entry.cold+0x2f/0x6f
# [  153.954314]  full_proxy_write+0xfd/0x180
# [  153.959242]  vfs_write+0x184/0x8c0
# [  153.963552]  ksys_write+0xf9/0x200
# [  153.967821]  ? __ia32_sys_read+0xc0/0xc0
# [  153.972613]  ? syscall_enter_from_user_mode+0x21/0x80
# [  153.978611]  ? syscall_enter_from_user_mode+0x21/0x80
# [  153.984615]  do_syscall_64+0x5c/0x80
# [  153.989207]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  153.995051]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  154.001179] RIP: 0033:0x7efd16907504
# [  154.005716] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  154.025854] RSP: 002b:00007fff37078128 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  154.034512] RAX: ffffffffffffffda RBX: 000000000000001d RCX: 00007efd16907504
# [  154.042708] RDX: 000000000000001d RSI: 00007efd16656000 RDI: 0000000000000001
# [  154.050941] RBP: 00007efd16656000 R08: 00000000ffffffff R09: 0000000000000000
# [  154.059155] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007efd16656000
# [  154.067364] R13: 0000000000000001 R14: 000000000000001d R15: 0000000000020000
# [  154.075532] irq event stamp: 0
# [  154.079469] hardirqs last  enabled at (0): [<0000000000000000>] 0x0
# [  154.086777] hardirqs last disabled at (0): [<ffffffff813e2d27>] copy_process+0x1467/0x6180
# [  154.096164] softirqs last  enabled at (0): [<ffffffff813e2d66>] copy_process+0x14a6/0x6180
# [  154.105602] softirqs last disabled at (0): [<0000000000000000>] 0x0
# [  154.112917] ---[ end trace 9201e83dba6482ce ]---
# [  154.118487] lkdtm: FAIL: bad usercopy not detected!
# [  154.124379] lkdtm: Unexpected! This kernel (5.15.0 x86_64) was built with CONFIG_HARDENED_USERCOPY=y (and booted without 'hardened_usercopy' specified)
# USERCOPY_HEAP_WHITELIST_FROM: saw 'call trace:': ok
ok 68 selftests: lkdtm: USERCOPY_HEAP_WHITELIST_FROM.sh
# selftests: lkdtm: USERCOPY_STACK_FRAME_TO.sh
# [  154.420887] lkdtm: Performing direct entry USERCOPY_STACK_FRAME_TO
# [  154.428199] lkdtm: attempting good copy_to_user of local stack
# [  154.435077] lkdtm: attempting bad copy_to_user of distant stack
# USERCOPY_STACK_FRAME_TO: missing 'call trace:': [FAIL]
not ok 69 selftests: lkdtm: USERCOPY_STACK_FRAME_TO.sh # exit=1
# selftests: lkdtm: USERCOPY_STACK_FRAME_FROM.sh
# [  154.745945] lkdtm: Performing direct entry USERCOPY_STACK_FRAME_FROM
# [  154.753214] lkdtm: attempting good copy_from_user of local stack
# [  154.760146] lkdtm: attempting bad copy_from_user of distant stack
# USERCOPY_STACK_FRAME_FROM: missing 'call trace:': [FAIL]
not ok 70 selftests: lkdtm: USERCOPY_STACK_FRAME_FROM.sh # exit=1
# selftests: lkdtm: USERCOPY_STACK_BEYOND.sh
# Segmentation fault
# [  155.049703] lkdtm: Performing direct entry USERCOPY_STACK_BEYOND
# [  155.056821] lkdtm: attempting good copy_to_user of local stack
# [  155.063830] lkdtm: attempting bad copy_to_user of distant stack
# [  155.070731] usercopy: Kernel memory exposure attempt detected from process stack (offset 0, size 32)!
# [  155.081068] ------------[ cut here ]------------
# [  155.086651] kernel BUG at mm/usercopy.c:99!
# [  155.091821] invalid opcode: 0000 [#22] PREEMPT SMP KASAN PTI
# [  155.098479] CPU: 6 PID: 3737 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  155.106609] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  155.115831] RIP: 0010:usercopy_abort+0x77/0x79
# [  155.121251] Code: 4c 0f 45 de 51 4c 89 d1 48 c7 c2 60 1a 3a 84 57 48 c7 c6 e0 19 3a 84 48 c7 c7 80 1b 3a 84 48 0f 45 f2 4c 89 da e8 dd 4b fe ff <0f> 0b e8 d9 84 01 fe 4c 89 e1 49 89 d8 44 89 ea 4c 29 f1 31 f6 48
# [  155.141578] RSP: 0018:ffffc9000831fc40 EFLAGS: 00010286
# [  155.147731] RAX: 0000000000000059 RBX: 0000000000000020 RCX: 0000000000000000
# [  155.155910] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52001063f7b
# [  155.164092] RBP: ffffc90008320018 R08: 0000000000000059 R09: ffffed1102775921
# [  155.172263] R10: ffff888813bac907 R11: ffffed1102775920 R12: ffffc9000831fff8
# [  155.180400] R13: 0000000000000001 R14: ffff88811c8e8000 R15: 000000000000002e
# [  155.188548] FS:  00007fdd58c0f540(0000) GS:ffff888813b80000(0000) knlGS:0000000000000000
# [  155.197669] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  155.204368] CR2: 00007fdd58884000 CR3: 0000000895358004 CR4: 00000000003706e0
# [  155.212500] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  155.220665] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  155.228776] Call Trace:
# [  155.232070]  __check_object_size.cold+0x79/0x94
# [  155.237486]  do_usercopy_stack.cold+0x17f/0x197
# [  155.242993]  ? do_usercopy_heap_size+0x180/0x180
# [  155.248523]  ? drain_pages+0x80/0x80
# [  155.253012]  ? free_unref_page+0x33d/0x5c0
# [  155.258002]  ? trace_hardirqs_on+0x41/0x140
# [  155.263096]  direct_entry.cold+0x2f/0x6f
# [  155.267928]  full_proxy_write+0xfd/0x180
# [  155.272797]  vfs_write+0x184/0x8c0
# [  155.277081]  ksys_write+0xf9/0x200
# [  155.281419]  ? __ia32_sys_read+0xc0/0xc0
# [  155.286273]  ? syscall_enter_from_user_mode+0x21/0x80
# [  155.292247]  ? syscall_enter_from_user_mode+0x21/0x80
# [  155.298229]  do_syscall_64+0x5c/0x80
# [  155.302712]  ? do_syscall_64+0x69/0x80
# [  155.307331]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  155.313068]  ? asm_exc_page_fault+0x8/0x30
# [  155.318054]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  155.323829]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  155.329814] RIP: 0033:0x7fdd58b37504
# [  155.334278] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  155.354477] RSP: 002b:00007fff134ece58 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  155.363066] RAX: ffffffffffffffda RBX: 0000000000000016 RCX: 00007fdd58b37504
# [  155.371238] RDX: 0000000000000016 RSI: 00007fdd58886000 RDI: 0000000000000001
# [  155.379463] RBP: 00007fdd58886000 R08: 00000000ffffffff R09: 0000000000000000
# [  155.387607] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fdd58886000
# [  155.395740] R13: 0000000000000001 R14: 0000000000000016 R15: 0000000000020000
# [  155.403908] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  155.454637] ---[ end trace 9201e83dba6482cf ]---
# [  155.460317] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  155.465165] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  155.485373] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  155.491554] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  155.499747] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  155.507913] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  155.516010] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  155.524219] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  155.532412] FS:  00007fdd58c0f540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  155.541592] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  155.548287] CR2: 00005613f33a2fe8 CR3: 0000000895358003 CR4: 00000000003706e0
# [  155.556459] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  155.564641] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# USERCOPY_STACK_BEYOND: saw 'call trace:': ok
ok 71 selftests: lkdtm: USERCOPY_STACK_BEYOND.sh
# selftests: lkdtm: USERCOPY_KERNEL.sh
# Segmentation fault
# [  155.859288] lkdtm: Performing direct entry USERCOPY_KERNEL
# [  155.865766] lkdtm: attempting good copy_to_user from kernel rodata: ffffffff845b51a0
# [  155.874629] lkdtm: attempting bad copy_to_user from kernel text: ffffffff81a21dc0
# [  155.883123] usercopy: Kernel memory exposure attempt detected from kernel text (offset 10624448, size 4096)!
# [  155.894038] ------------[ cut here ]------------
# [  155.899543] kernel BUG at mm/usercopy.c:99!
# [  155.904617] invalid opcode: 0000 [#23] PREEMPT SMP KASAN PTI
# [  155.911190] CPU: 3 PID: 3772 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  155.919290] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  155.928363] RIP: 0010:usercopy_abort+0x77/0x79
# [  155.933697] Code: 4c 0f 45 de 51 4c 89 d1 48 c7 c2 60 1a 3a 84 57 48 c7 c6 e0 19 3a 84 48 c7 c7 80 1b 3a 84 48 0f 45 f2 4c 89 da e8 dd 4b fe ff <0f> 0b e8 d9 84 01 fe 4c 89 e1 49 89 d8 44 89 ea 4c 29 f1 31 f6 48
# [  155.953625] RSP: 0018:ffffc9000848fc78 EFLAGS: 00010286
# [  155.959780] RAX: 0000000000000060 RBX: 0000000000001000 RCX: 0000000000000000
# [  155.967923] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52001091f82
# [  155.976127] RBP: ffffffff81a22dc0 R08: 0000000000000060 R09: ffffed110275d921
# [  155.984232] R10: ffff888813aec907 R11: ffffed110275d920 R12: ffffffff81a21dc0
# [  155.992354] R13: 0000000000000001 R14: ffffea0022e28840 R15: ffffea0022e28840
# [  156.000468] FS:  00007fc1445fa540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  156.009568] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  156.016228] CR2: 00007fc14426f000 CR3: 000000023274e002 CR4: 00000000003706e0
# [  156.024342] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  156.032435] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  156.040582] Call Trace:
# [  156.043809]  __check_object_size.cold+0x5e/0x94
# [  156.049191]  ? vm_mmap_pgoff+0x240/0x240
# [  156.054022]  lkdtm_USERCOPY_KERNEL.cold+0x138/0x22a
# [  156.059757]  direct_entry.cold+0x2f/0x6f
# [  156.064576]  full_proxy_write+0xfd/0x180
# [  156.069438]  vfs_write+0x184/0x8c0
# [  156.073694]  ksys_write+0xf9/0x200
# [  156.077919]  ? __ia32_sys_read+0xc0/0xc0
# [  156.082669]  ? syscall_enter_from_user_mode+0x21/0x80
# [  156.088582]  ? syscall_enter_from_user_mode+0x21/0x80
# [  156.094576]  do_syscall_64+0x5c/0x80
# [  156.098996]  ? rcu_read_lock_held_common+0xe/0xc0
# [  156.104588]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  156.110266]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  156.115552]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  156.121214]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  156.126969]  ? do_syscall_64+0x69/0x80
# [  156.131555]  ? asm_exc_page_fault+0x8/0x30
# [  156.136558]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  156.142400]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  156.148380] RIP: 0033:0x7fc144522504
# [  156.152887] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  156.172995] RSP: 002b:00007ffd887b0ac8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  156.181523] RAX: ffffffffffffffda RBX: 0000000000000010 RCX: 00007fc144522504
# [  156.189715] RDX: 0000000000000010 RSI: 00007fc144271000 RDI: 0000000000000001
# [  156.197862] RBP: 00007fc144271000 R08: 00000000ffffffff R09: 0000000000000000
# [  156.206025] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007fc144271000
# [  156.214165] R13: 0000000000000001 R14: 0000000000000010 R15: 0000000000020000
# [  156.222319] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  156.272619] ---[ end trace 9201e83dba6482d0 ]---
# [  156.278562] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  156.283410] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  156.303521] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  156.309683] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  156.317817] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  156.325940] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  156.334040] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  156.342123] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  156.350214] FS:  00007fc1445fa540(0000) GS:ffff888813ac0000(0000) knlGS:0000000000000000
# [  156.359260] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  156.365918] CR2: 00007fc14426f000 CR3: 000000023274e002 CR4: 00000000003706e0
# [  156.374021] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  156.382117] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# USERCOPY_KERNEL: saw 'call trace:': ok
ok 72 selftests: lkdtm: USERCOPY_KERNEL.sh
# selftests: lkdtm: STACKLEAK_ERASING.sh
# [  156.713613] lkdtm: Performing direct entry STACKLEAK_ERASING
# [  156.720365] lkdtm: checking unused part of the thread stack (32088 bytes)...
# [  156.728363] lkdtm: FAIL: the erased part is not found (checked 32088 bytes)
# [  156.736370] lkdtm: FAIL: the thread stack is NOT properly erased!
# [  156.743459] lkdtm: This is probably expected, since this kernel (5.15.0 x86_64) was built *without* CONFIG_GCC_PLUGIN_STACKLEAK=y
# STACKLEAK_ERASING: missing 'OK: the rest of the thread stack is properly erased': [FAIL]
not ok 73 selftests: lkdtm: STACKLEAK_ERASING.sh # exit=1
# selftests: lkdtm: CFI_FORWARD_PROTO.sh
# [  157.051831] lkdtm: Performing direct entry CFI_FORWARD_PROTO
# [  157.058500] lkdtm: Calling matched prototype ...
# [  157.064098] lkdtm: Calling mismatched prototype ...
# [  157.069995] lkdtm: FAIL: survived mismatched prototype function call!
# [  157.077454] lkdtm: This is probably expected, since this kernel (5.15.0 x86_64) was built *without* CONFIG_CFI_CLANG=y
# CFI_FORWARD_PROTO: missing 'call trace:': [FAIL]
not ok 74 selftests: lkdtm: CFI_FORWARD_PROTO.sh # exit=1
# selftests: lkdtm: FORTIFIED_STRSCPY.sh
# Segmentation fault
# [  157.405712] lkdtm: Performing direct entry FORTIFIED_STRSCPY
# [  157.412244] detected buffer overflow in strnlen
# [  157.417674] ------------[ cut here ]------------
# [  157.423193] kernel BUG at lib/string.c:1165!
# [  157.428276] invalid opcode: 0000 [#24] PREEMPT SMP KASAN PTI
# [  157.434943] CPU: 0 PID: 3878 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  157.443116] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  157.452312] RIP: 0010:fortify_panic+0xf/0x11
# [  157.457563] Code: 02 48 83 c4 10 48 c7 c7 60 9a 4a 84 5b 5d 41 5c 41 5d 41 5e 41 5f e9 52 e8 fb ff 48 89 fe 48 c7 c7 40 9b 4a 84 e8 43 e8 fb ff <0f> 0b e8 3f 21 ff fd 48 c7 c7 80 ab 4a 84 e8 de ff ff ff e8 2e 21
# [  157.477905] RSP: 0018:ffffc900088dfc48 EFLAGS: 00010286
# [  157.484158] RAX: 0000000000000023 RBX: 1ffff9200111bf8a RCX: 0000000000000000
# [  157.492372] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff5200111bf7c
# [  157.500538] RBP: ffff88810400d2f8 R08: 0000000000000023 R09: ffffed1102745921
# [  157.508708] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000012
# [  157.516903] R13: ffffc900088dfc90 R14: ffff88810400d2fb R15: ffffc900088dfc70
# [  157.525044] FS:  00007f98c11a6540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  157.534240] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  157.541018] CR2: 00007f98c0e1d000 CR3: 00000002138ea002 CR4: 00000000003706f0
# [  157.549206] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  157.557398] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  157.565602] Call Trace:
# [  157.568852]  lkdtm_FORTIFIED_STRSCPY.cold+0x11/0x7d
# [  157.574693]  ? lkdtm_FORTIFIED_SUBOBJECT+0x100/0x100
# [  157.580659]  ? pcpu_get_vm_areas+0x3840/0x4280
# [  157.586105]  ? free_unref_page+0x33d/0x5c0
# [  157.591111]  ? trace_hardirqs_on+0x41/0x140
# [  157.596194]  direct_entry.cold+0x2f/0x6f
# [  157.601017]  full_proxy_write+0xfd/0x180
# [  157.605882]  vfs_write+0x184/0x8c0
# [  157.610181]  ksys_write+0xf9/0x200
# [  157.614484]  ? __ia32_sys_read+0xc0/0xc0
# [  157.619389]  ? syscall_enter_from_user_mode+0x21/0x80
# [  157.625406]  ? syscall_enter_from_user_mode+0x21/0x80
# [  157.631425]  do_syscall_64+0x5c/0x80
# [  157.635955]  ? rcu_read_lock_held_common+0xe/0xc0
# [  157.641665]  ? rcu_read_lock_sched_held+0x5f/0x100
# [  157.647387]  ? rcu_read_lock_bh_held+0xc0/0xc0
# [  157.652779]  ? irqentry_exit_to_user_mode+0xa/0x40
# [  157.658489]  ? asm_exc_page_fault+0x8/0x30
# [  157.663489]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  157.669356]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  157.675372] RIP: 0033:0x7f98c10ce504
# [  157.679832] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  157.700029] RSP: 002b:00007ffd99cc6298 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  157.708637] RAX: ffffffffffffffda RBX: 0000000000000012 RCX: 00007f98c10ce504
# [  157.716819] RDX: 0000000000000012 RSI: 00007f98c0e1d000 RDI: 0000000000000001
# [  157.724984] RBP: 00007f98c0e1d000 R08: 00000000ffffffff R09: 0000000000000000
# [  157.733162] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f98c0e1d000
# [  157.741329] R13: 0000000000000001 R14: 0000000000000012 R15: 0000000000020000
# [  157.749499] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  157.800403] ---[ end trace 9201e83dba6482d1 ]---
# [  157.806901] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  157.811878] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  157.832113] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  157.838250] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  157.846334] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  157.854476] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  157.862591] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  157.870724] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  157.878854] FS:  00007f98c11a6540(0000) GS:ffff888813a00000(0000) knlGS:0000000000000000
# [  157.887893] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  157.894577] CR2: 00007f98c0e1d000 CR3: 00000002138ea002 CR4: 00000000003706f0
# [  157.902776] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  157.910890] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# FORTIFIED_STRSCPY: saw 'call trace:': ok
ok 75 selftests: lkdtm: FORTIFIED_STRSCPY.sh
# selftests: lkdtm: FORTIFIED_OBJECT.sh
# Segmentation fault
# [  158.212160] lkdtm: Performing direct entry FORTIFIED_OBJECT
# [  158.218789] lkdtm: trying to read past the end of a struct
# [  158.225278] detected buffer overflow in memcmp
# [  158.230649] ------------[ cut here ]------------
# [  158.236185] kernel BUG at lib/string.c:1165!
# [  158.241358] invalid opcode: 0000 [#25] PREEMPT SMP KASAN PTI
# [  158.248065] CPU: 2 PID: 3913 Comm: cat Tainted: G    B D W I       5.15.0 #1
# [  158.256253] Hardware name:  /NUC6i7KYB, BIOS KYSKLi70.86A.0041.2016.0817.1130 08/17/2016
# [  158.265477] RIP: 0010:fortify_panic+0xf/0x11
# [  158.270688] Code: 02 48 83 c4 10 48 c7 c7 60 9a 4a 84 5b 5d 41 5c 41 5d 41 5e 41 5f e9 52 e8 fb ff 48 89 fe 48 c7 c7 40 9b 4a 84 e8 43 e8 fb ff <0f> 0b e8 3f 21 ff fd 48 c7 c7 80 ab 4a 84 e8 de ff ff ff e8 2e 21
# [  158.290523] RSP: 0018:ffffc90008a1fc90 EFLAGS: 00010286
# [  158.296782] RAX: 0000000000000022 RBX: 1ffff92001143f93 RCX: 0000000000000000
# [  158.304914] RDX: 0000000000000001 RSI: ffffffff8158eeb6 RDI: fffff52001143f85
# [  158.313106] RBP: dffffc0000000000 R08: 0000000000000022 R09: ffffed1102755921
# [  158.321338] R10: ffff888813aac907 R11: ffffed1102755920 R12: 0000000000000011
# [  158.329553] R13: dffffc0000000000 R14: 00000000000004c0 R15: ffff88889c615000
# [  158.337779] FS:  00007f1a842de540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  158.347039] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  158.353693] CR2: 00007f1a83f55000 CR3: 000000026a5ee002 CR4: 00000000003706e0
# [  158.361843] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  158.369999] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# [  158.378184] Call Trace:
# [  158.381422]  lkdtm_FORTIFIED_OBJECT+0xa6/0x131
# [  158.386723]  ? lkdtm_CFI_FORWARD_PROTO+0x6c/0x6c
# [  158.392214]  direct_entry.cold+0x2f/0x6f
# [  158.396942]  full_proxy_write+0xfd/0x180
# [  158.401696]  vfs_write+0x184/0x8c0
# [  158.405960]  ksys_write+0xf9/0x200
# [  158.410256]  ? __ia32_sys_read+0xc0/0xc0
# [  158.415034]  ? syscall_enter_from_user_mode+0x21/0x80
# [  158.420922]  ? syscall_enter_from_user_mode+0x21/0x80
# [  158.426792]  do_syscall_64+0x5c/0x80
# [  158.431223]  ? rcu_tasks_trace_pregp_step+0x101/0x180
# [  158.437172]  ? syscall_exit_to_user_mode+0x1e/0x80
# [  158.442900]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  158.448740]  ? do_syscall_64+0x69/0x80
# [  158.453322]  ? trace_hardirqs_on_prepare+0x27/0x180
# [  158.459038]  entry_SYSCALL_64_after_hwframe+0x44/0xae
# [  158.465072] RIP: 0033:0x7f1a84206504
# [  158.469536] Code: 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b3 0f 1f 80 00 00 00 00 48 8d 05 f9 61 0d 00 8b 00 85 c0 75 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 41 54 49 89 d4 55 48 89 f5 53
# [  158.489879] RSP: 002b:00007ffeb2f3e208 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
# [  158.498581] RAX: ffffffffffffffda RBX: 0000000000000011 RCX: 00007f1a84206504
# [  158.506763] RDX: 0000000000000011 RSI: 00007f1a83f55000 RDI: 0000000000000001
# [  158.515035] RBP: 00007f1a83f55000 R08: 00000000ffffffff R09: 0000000000000000
# [  158.523241] R10: fffffffffffffb9c R11: 0000000000000246 R12: 00007f1a83f55000
# [  158.531422] R13: 0000000000000001 R14: 0000000000000011 R15: 0000000000020000
# [  158.539649] Modules linked in: netconsole btrfs ipmi_devintf ipmi_msghandler blake2b_generic xor zstd_compress intel_rapl_msr intel_rapl_common raid6_pq libcrc32c x86_pkg_temp_thermal i915 intel_powerclamp sd_mod t10_pi sg coretemp crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel intel_wmi_thunderbolt sdhci_pci rapl cqhci sdhci intel_cstate ahci mmc_core mei_me libahci intel_gtt i2c_i801 ir_rc6_decoder intel_uncore libata mei ttm i2c_smbus intel_pch_thermal rc_rc6_mce nuvoton_cir wmi rc_core video intel_pmc_core acpi_pad ip_tables
# [  158.590882] ---[ end trace 9201e83dba6482d2 ]---
# [  158.596850] RIP: 0010:lkdtm_BUG+0x5/0x40
# [  158.601713] Code: 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 80 00 00 00 00 0f 1f 44 00 00 <0f> 0b 66 66 2e 0f 1f 84 00 00 00 00 00 66 66 2e 0f 1f 84 00 00 00
# [  158.621971] RSP: 0018:ffffc900029efdb0 EFLAGS: 00010286
# [  158.628234] RAX: ffffffff82a92fc0 RBX: 0000000000000001 RCX: 0000000000000000
# [  158.636356] RDX: 1ffffffff08b60af RSI: ffffffff8158eeb6 RDI: ffffffff845b0578
# [  158.644527] RBP: ffffffff845af1a0 R08: 0000000000000022 R09: ffffed1102745921
# [  158.652644] R10: ffff888813a2c907 R11: ffffed1102745920 R12: 0000000000000004
# [  158.660769] R13: dffffc0000000000 R14: 0000000000000010 R15: ffff88820077b000
# [  158.668861] FS:  00007f1a842de540(0000) GS:ffff888813a80000(0000) knlGS:0000000000000000
# [  158.678091] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
# [  158.684768] CR2: 00007f1a83f55000 CR3: 000000026a5ee002 CR4: 00000000003706e0
# [  158.692883] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
# [  158.701049] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
# FORTIFIED_OBJECT: saw 'call trace:': ok
ok 76 selftests: lkdtm: FORTIFIED_OBJECT.sh
# selftests: lkdtm: FORTIFIED_SUBOBJECT.sh
# [  159.021258] lkdtm: Performing direct entry FORTIFIED_SUBOBJECT
# [  159.028153] lkdtm: trying to strcpy past the end of a member of a struct
# [  159.035745] lkdtm: FAIL: fortify did not block an sub-object overrun!
# [  159.043089] lkdtm: Unexpected! This kernel (5.15.0 x86_64) was built with CONFIG_FORTIFY_SOURCE=y
# FORTIFIED_SUBOBJECT: missing 'call trace:': [FAIL]
not ok 77 selftests: lkdtm: FORTIFIED_SUBOBJECT.sh # exit=1
# selftests: lkdtm: PPC_SLB_MULTIHIT.sh
# Skipped: test 'PPC_SLB_MULTIHIT' missing in /sys/kernel/debug/provoke-crash/DIRECT!
ok 78 selftests: lkdtm: PPC_SLB_MULTIHIT.sh # SKIP
# selftests: lkdtm: stack-entropy.sh
# Bits of stack entropy: 6
ok 79 selftests: lkdtm: stack-entropy.sh
make: Leaving directory '/usr/src/perf_selftests-x86_64-rhel-8.3-kselftests-8bb7eca972ad531c9b149c0a51ab43a417385813/tools/testing/selftests/lkdtm'
