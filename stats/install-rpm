#!/usr/bin/env ruby

while (line = STDIN.gets)
  case line.chomp!

  # Cannot download Packages/kernel-devel-4.19.90-2012.4.0.0053.oe1.aarch64.rpm: All mirrors were tried
  when /Cannot download Packages\/(.*):/
    puts "cannot_download.element: #{$1}"

  # - nothing provides perl(Globus::GRAM::Error) needed by globus-gram-job-manager-condor-3.0-9.noarch
  when /nothing provides (.*) needed by (.*)/
    puts "lack_of_dependency.element: #{$2}"

  # Problem: The operation would result in removing the following protected packages: dnf, systemd
  when /protected packages: (.*)/
    $1.split(', ').each do |rpm|
      puts "protected_packages.element: #{rpm}"
    end

  # file /usr/share/man/man1/nm-online.1.gz from install of NetworkManager-1:1.18.8-2.aarch64 conflicts with file from package NetworkManager-help-1:1.26.2-4.oe1.noarch
  when /file (.*) from install of (.*) conflicts.*from package (.*)/
    puts "conflicting_rpm.element: #{$2} #{$3}"

  # file /usr/libexec/caribou conflicts between attempted installs of caribou-0.4.21-1.aarch64 and caribou0-0.4.21-12.1.aarch64
  when /file (.*)conflicts.*of (.*) and (.*)/
    puts "conflicting_rpm.element: #{$2} #{$3}"

  # package qt-devel-1:4.8.7-48.oe1.aarch64 requires libQtCore.so.4()(64bit), but none of the providers can be installed
  when /package (.*) requires (.*), but.*installed$/
    puts "lack_of_dependency.element: #{$1}"

  # cannot install both libselinux-2.5-15.aarch64 and libselinux-3.1-1.oe1.aarch64
  when /cannot install both (.*) and (.*)/
    puts "conflicting_rpm.element: #{$1} #{$2}"

  # installed package openEuler-release-20.03LTS_SP1-38.oe1.aarch64 obsoletes yum-utils provided by yum-utils-1.1.31-54.noarch
  # package openEuler-release-20.03LTS_SP1-38.oe1.aarch64 obsoletes yum-utils provided by yum-utils-1.1.31-54.noarch
  when /package (.*) obsoletes (.*) provided by (.*)/
    puts "obsoletes.element: #{$1} #{$2}"

  # install success: iwl3945-firmware nodejs-create-error-class mod_geoip libcmpiCppImpl0 lz4-static gnupg2-debugsource python2-eventlet-doc kf5-kcodecs-debuginfo joda-time flex-debuginfo
  when /install success: (.*)/
    $1.split(' ').each do |rpm|
      puts "install_success.element: #{rpm}"
    end

  # remove success: mpg123-plugins-pulseaudio perl-Module-CPANfile mod_intercept_form_submit-debuginfo samyak-malayalam-fonts python-pip xfconf-debugsource jboss-el-3.0-api portreserve-debugsource jackson-javadoc php-phpiredis-debuginfo
  when /remove success: (.*)/
    $1.split(' ').each do |rpm|
      puts "remove_success.element: #{rpm}"
    end
  end
end
